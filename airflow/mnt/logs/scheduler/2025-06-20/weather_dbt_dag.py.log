[2025-06-20T07:34:06.749+0000] {processor.py:161} INFO - Started process (PID=66) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:34:06.750+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:34:06.753+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:34:06.753+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:34:07.129+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:34:07.129+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:34:11.973+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:34:11.967+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:34:11.974+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:34:11.967+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:34:11.974+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:34:12.013+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 5.268 seconds
[2025-06-20T07:34:42.420+0000] {processor.py:161} INFO - Started process (PID=90) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:34:42.421+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:34:42.423+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:34:42.423+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:34:42.478+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:34:42.478+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:34:42.889+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:34:42.888+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:34:42.889+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:34:42.888+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:34:42.890+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:34:42.904+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.486 seconds
[2025-06-20T07:35:13.156+0000] {processor.py:161} INFO - Started process (PID=124) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:35:13.157+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:35:13.164+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:35:13.162+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:35:13.300+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:35:13.299+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:35:13.925+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:35:13.923+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:35:13.926+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:35:13.923+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:35:13.927+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:35:13.947+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.803 seconds
[2025-06-20T07:35:44.204+0000] {processor.py:161} INFO - Started process (PID=148) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:35:44.205+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:35:44.207+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:35:44.207+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:35:44.271+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:35:44.271+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:35:44.612+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:35:44.611+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:35:44.612+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:35:44.611+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:35:44.612+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:35:44.625+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.424 seconds
[2025-06-20T07:36:15.187+0000] {processor.py:161} INFO - Started process (PID=174) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:36:15.188+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:36:15.190+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:36:15.190+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:36:15.259+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:36:15.259+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:36:15.637+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:36:15.636+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:36:15.637+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:36:15.636+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:36:15.638+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:36:15.650+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.466 seconds
[2025-06-20T07:36:46.147+0000] {processor.py:161} INFO - Started process (PID=207) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:36:46.149+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:36:46.151+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:36:46.151+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:36:46.245+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:36:46.245+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:36:46.588+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:36:46.587+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:36:46.589+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:36:46.587+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:36:46.589+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:36:46.601+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.461 seconds
[2025-06-20T07:37:16.646+0000] {processor.py:161} INFO - Started process (PID=233) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:37:16.646+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:37:16.649+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:37:16.649+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:37:16.711+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:37:16.711+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:37:17.068+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:37:17.067+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:37:17.068+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:37:17.067+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:37:17.068+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:37:17.082+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.440 seconds
[2025-06-20T07:37:47.193+0000] {processor.py:161} INFO - Started process (PID=268) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:37:47.198+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:37:47.204+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:37:47.204+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:37:47.315+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:37:47.315+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:37:48.067+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:37:48.065+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:37:48.068+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:37:48.065+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:37:48.068+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:37:48.085+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.923 seconds
[2025-06-20T07:38:18.662+0000] {processor.py:161} INFO - Started process (PID=294) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:38:18.663+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:38:18.666+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:38:18.666+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:38:18.724+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:38:18.724+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:38:19.290+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:38:19.283+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:38:19.293+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:38:19.283+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:38:19.294+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:38:19.317+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.658 seconds
[2025-06-20T07:38:49.466+0000] {processor.py:161} INFO - Started process (PID=320) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:38:49.467+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:38:49.468+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:38:49.468+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:38:49.509+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:38:49.509+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:38:49.891+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:38:49.890+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:38:49.891+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:38:49.890+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:38:49.891+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:38:49.904+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.441 seconds
[2025-06-20T07:39:20.469+0000] {processor.py:161} INFO - Started process (PID=352) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:39:20.470+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:39:20.475+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:39:20.474+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:39:20.594+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:39:20.593+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:39:21.193+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:39:21.192+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:39:21.194+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:39:21.192+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:39:21.195+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:39:21.212+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.751 seconds
[2025-06-20T07:39:51.827+0000] {processor.py:161} INFO - Started process (PID=376) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:39:51.828+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:39:51.830+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:39:51.829+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:39:51.870+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:39:51.870+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:39:52.213+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:39:52.212+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:39:52.214+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:39:52.212+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:39:52.215+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:39:52.235+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.410 seconds
[2025-06-20T07:40:23.082+0000] {processor.py:161} INFO - Started process (PID=410) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:40:23.082+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:40:23.084+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:40:23.084+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:40:23.173+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:40:23.172+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:40:23.814+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:40:23.813+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:40:23.815+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:40:23.813+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:40:23.815+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:40:23.833+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.755 seconds
[2025-06-20T07:40:54.127+0000] {processor.py:161} INFO - Started process (PID=435) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:40:54.128+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:40:54.130+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:40:54.129+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:40:54.169+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:40:54.169+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:40:54.504+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:40:54.503+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:40:54.504+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:40:54.503+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:40:54.504+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:40:54.517+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.392 seconds
[2025-06-20T07:41:25.518+0000] {processor.py:161} INFO - Started process (PID=460) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:41:25.519+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:41:25.521+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:41:25.521+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:41:25.569+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:41:25.569+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:41:25.926+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:41:25.925+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:41:25.926+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:41:25.925+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:41:25.926+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:41:25.940+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.425 seconds
[2025-06-20T07:41:56.292+0000] {processor.py:161} INFO - Started process (PID=494) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:41:56.293+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:41:56.295+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:41:56.295+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:41:56.361+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:41:56.361+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:41:56.900+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:41:56.899+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:41:56.901+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:41:56.899+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:41:56.902+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:41:56.921+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.636 seconds
[2025-06-20T07:42:27.747+0000] {processor.py:161} INFO - Started process (PID=520) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:42:27.748+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:42:27.750+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:42:27.749+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:42:27.795+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:42:27.794+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:42:28.177+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:42:28.175+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:42:28.177+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:42:28.175+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:42:28.178+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:42:28.192+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.449 seconds
[2025-06-20T07:42:58.849+0000] {processor.py:161} INFO - Started process (PID=547) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:42:58.850+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:42:58.852+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:42:58.851+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:42:58.917+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:42:58.917+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:42:59.315+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:42:59.315+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:42:59.316+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:42:59.315+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:42:59.316+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:42:59.330+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.483 seconds
[2025-06-20T07:43:29.567+0000] {processor.py:161} INFO - Started process (PID=580) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:43:29.568+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:43:29.570+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:43:29.569+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:43:29.610+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:43:29.610+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:43:29.940+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:43:29.939+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:43:29.940+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:43:29.939+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:43:29.940+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:43:29.953+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.389 seconds
[2025-06-20T07:44:00.238+0000] {processor.py:161} INFO - Started process (PID=606) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:44:00.239+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:44:00.241+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:44:00.241+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:44:00.284+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:44:00.283+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:44:00.659+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:44:00.658+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:44:00.660+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:44:00.658+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:44:00.660+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:44:00.676+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.440 seconds
[2025-06-20T07:44:30.804+0000] {processor.py:161} INFO - Started process (PID=631) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:44:30.806+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:44:30.808+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:44:30.808+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:44:30.875+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:44:30.875+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:44:31.925+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:44:31.923+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:44:31.926+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:44:31.923+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:44:31.926+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:44:31.960+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 1.164 seconds
[2025-06-20T07:45:02.507+0000] {processor.py:161} INFO - Started process (PID=663) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:45:02.508+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:45:02.510+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:45:02.509+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:45:02.556+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:45:02.556+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:45:02.928+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:45:02.927+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:45:02.928+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:45:02.927+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:45:02.928+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:45:02.941+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.437 seconds
[2025-06-20T07:45:33.812+0000] {processor.py:161} INFO - Started process (PID=689) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:45:33.813+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:45:33.814+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:45:33.814+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:45:33.854+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:45:33.854+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:45:34.220+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:45:34.219+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:45:34.220+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:45:34.219+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:45:34.221+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:45:34.233+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.424 seconds
[2025-06-20T07:46:04.775+0000] {processor.py:161} INFO - Started process (PID=723) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:46:04.776+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:46:04.781+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:46:04.780+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:46:05.031+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:46:05.031+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:46:05.866+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:46:05.864+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:46:05.868+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:46:05.864+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:46:05.869+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:46:05.947+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 1.183 seconds
[2025-06-20T07:46:36.104+0000] {processor.py:161} INFO - Started process (PID=749) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:46:36.104+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:46:36.107+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:46:36.106+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:46:36.149+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:46:36.149+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:46:36.522+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:46:36.520+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:46:36.522+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:46:36.520+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:46:36.523+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:46:36.549+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.448 seconds
[2025-06-20T07:47:07.451+0000] {processor.py:161} INFO - Started process (PID=775) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:47:07.452+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:47:07.453+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:47:07.453+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:47:07.492+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:47:07.492+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:47:07.814+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:47:07.813+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:47:07.815+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:47:07.813+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:47:07.815+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:47:07.828+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.380 seconds
[2025-06-20T07:47:37.916+0000] {processor.py:161} INFO - Started process (PID=809) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:47:37.917+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:47:37.919+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:47:37.919+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:47:37.959+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:47:37.959+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:47:38.469+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:47:38.466+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:47:38.470+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:47:38.466+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:47:38.471+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:47:38.516+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.602 seconds
[2025-06-20T07:48:09.099+0000] {processor.py:161} INFO - Started process (PID=835) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:48:09.100+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:48:09.101+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:48:09.101+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:48:09.142+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:48:09.141+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:48:09.460+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:48:09.459+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:48:09.461+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:48:09.459+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:48:09.461+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:48:09.474+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.378 seconds
[2025-06-20T07:48:40.007+0000] {processor.py:161} INFO - Started process (PID=870) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:48:40.008+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:48:40.010+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:48:40.009+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:48:40.050+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:48:40.049+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:48:40.407+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:48:40.406+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:48:40.408+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:48:40.406+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:48:40.408+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:48:40.422+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.417 seconds
[2025-06-20T07:49:10.780+0000] {processor.py:161} INFO - Started process (PID=896) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:49:10.781+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:49:10.783+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:49:10.782+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:49:10.821+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:49:10.821+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:49:11.139+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:49:11.138+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:49:11.140+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:49:11.138+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:49:11.140+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:49:11.154+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.377 seconds
[2025-06-20T07:49:41.299+0000] {processor.py:161} INFO - Started process (PID=930) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:49:41.300+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:49:41.303+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:49:41.302+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:49:41.364+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:49:41.364+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:49:41.864+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:49:41.863+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:49:41.865+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:49:41.863+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:49:41.866+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:49:41.883+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.589 seconds
[2025-06-20T07:50:11.916+0000] {processor.py:161} INFO - Started process (PID=955) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:50:11.917+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:50:11.919+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:50:11.918+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:50:11.969+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:50:11.969+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:50:12.346+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:50:12.345+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:50:12.346+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:50:12.345+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:50:12.346+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:50:12.359+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.446 seconds
[2025-06-20T07:50:42.748+0000] {processor.py:161} INFO - Started process (PID=980) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:50:42.749+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:50:42.751+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:50:42.751+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:50:42.817+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:50:42.817+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:50:43.384+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:50:43.380+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:50:43.385+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:50:43.380+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:50:43.386+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:50:43.423+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.679 seconds
[2025-06-20T07:51:13.977+0000] {processor.py:161} INFO - Started process (PID=1012) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:51:13.978+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:51:13.981+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:51:13.981+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:51:14.042+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:51:14.042+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:51:14.523+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:51:14.522+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:51:14.524+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:51:14.522+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:51:14.524+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:51:14.542+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.571 seconds
[2025-06-20T07:51:45.460+0000] {processor.py:161} INFO - Started process (PID=1039) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:51:45.460+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:51:45.463+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:51:45.463+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:51:45.502+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:51:45.502+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:51:45.816+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:51:45.815+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:51:45.817+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:51:45.815+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:51:45.817+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:51:45.830+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.374 seconds
[2025-06-20T07:52:16.814+0000] {processor.py:161} INFO - Started process (PID=1067) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:52:16.814+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:52:16.816+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:52:16.816+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:52:16.855+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:52:16.855+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:52:17.186+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:52:17.185+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:52:17.187+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:52:17.185+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:52:17.187+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:52:17.200+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.389 seconds
[2025-06-20T07:52:48.019+0000] {processor.py:161} INFO - Started process (PID=1101) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:52:48.022+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:52:48.031+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:52:48.030+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:52:48.097+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:52:48.097+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:52:48.457+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:52:48.454+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:52:48.457+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:52:48.454+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:52:48.458+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:52:48.477+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.466 seconds
[2025-06-20T07:53:18.711+0000] {processor.py:161} INFO - Started process (PID=1127) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:53:18.712+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:53:18.715+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:53:18.715+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:53:18.786+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:53:18.786+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:53:19.243+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:53:19.242+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:53:19.244+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:53:19.242+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:53:19.244+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:53:19.260+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.552 seconds
[2025-06-20T07:53:49.580+0000] {processor.py:161} INFO - Started process (PID=1161) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:53:49.581+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:53:49.584+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:53:49.584+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:53:49.646+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:53:49.646+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:53:50.380+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:53:50.379+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:53:50.381+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:53:50.379+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:53:50.381+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:53:50.400+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.823 seconds
[2025-06-20T07:54:20.546+0000] {processor.py:161} INFO - Started process (PID=1187) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:54:20.547+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:54:20.549+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:54:20.549+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:54:20.587+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:54:20.587+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:54:20.970+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:54:20.968+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:54:20.971+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:54:20.968+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:54:20.971+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:54:20.988+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.444 seconds
[2025-06-20T07:54:51.279+0000] {processor.py:161} INFO - Started process (PID=1214) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:54:51.280+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:54:51.285+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:54:51.284+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:54:51.448+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:54:51.447+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:54:52.246+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:54:52.244+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:54:52.247+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:54:52.244+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:54:52.248+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:54:52.270+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 1.002 seconds
[2025-06-20T07:55:22.711+0000] {processor.py:161} INFO - Started process (PID=1247) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:55:22.711+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:55:22.713+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:55:22.713+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:55:22.766+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:55:22.766+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:55:23.389+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:55:23.388+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:55:23.390+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:55:23.388+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:55:23.391+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:55:23.409+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.701 seconds
[2025-06-20T07:55:53.944+0000] {processor.py:161} INFO - Started process (PID=1273) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:55:53.948+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:55:53.954+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:55:53.954+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:55:54.069+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:55:54.069+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:55:54.408+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:55:54.407+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:55:54.408+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:55:54.407+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:55:54.408+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:55:54.422+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.488 seconds
[2025-06-20T07:56:24.505+0000] {processor.py:161} INFO - Started process (PID=1307) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:56:24.506+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:56:24.508+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:56:24.508+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:56:24.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:56:24.586+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:56:25.092+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:56:25.090+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:56:25.093+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:56:25.090+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:56:25.093+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:56:25.123+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.622 seconds
[2025-06-20T07:56:55.980+0000] {processor.py:161} INFO - Started process (PID=1333) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:56:55.981+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:56:55.983+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:56:55.983+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:56:56.022+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:56:56.022+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:56:56.361+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:56:56.360+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:56:56.361+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:56:56.360+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:56:56.361+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:56:56.377+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.399 seconds
[2025-06-20T07:57:26.458+0000] {processor.py:161} INFO - Started process (PID=1359) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:57:26.459+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:57:26.461+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:57:26.461+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:57:26.514+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:57:26.514+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:57:26.988+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:57:26.986+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:57:26.989+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:57:26.986+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:57:26.989+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:57:27.010+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.555 seconds
[2025-06-20T07:57:57.152+0000] {processor.py:161} INFO - Started process (PID=1390) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:57:57.153+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:57:57.154+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:57:57.154+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:57:57.197+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:57:57.197+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:57:57.535+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:57:57.534+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:57:57.536+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:57:57.534+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:57:57.536+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:57:57.548+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.399 seconds
[2025-06-20T07:58:27.626+0000] {processor.py:161} INFO - Started process (PID=1415) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:58:27.627+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:58:27.628+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:58:27.628+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:58:27.670+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:58:27.670+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:58:28.010+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:58:28.009+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:58:28.011+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:58:28.009+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:58:28.012+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:58:28.030+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.407 seconds
[2025-06-20T07:58:58.674+0000] {processor.py:161} INFO - Started process (PID=1441) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:58:58.675+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:58:58.676+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:58:58.676+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:58:58.723+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:58:58.723+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:58:59.123+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:58:59.122+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:58:59.123+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:58:59.122+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:58:59.124+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:58:59.137+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.465 seconds
[2025-06-20T07:59:29.243+0000] {processor.py:161} INFO - Started process (PID=1475) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:59:29.244+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:59:29.245+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:59:29.245+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:59:29.285+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:59:29.285+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T07:59:29.610+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:59:29.609+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:59:29.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T07:59:29.609+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T07:59:29.611+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:59:29.625+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.385 seconds
[2025-06-20T07:59:59.668+0000] {processor.py:161} INFO - Started process (PID=1501) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:59:59.669+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T07:59:59.671+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:59:59.671+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T07:59:59.713+0000] {logging_mixin.py:188} INFO - [2025-06-20T07:59:59.713+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:00:00.082+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:00.081+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T08:00:00.082+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:00.081+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 209, in __init__
    project_config.validate_project()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/config.py", line 193, in validate_project
    raise CosmosValueError(f"Could not find {name} at {path}")
cosmos.exceptions.CosmosValueError: Could not find dbt_project.yml at /opt/airflow/dbt/weather/dbt_project.yml
[2025-06-20T08:00:00.083+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:00:00.096+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 0.431 seconds
[2025-06-20T08:00:30.814+0000] {processor.py:161} INFO - Started process (PID=1535) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:00:30.815+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:00:30.818+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:30.818+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:00:30.884+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:30.884+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:00:31.403+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.403+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:00:31.404+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:31.403+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:00:31.404+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.403+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:00:31.419+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.419+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:00:31.419+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:31.419+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:00:31.420+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.419+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:00:31.421+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.421+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:00:31.422+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:31.421+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:00:31.422+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.421+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:00:31.424+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.424+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjpj4qig3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:00:31.425+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:31.424+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpjpj4qig3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:00:31.425+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.424+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjpj4qig3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:00:31.426+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.426+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4j6hftlf --profiles-dir /tmp/tmpjpj4qig3 --profile weather --target dev`
[2025-06-20T08:00:31.426+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:31.426+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4j6hftlf --profiles-dir /tmp/tmpjpj4qig3 --profile weather --target dev`
[2025-06-20T08:00:31.427+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.426+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4j6hftlf --profiles-dir /tmp/tmpjpj4qig3 --profile weather --target dev`
[2025-06-20T08:00:31.428+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.427+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:00:31.428+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:31.427+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:00:31.429+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:31.427+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:00:37.843+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:37.842+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4j6hftlf --profiles-dir /tmp/tmpjpj4qig3 --profile weather --target dev`
[2025-06-20T08:00:37.843+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:37.842+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4j6hftlf --profiles-dir /tmp/tmpjpj4qig3 --profile weather --target dev`
[2025-06-20T08:00:37.844+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:37.842+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4j6hftlf --profiles-dir /tmp/tmpjpj4qig3 --profile weather --target dev`
[2025-06-20T08:00:37.844+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:37.844+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:00:37.844+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:37.844+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:00:37.845+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:37.844+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:00:43.793+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:00:43.790+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4j6hftlf', '--profiles-dir', '/tmp/tmpjpj4qig3', '--profile', 'weather', '--target', 'dev'] due to the error:
08:00:40  Running with dbt=1.7.9
08:00:41  Registered adapter: postgres=1.7.9
08:00:41  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:00:42  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:00:43.794+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:00:43.790+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4j6hftlf', '--profiles-dir', '/tmp/tmpjpj4qig3', '--profile', 'weather', '--target', 'dev'] due to the error:
08:00:40  Running with dbt=1.7.9
08:00:41  Registered adapter: postgres=1.7.9
08:00:41  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:00:42  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:00:43.794+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:00:43.818+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.007 seconds
[2025-06-20T08:01:14.743+0000] {processor.py:161} INFO - Started process (PID=1579) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:01:14.743+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:01:14.745+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:14.745+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:01:14.794+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:14.793+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:01:15.125+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.125+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:01:15.125+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:15.125+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:01:15.126+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.125+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:01:15.127+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.126+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:01:15.127+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:15.126+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:01:15.127+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.126+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:01:15.128+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.127+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:01:15.128+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:15.127+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:01:15.128+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.127+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:01:15.130+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.129+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpl_ao3mbq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:01:15.130+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:15.129+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpl_ao3mbq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:01:15.130+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.129+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpl_ao3mbq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:01:15.131+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.130+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_yb72vhh --profiles-dir /tmp/tmpl_ao3mbq --profile weather --target dev`
[2025-06-20T08:01:15.131+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:15.130+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_yb72vhh --profiles-dir /tmp/tmpl_ao3mbq --profile weather --target dev`
[2025-06-20T08:01:15.131+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.130+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_yb72vhh --profiles-dir /tmp/tmpl_ao3mbq --profile weather --target dev`
[2025-06-20T08:01:15.132+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.131+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:01:15.132+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:15.131+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:01:15.132+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:15.131+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:01:19.504+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:19.503+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_yb72vhh --profiles-dir /tmp/tmpl_ao3mbq --profile weather --target dev`
[2025-06-20T08:01:19.504+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:19.503+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_yb72vhh --profiles-dir /tmp/tmpl_ao3mbq --profile weather --target dev`
[2025-06-20T08:01:19.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:19.503+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_yb72vhh --profiles-dir /tmp/tmpl_ao3mbq --profile weather --target dev`
[2025-06-20T08:01:19.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:19.505+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:01:19.506+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:19.505+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:01:19.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:19.505+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:01:31.687+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:01:31.686+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_yb72vhh', '--profiles-dir', '/tmp/tmpl_ao3mbq', '--profile', 'weather', '--target', 'dev'] due to the error:
08:01:24  Running with dbt=1.7.9
08:01:26  Registered adapter: postgres=1.7.9
08:01:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:01:30  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:01:31.688+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:01:31.686+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_yb72vhh', '--profiles-dir', '/tmp/tmpl_ao3mbq', '--profile', 'weather', '--target', 'dev'] due to the error:
08:01:24  Running with dbt=1.7.9
08:01:26  Registered adapter: postgres=1.7.9
08:01:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:01:30  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:01:31.688+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:01:31.703+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 16.963 seconds
[2025-06-20T08:02:02.353+0000] {processor.py:161} INFO - Started process (PID=1622) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:02:02.359+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:02:02.365+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:02:02.365+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:02:02.667+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:02:02.666+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:03:32.801+0000] {processor.py:161} INFO - Started process (PID=50) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:03:32.804+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:03:32.816+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:32.815+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:03:33.095+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:33.095+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:03:34.031+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.030+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:03:34.032+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:34.030+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:03:34.032+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.030+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:03:34.036+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.036+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:03:34.036+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:34.036+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:03:34.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.036+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:03:34.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.037+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:03:34.038+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:34.037+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:03:34.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.037+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:03:34.040+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.040+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpeitauieg/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:03:34.041+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:34.040+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpeitauieg/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:03:34.041+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.040+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpeitauieg/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:03:34.042+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.042+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpz6aiydfh --profiles-dir /tmp/tmpeitauieg --profile weather --target dev`
[2025-06-20T08:03:34.042+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:34.042+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpz6aiydfh --profiles-dir /tmp/tmpeitauieg --profile weather --target dev`
[2025-06-20T08:03:34.043+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.042+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpz6aiydfh --profiles-dir /tmp/tmpeitauieg --profile weather --target dev`
[2025-06-20T08:03:34.043+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.043+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:03:34.044+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:34.043+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:03:34.044+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:34.043+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:03:42.762+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:42.762+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpz6aiydfh --profiles-dir /tmp/tmpeitauieg --profile weather --target dev`
[2025-06-20T08:03:42.763+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:42.762+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpz6aiydfh --profiles-dir /tmp/tmpeitauieg --profile weather --target dev`
[2025-06-20T08:03:42.763+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:42.762+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpz6aiydfh --profiles-dir /tmp/tmpeitauieg --profile weather --target dev`
[2025-06-20T08:03:42.763+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:42.763+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:03:42.764+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:42.763+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:03:42.764+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:42.763+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:03:50.677+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:03:50.673+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpz6aiydfh', '--profiles-dir', '/tmp/tmpeitauieg', '--profile', 'weather', '--target', 'dev'] due to the error:
08:03:46  Running with dbt=1.7.9
08:03:47  Registered adapter: postgres=1.7.9
08:03:47  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:03:49  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:03:50.677+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:03:50.673+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpz6aiydfh', '--profiles-dir', '/tmp/tmpeitauieg', '--profile', 'weather', '--target', 'dev'] due to the error:
08:03:46  Running with dbt=1.7.9
08:03:47  Registered adapter: postgres=1.7.9
08:03:47  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:03:49  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:03:50.678+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:03:50.692+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 17.899 seconds
[2025-06-20T08:04:20.769+0000] {processor.py:161} INFO - Started process (PID=99) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:04:20.771+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:04:20.773+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:20.773+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:04:20.839+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:20.839+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:04:21.335+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.334+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:04:21.335+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:21.334+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:04:21.336+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.334+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:04:21.337+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.337+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:04:21.337+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:21.337+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:04:21.338+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.337+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:04:21.339+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.339+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:04:21.340+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:21.339+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:04:21.340+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.339+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:04:21.342+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.342+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3mne2q09/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:04:21.342+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:21.342+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp3mne2q09/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:04:21.343+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.342+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3mne2q09/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:04:21.344+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.344+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5hw4b3n3 --profiles-dir /tmp/tmp3mne2q09 --profile weather --target dev`
[2025-06-20T08:04:21.344+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:21.344+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5hw4b3n3 --profiles-dir /tmp/tmp3mne2q09 --profile weather --target dev`
[2025-06-20T08:04:21.345+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.344+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5hw4b3n3 --profiles-dir /tmp/tmp3mne2q09 --profile weather --target dev`
[2025-06-20T08:04:21.346+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.345+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:04:21.347+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:21.345+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:04:21.347+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:21.345+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:04:25.588+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:25.587+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5hw4b3n3 --profiles-dir /tmp/tmp3mne2q09 --profile weather --target dev`
[2025-06-20T08:04:25.588+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:25.587+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5hw4b3n3 --profiles-dir /tmp/tmp3mne2q09 --profile weather --target dev`
[2025-06-20T08:04:25.589+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:25.587+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5hw4b3n3 --profiles-dir /tmp/tmp3mne2q09 --profile weather --target dev`
[2025-06-20T08:04:25.589+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:25.589+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:04:25.589+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:25.589+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:04:25.590+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:25.589+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:04:32.859+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:04:32.858+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5hw4b3n3', '--profiles-dir', '/tmp/tmp3mne2q09', '--profile', 'weather', '--target', 'dev'] due to the error:
08:04:28  Running with dbt=1.7.9
08:04:28  Registered adapter: postgres=1.7.9
08:04:28  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:04:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:04:32.860+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:04:32.858+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5hw4b3n3', '--profiles-dir', '/tmp/tmp3mne2q09', '--profile', 'weather', '--target', 'dev'] due to the error:
08:04:28  Running with dbt=1.7.9
08:04:28  Registered adapter: postgres=1.7.9
08:04:28  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:04:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:04:32.861+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:04:32.882+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.124 seconds
[2025-06-20T08:05:03.256+0000] {processor.py:161} INFO - Started process (PID=143) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:05:03.257+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:05:03.259+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.259+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:05:03.416+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.416+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:05:03.831+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.831+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:05:03.832+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.831+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:05:03.832+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.831+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:05:03.833+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.833+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:05:03.833+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.833+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:05:03.833+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.833+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:05:03.834+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.834+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:05:03.834+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.834+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:05:03.835+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.834+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:05:03.836+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.836+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwze04faq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:05:03.836+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.836+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpwze04faq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:05:03.836+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.836+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwze04faq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:05:03.837+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.837+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr1xdknvf --profiles-dir /tmp/tmpwze04faq --profile weather --target dev`
[2025-06-20T08:05:03.837+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.837+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr1xdknvf --profiles-dir /tmp/tmpwze04faq --profile weather --target dev`
[2025-06-20T08:05:03.837+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.837+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr1xdknvf --profiles-dir /tmp/tmpwze04faq --profile weather --target dev`
[2025-06-20T08:05:03.838+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.837+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:03.838+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:03.837+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:03.839+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:03.837+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:08.006+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:08.005+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr1xdknvf --profiles-dir /tmp/tmpwze04faq --profile weather --target dev`
[2025-06-20T08:05:08.007+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:08.005+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr1xdknvf --profiles-dir /tmp/tmpwze04faq --profile weather --target dev`
[2025-06-20T08:05:08.008+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:08.005+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr1xdknvf --profiles-dir /tmp/tmpwze04faq --profile weather --target dev`
[2025-06-20T08:05:08.009+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:08.008+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:08.009+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:08.008+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:08.010+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:08.008+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:15.625+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:15.624+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpr1xdknvf', '--profiles-dir', '/tmp/tmpwze04faq', '--profile', 'weather', '--target', 'dev'] due to the error:
08:05:12  Running with dbt=1.7.9
08:05:13  Registered adapter: postgres=1.7.9
08:05:13  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:05:14  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:05:15.626+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:15.624+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpr1xdknvf', '--profiles-dir', '/tmp/tmpwze04faq', '--profile', 'weather', '--target', 'dev'] due to the error:
08:05:12  Running with dbt=1.7.9
08:05:13  Registered adapter: postgres=1.7.9
08:05:13  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:05:14  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:05:15.626+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:05:15.641+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.388 seconds
[2025-06-20T08:05:46.158+0000] {processor.py:161} INFO - Started process (PID=184) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:05:46.159+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:05:46.161+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.161+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:05:46.204+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.204+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:05:46.550+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.549+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:05:46.550+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.549+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:05:46.550+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.549+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:05:46.551+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.551+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:05:46.551+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.551+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:05:46.551+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.551+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:05:46.552+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.552+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:05:46.552+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.552+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:05:46.553+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.552+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:05:46.554+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.554+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmprj_i3j6n/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:05:46.554+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.554+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmprj_i3j6n/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:05:46.554+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.554+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmprj_i3j6n/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:05:46.555+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.555+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy67x51ao --profiles-dir /tmp/tmprj_i3j6n --profile weather --target dev`
[2025-06-20T08:05:46.555+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.555+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy67x51ao --profiles-dir /tmp/tmprj_i3j6n --profile weather --target dev`
[2025-06-20T08:05:46.555+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.555+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy67x51ao --profiles-dir /tmp/tmprj_i3j6n --profile weather --target dev`
[2025-06-20T08:05:46.556+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.556+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:46.556+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:46.556+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:46.557+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:46.556+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:52.549+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:52.548+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy67x51ao --profiles-dir /tmp/tmprj_i3j6n --profile weather --target dev`
[2025-06-20T08:05:52.549+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:52.548+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy67x51ao --profiles-dir /tmp/tmprj_i3j6n --profile weather --target dev`
[2025-06-20T08:05:52.549+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:52.548+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy67x51ao --profiles-dir /tmp/tmprj_i3j6n --profile weather --target dev`
[2025-06-20T08:05:52.550+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:52.549+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:52.550+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:05:52.549+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:05:52.550+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:05:52.549+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:06:01.436+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:01.435+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpy67x51ao', '--profiles-dir', '/tmp/tmprj_i3j6n', '--profile', 'weather', '--target', 'dev'] due to the error:
08:05:56  Running with dbt=1.7.9
08:05:57  Registered adapter: postgres=1.7.9
08:05:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:06:00  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:06:01.437+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:01.435+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpy67x51ao', '--profiles-dir', '/tmp/tmprj_i3j6n', '--profile', 'weather', '--target', 'dev'] due to the error:
08:05:56  Running with dbt=1.7.9
08:05:57  Registered adapter: postgres=1.7.9
08:05:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:06:00  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:06:01.437+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:06:01.452+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.296 seconds
[2025-06-20T08:06:32.009+0000] {processor.py:161} INFO - Started process (PID=235) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:06:32.017+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:06:32.026+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:32.026+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:06:32.353+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:32.353+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:06:33.293+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.291+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:06:33.293+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:33.291+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:06:33.294+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.291+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:06:33.297+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.296+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:06:33.299+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:33.296+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:06:33.299+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.296+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:06:33.300+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.300+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:06:33.301+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:33.300+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:06:33.302+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.300+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:06:33.308+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.307+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpbtl4m6de/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:06:33.310+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:33.307+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpbtl4m6de/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:06:33.311+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.307+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpbtl4m6de/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:06:33.312+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.312+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptb4tkruk --profiles-dir /tmp/tmpbtl4m6de --profile weather --target dev`
[2025-06-20T08:06:33.314+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:33.312+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptb4tkruk --profiles-dir /tmp/tmpbtl4m6de --profile weather --target dev`
[2025-06-20T08:06:33.314+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.312+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptb4tkruk --profiles-dir /tmp/tmpbtl4m6de --profile weather --target dev`
[2025-06-20T08:06:33.315+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.315+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:06:33.315+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:33.315+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:06:33.316+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:33.315+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:06:38.824+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:38.824+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptb4tkruk --profiles-dir /tmp/tmpbtl4m6de --profile weather --target dev`
[2025-06-20T08:06:38.825+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:38.824+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptb4tkruk --profiles-dir /tmp/tmpbtl4m6de --profile weather --target dev`
[2025-06-20T08:06:38.825+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:38.824+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptb4tkruk --profiles-dir /tmp/tmpbtl4m6de --profile weather --target dev`
[2025-06-20T08:06:38.825+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:38.825+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:06:38.826+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:38.825+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:06:38.826+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:38.825+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:06:46.343+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:06:46.341+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptb4tkruk', '--profiles-dir', '/tmp/tmpbtl4m6de', '--profile', 'weather', '--target', 'dev'] due to the error:
08:06:42  Running with dbt=1.7.9
08:06:43  Registered adapter: postgres=1.7.9
08:06:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:06:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:06:46.343+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:06:46.341+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptb4tkruk', '--profiles-dir', '/tmp/tmpbtl4m6de', '--profile', 'weather', '--target', 'dev'] due to the error:
08:06:42  Running with dbt=1.7.9
08:06:43  Registered adapter: postgres=1.7.9
08:06:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:06:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:06:46.344+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:06:46.358+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.378 seconds
[2025-06-20T08:07:16.608+0000] {processor.py:161} INFO - Started process (PID=282) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:07:16.609+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:07:16.611+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.611+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:07:16.652+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.651+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:07:16.972+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.972+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:07:16.972+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.972+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:07:16.973+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.972+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:07:16.973+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.973+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:07:16.974+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.973+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:07:16.974+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.973+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:07:16.975+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.974+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:07:16.975+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.974+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:07:16.975+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.974+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:07:16.976+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.976+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptrtpulj0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:07:16.977+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.976+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmptrtpulj0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:07:16.977+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.976+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptrtpulj0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:07:16.977+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.977+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp04m14y0b --profiles-dir /tmp/tmptrtpulj0 --profile weather --target dev`
[2025-06-20T08:07:16.978+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.977+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp04m14y0b --profiles-dir /tmp/tmptrtpulj0 --profile weather --target dev`
[2025-06-20T08:07:16.978+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.977+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp04m14y0b --profiles-dir /tmp/tmptrtpulj0 --profile weather --target dev`
[2025-06-20T08:07:16.979+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.978+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:16.979+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:16.978+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:16.979+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:16.978+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:21.091+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:21.090+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp04m14y0b --profiles-dir /tmp/tmptrtpulj0 --profile weather --target dev`
[2025-06-20T08:07:21.091+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:21.090+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp04m14y0b --profiles-dir /tmp/tmptrtpulj0 --profile weather --target dev`
[2025-06-20T08:07:21.092+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:21.090+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp04m14y0b --profiles-dir /tmp/tmptrtpulj0 --profile weather --target dev`
[2025-06-20T08:07:21.092+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:21.092+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:21.093+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:21.092+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:21.093+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:21.092+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:28.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:28.585+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp04m14y0b', '--profiles-dir', '/tmp/tmptrtpulj0', '--profile', 'weather', '--target', 'dev'] due to the error:
08:07:25  Running with dbt=1.7.9
08:07:26  Registered adapter: postgres=1.7.9
08:07:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:07:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:07:28.587+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:28.585+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp04m14y0b', '--profiles-dir', '/tmp/tmptrtpulj0', '--profile', 'weather', '--target', 'dev'] due to the error:
08:07:25  Running with dbt=1.7.9
08:07:26  Registered adapter: postgres=1.7.9
08:07:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:07:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:07:28.587+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:07:28.602+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.996 seconds
[2025-06-20T08:07:59.099+0000] {processor.py:161} INFO - Started process (PID=321) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:07:59.100+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:07:59.102+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.101+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:07:59.141+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.141+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:07:59.472+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.471+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:07:59.472+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.471+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:07:59.472+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.471+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:07:59.473+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.473+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:07:59.473+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.473+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:07:59.474+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.473+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:07:59.474+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.474+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:07:59.475+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.474+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:07:59.475+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.474+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:07:59.476+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.476+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpebl_em2z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:07:59.476+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.476+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpebl_em2z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:07:59.477+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.476+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpebl_em2z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:07:59.477+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.477+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa_xnz5d6 --profiles-dir /tmp/tmpebl_em2z --profile weather --target dev`
[2025-06-20T08:07:59.477+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.477+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa_xnz5d6 --profiles-dir /tmp/tmpebl_em2z --profile weather --target dev`
[2025-06-20T08:07:59.478+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.477+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa_xnz5d6 --profiles-dir /tmp/tmpebl_em2z --profile weather --target dev`
[2025-06-20T08:07:59.478+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.478+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:59.479+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:07:59.478+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:07:59.479+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:07:59.478+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:04.770+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:04.769+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa_xnz5d6 --profiles-dir /tmp/tmpebl_em2z --profile weather --target dev`
[2025-06-20T08:08:04.770+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:04.769+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa_xnz5d6 --profiles-dir /tmp/tmpebl_em2z --profile weather --target dev`
[2025-06-20T08:08:04.770+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:04.769+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa_xnz5d6 --profiles-dir /tmp/tmpebl_em2z --profile weather --target dev`
[2025-06-20T08:08:04.771+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:04.770+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:04.771+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:04.770+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:04.771+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:04.770+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:10.844+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:10.838+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa_xnz5d6', '--profiles-dir', '/tmp/tmpebl_em2z', '--profile', 'weather', '--target', 'dev'] due to the error:
08:08:07  Running with dbt=1.7.9
08:08:08  Registered adapter: postgres=1.7.9
08:08:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:08:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:08:10.847+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:10.838+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa_xnz5d6', '--profiles-dir', '/tmp/tmpebl_em2z', '--profile', 'weather', '--target', 'dev'] due to the error:
08:08:07  Running with dbt=1.7.9
08:08:08  Registered adapter: postgres=1.7.9
08:08:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:08:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:08:10.849+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:08:10.893+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.797 seconds
[2025-06-20T08:08:41.012+0000] {processor.py:161} INFO - Started process (PID=366) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:08:41.013+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:08:41.015+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.015+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:08:41.057+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.057+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:08:41.465+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.465+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:08:41.466+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.465+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:08:41.466+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.465+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:08:41.467+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.466+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:08:41.467+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.466+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:08:41.467+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.466+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:08:41.468+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.468+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:08:41.468+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.468+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:08:41.469+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.468+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:08:41.470+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.470+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpp55cfdlj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:08:41.470+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.470+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpp55cfdlj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:08:41.470+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.470+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpp55cfdlj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:08:41.471+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.471+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptp4bwy4n --profiles-dir /tmp/tmpp55cfdlj --profile weather --target dev`
[2025-06-20T08:08:41.471+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.471+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptp4bwy4n --profiles-dir /tmp/tmpp55cfdlj --profile weather --target dev`
[2025-06-20T08:08:41.471+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.471+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptp4bwy4n --profiles-dir /tmp/tmpp55cfdlj --profile weather --target dev`
[2025-06-20T08:08:41.472+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.472+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:41.472+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:41.472+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:41.473+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:41.472+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:48.651+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:48.650+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptp4bwy4n --profiles-dir /tmp/tmpp55cfdlj --profile weather --target dev`
[2025-06-20T08:08:48.652+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:48.650+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptp4bwy4n --profiles-dir /tmp/tmpp55cfdlj --profile weather --target dev`
[2025-06-20T08:08:48.653+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:48.650+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptp4bwy4n --profiles-dir /tmp/tmpp55cfdlj --profile weather --target dev`
[2025-06-20T08:08:48.653+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:48.653+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:48.654+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:48.653+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:48.654+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:48.653+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:08:56.456+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:08:56.455+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptp4bwy4n', '--profiles-dir', '/tmp/tmpp55cfdlj', '--profile', 'weather', '--target', 'dev'] due to the error:
08:08:52  Running with dbt=1.7.9
08:08:53  Registered adapter: postgres=1.7.9
08:08:53  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:08:55  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:08:56.456+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:08:56.455+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptp4bwy4n', '--profiles-dir', '/tmp/tmpp55cfdlj', '--profile', 'weather', '--target', 'dev'] due to the error:
08:08:52  Running with dbt=1.7.9
08:08:53  Registered adapter: postgres=1.7.9
08:08:53  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:08:55  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:08:56.457+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:08:56.472+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.462 seconds
[2025-06-20T08:09:26.770+0000] {processor.py:161} INFO - Started process (PID=418) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:09:26.771+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:09:26.773+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:26.773+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:09:26.833+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:26.833+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:09:27.389+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.388+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:09:27.390+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:27.388+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:09:27.390+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.388+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:09:27.391+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.391+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:09:27.391+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:27.391+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:09:27.392+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.391+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:09:27.393+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.392+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:09:27.393+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:27.392+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:09:27.394+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.392+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:09:27.396+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.395+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfwx4reaq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:09:27.396+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:27.395+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpfwx4reaq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:09:27.397+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.395+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfwx4reaq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:09:27.397+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.397+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5unvumtp --profiles-dir /tmp/tmpfwx4reaq --profile weather --target dev`
[2025-06-20T08:09:27.398+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:27.397+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5unvumtp --profiles-dir /tmp/tmpfwx4reaq --profile weather --target dev`
[2025-06-20T08:09:27.398+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.397+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5unvumtp --profiles-dir /tmp/tmpfwx4reaq --profile weather --target dev`
[2025-06-20T08:09:27.399+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.399+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:09:27.400+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:27.399+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:09:27.400+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:27.399+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:09:32.001+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:32.000+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5unvumtp --profiles-dir /tmp/tmpfwx4reaq --profile weather --target dev`
[2025-06-20T08:09:32.001+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:32.000+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5unvumtp --profiles-dir /tmp/tmpfwx4reaq --profile weather --target dev`
[2025-06-20T08:09:32.001+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:32.000+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5unvumtp --profiles-dir /tmp/tmpfwx4reaq --profile weather --target dev`
[2025-06-20T08:09:32.002+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:32.002+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:09:32.002+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:32.002+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:09:32.002+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:32.002+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:09:38.989+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:09:38.987+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5unvumtp', '--profiles-dir', '/tmp/tmpfwx4reaq', '--profile', 'weather', '--target', 'dev'] due to the error:
08:09:34  Running with dbt=1.7.9
08:09:35  Registered adapter: postgres=1.7.9
08:09:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:09:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:09:38.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:09:38.987+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5unvumtp', '--profiles-dir', '/tmp/tmpfwx4reaq', '--profile', 'weather', '--target', 'dev'] due to the error:
08:09:34  Running with dbt=1.7.9
08:09:35  Registered adapter: postgres=1.7.9
08:09:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:09:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:09:38.991+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:09:39.038+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.272 seconds
[2025-06-20T08:10:09.834+0000] {processor.py:161} INFO - Started process (PID=463) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:10:09.835+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:10:09.837+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:09.836+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:10:09.880+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:09.879+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:10:10.220+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.220+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:10:10.220+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:10.220+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:10:10.221+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.220+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:10:10.222+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.221+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:10:10.222+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:10.221+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:10:10.222+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.221+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:10:10.223+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.223+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:10:10.223+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:10.223+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:10:10.224+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.223+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:10:10.225+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.225+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp58xl5ase/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:10:10.225+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:10.225+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp58xl5ase/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:10:10.225+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.225+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp58xl5ase/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:10:10.226+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.226+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdfvky5j8 --profiles-dir /tmp/tmp58xl5ase --profile weather --target dev`
[2025-06-20T08:10:10.226+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:10.226+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdfvky5j8 --profiles-dir /tmp/tmp58xl5ase --profile weather --target dev`
[2025-06-20T08:10:10.227+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.226+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdfvky5j8 --profiles-dir /tmp/tmp58xl5ase --profile weather --target dev`
[2025-06-20T08:10:10.227+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.227+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:10.227+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:10.227+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:10.228+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:10.227+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:14.571+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:14.570+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdfvky5j8 --profiles-dir /tmp/tmp58xl5ase --profile weather --target dev`
[2025-06-20T08:10:14.571+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:14.570+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdfvky5j8 --profiles-dir /tmp/tmp58xl5ase --profile weather --target dev`
[2025-06-20T08:10:14.572+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:14.570+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdfvky5j8 --profiles-dir /tmp/tmp58xl5ase --profile weather --target dev`
[2025-06-20T08:10:14.573+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:14.572+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:14.573+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:14.572+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:14.574+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:14.572+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:22.222+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:22.220+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdfvky5j8', '--profiles-dir', '/tmp/tmp58xl5ase', '--profile', 'weather', '--target', 'dev'] due to the error:
08:10:19  Running with dbt=1.7.9
08:10:19  Registered adapter: postgres=1.7.9
08:10:19  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:10:21  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:10:22.222+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:22.220+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdfvky5j8', '--profiles-dir', '/tmp/tmp58xl5ase', '--profile', 'weather', '--target', 'dev'] due to the error:
08:10:19  Running with dbt=1.7.9
08:10:19  Registered adapter: postgres=1.7.9
08:10:19  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:10:21  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:10:22.223+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:10:22.238+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.407 seconds
[2025-06-20T08:10:52.288+0000] {processor.py:161} INFO - Started process (PID=504) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:10:52.289+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:10:52.290+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.290+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:10:52.337+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.337+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:10:52.664+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.664+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:10:52.665+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.664+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:10:52.665+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.664+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:10:52.666+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.666+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:10:52.666+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.666+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:10:52.666+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.666+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:10:52.667+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.667+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:10:52.667+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.667+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:10:52.668+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.667+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:10:52.669+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.669+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpngdaxo4y/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:10:52.669+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.669+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpngdaxo4y/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:10:52.669+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.669+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpngdaxo4y/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:10:52.670+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.670+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4co53b1c --profiles-dir /tmp/tmpngdaxo4y --profile weather --target dev`
[2025-06-20T08:10:52.670+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.670+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4co53b1c --profiles-dir /tmp/tmpngdaxo4y --profile weather --target dev`
[2025-06-20T08:10:52.670+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.670+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4co53b1c --profiles-dir /tmp/tmpngdaxo4y --profile weather --target dev`
[2025-06-20T08:10:52.671+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.671+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:52.671+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:52.671+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:52.672+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:52.671+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:58.755+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:58.754+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4co53b1c --profiles-dir /tmp/tmpngdaxo4y --profile weather --target dev`
[2025-06-20T08:10:58.755+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:58.754+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4co53b1c --profiles-dir /tmp/tmpngdaxo4y --profile weather --target dev`
[2025-06-20T08:10:58.757+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:58.754+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4co53b1c --profiles-dir /tmp/tmpngdaxo4y --profile weather --target dev`
[2025-06-20T08:10:58.758+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:58.757+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:58.758+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:10:58.757+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:10:58.759+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:10:58.757+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:11:05.241+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:05.239+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4co53b1c', '--profiles-dir', '/tmp/tmpngdaxo4y', '--profile', 'weather', '--target', 'dev'] due to the error:
08:11:02  Running with dbt=1.7.9
08:11:02  Registered adapter: postgres=1.7.9
08:11:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:11:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:11:05.242+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:05.239+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4co53b1c', '--profiles-dir', '/tmp/tmpngdaxo4y', '--profile', 'weather', '--target', 'dev'] due to the error:
08:11:02  Running with dbt=1.7.9
08:11:02  Registered adapter: postgres=1.7.9
08:11:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:11:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:11:05.242+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:11:05.265+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.979 seconds
[2025-06-20T08:11:35.924+0000] {processor.py:161} INFO - Started process (PID=552) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:11:35.924+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:11:35.927+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:35.926+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:11:35.995+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:35.994+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:11:36.591+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.590+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:11:36.591+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:36.590+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:11:36.592+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.590+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:11:36.593+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.593+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:11:36.593+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:36.593+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:11:36.594+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.593+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:11:36.595+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.594+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:11:36.595+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:36.594+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:11:36.596+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.594+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:11:36.598+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.598+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfzth2ysb/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:11:36.598+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:36.598+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpfzth2ysb/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:11:36.599+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.598+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfzth2ysb/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:11:36.599+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.599+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpashlud7q --profiles-dir /tmp/tmpfzth2ysb --profile weather --target dev`
[2025-06-20T08:11:36.600+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:36.599+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpashlud7q --profiles-dir /tmp/tmpfzth2ysb --profile weather --target dev`
[2025-06-20T08:11:36.600+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.599+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpashlud7q --profiles-dir /tmp/tmpfzth2ysb --profile weather --target dev`
[2025-06-20T08:11:36.601+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.601+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:11:36.602+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:36.601+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:11:36.602+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:36.601+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:11:42.452+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:42.451+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpashlud7q --profiles-dir /tmp/tmpfzth2ysb --profile weather --target dev`
[2025-06-20T08:11:42.453+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:42.451+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpashlud7q --profiles-dir /tmp/tmpfzth2ysb --profile weather --target dev`
[2025-06-20T08:11:42.453+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:42.451+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpashlud7q --profiles-dir /tmp/tmpfzth2ysb --profile weather --target dev`
[2025-06-20T08:11:42.454+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:42.453+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:11:42.454+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:42.453+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:11:42.454+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:42.453+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:11:48.960+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:11:48.958+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpashlud7q', '--profiles-dir', '/tmp/tmpfzth2ysb', '--profile', 'weather', '--target', 'dev'] due to the error:
08:11:45  Running with dbt=1.7.9
08:11:46  Registered adapter: postgres=1.7.9
08:11:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:11:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:11:48.961+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:11:48.958+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpashlud7q', '--profiles-dir', '/tmp/tmpfzth2ysb', '--profile', 'weather', '--target', 'dev'] due to the error:
08:11:45  Running with dbt=1.7.9
08:11:46  Registered adapter: postgres=1.7.9
08:11:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:11:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:11:48.961+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:11:48.980+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.063 seconds
[2025-06-20T08:12:19.803+0000] {processor.py:161} INFO - Started process (PID=602) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:12:19.804+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:12:19.806+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:19.806+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:12:19.846+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:19.845+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:12:20.281+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.281+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:12:20.281+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:20.281+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:12:20.282+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.281+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:12:20.282+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.282+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:12:20.283+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:20.282+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:12:20.283+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.282+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:12:20.284+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.283+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:12:20.284+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:20.283+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:12:20.284+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.283+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:12:20.286+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.285+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmplx6ixo9a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:12:20.286+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:20.285+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmplx6ixo9a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:12:20.286+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.285+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmplx6ixo9a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:12:20.287+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.286+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptgpndzlo --profiles-dir /tmp/tmplx6ixo9a --profile weather --target dev`
[2025-06-20T08:12:20.287+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:20.286+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptgpndzlo --profiles-dir /tmp/tmplx6ixo9a --profile weather --target dev`
[2025-06-20T08:12:20.287+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.286+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptgpndzlo --profiles-dir /tmp/tmplx6ixo9a --profile weather --target dev`
[2025-06-20T08:12:20.288+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.287+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:12:20.288+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:20.287+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:12:20.288+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:20.287+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:12:24.477+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:24.477+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptgpndzlo --profiles-dir /tmp/tmplx6ixo9a --profile weather --target dev`
[2025-06-20T08:12:24.478+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:24.477+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptgpndzlo --profiles-dir /tmp/tmplx6ixo9a --profile weather --target dev`
[2025-06-20T08:12:24.478+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:24.477+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptgpndzlo --profiles-dir /tmp/tmplx6ixo9a --profile weather --target dev`
[2025-06-20T08:12:24.478+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:24.478+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:12:24.479+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:24.478+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:12:24.479+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:24.478+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:12:30.049+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:12:30.041+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptgpndzlo', '--profiles-dir', '/tmp/tmplx6ixo9a', '--profile', 'weather', '--target', 'dev'] due to the error:
08:12:27  Running with dbt=1.7.9
08:12:27  Registered adapter: postgres=1.7.9
08:12:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:12:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:12:30.050+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:12:30.041+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptgpndzlo', '--profiles-dir', '/tmp/tmplx6ixo9a', '--profile', 'weather', '--target', 'dev'] due to the error:
08:12:27  Running with dbt=1.7.9
08:12:27  Registered adapter: postgres=1.7.9
08:12:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:12:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:12:30.051+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:12:30.070+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.270 seconds
[2025-06-20T08:13:00.404+0000] {processor.py:161} INFO - Started process (PID=642) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:13:00.405+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:13:00.407+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.407+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:13:00.448+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.448+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:13:00.778+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.777+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:13:00.778+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.777+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:13:00.778+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.777+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:13:00.779+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.779+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:13:00.779+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.779+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:13:00.779+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.779+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:13:00.780+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.780+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:13:00.780+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.780+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:13:00.781+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.780+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:13:00.782+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.782+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpahmghcem/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:13:00.782+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.782+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpahmghcem/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:13:00.782+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.782+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpahmghcem/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:13:00.783+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.783+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1zmn0k54 --profiles-dir /tmp/tmpahmghcem --profile weather --target dev`
[2025-06-20T08:13:00.783+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.783+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1zmn0k54 --profiles-dir /tmp/tmpahmghcem --profile weather --target dev`
[2025-06-20T08:13:00.783+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.783+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1zmn0k54 --profiles-dir /tmp/tmpahmghcem --profile weather --target dev`
[2025-06-20T08:13:00.784+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.784+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:00.784+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:00.784+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:00.785+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:00.784+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:05.058+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:05.058+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1zmn0k54 --profiles-dir /tmp/tmpahmghcem --profile weather --target dev`
[2025-06-20T08:13:05.059+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:05.058+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1zmn0k54 --profiles-dir /tmp/tmpahmghcem --profile weather --target dev`
[2025-06-20T08:13:05.059+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:05.058+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1zmn0k54 --profiles-dir /tmp/tmpahmghcem --profile weather --target dev`
[2025-06-20T08:13:05.060+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:05.059+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:05.060+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:05.059+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:05.060+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:05.059+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:14.903+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:14.901+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1zmn0k54', '--profiles-dir', '/tmp/tmpahmghcem', '--profile', 'weather', '--target', 'dev'] due to the error:
08:13:08  Running with dbt=1.7.9
08:13:09  Registered adapter: postgres=1.7.9
08:13:09  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:13:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:13:14.904+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:14.901+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1zmn0k54', '--profiles-dir', '/tmp/tmpahmghcem', '--profile', 'weather', '--target', 'dev'] due to the error:
08:13:08  Running with dbt=1.7.9
08:13:09  Registered adapter: postgres=1.7.9
08:13:09  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:13:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:13:14.905+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:13:14.927+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.525 seconds
[2025-06-20T08:13:45.121+0000] {processor.py:161} INFO - Started process (PID=683) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:13:45.122+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:13:45.124+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.123+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:13:45.164+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.164+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:13:45.538+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.538+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:13:45.538+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.538+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:13:45.539+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.538+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:13:45.539+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.539+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:13:45.540+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.539+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:13:45.540+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.539+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:13:45.541+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.540+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:13:45.541+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.540+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:13:45.541+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.540+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:13:45.542+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.542+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6jpfht47/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:13:45.543+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.542+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp6jpfht47/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:13:45.543+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.542+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6jpfht47/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:13:45.544+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.543+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm8i3iei8 --profiles-dir /tmp/tmp6jpfht47 --profile weather --target dev`
[2025-06-20T08:13:45.544+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.543+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm8i3iei8 --profiles-dir /tmp/tmp6jpfht47 --profile weather --target dev`
[2025-06-20T08:13:45.544+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.543+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm8i3iei8 --profiles-dir /tmp/tmp6jpfht47 --profile weather --target dev`
[2025-06-20T08:13:45.545+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.544+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:45.545+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:45.544+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:45.545+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:45.544+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:49.961+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:49.961+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm8i3iei8 --profiles-dir /tmp/tmp6jpfht47 --profile weather --target dev`
[2025-06-20T08:13:49.962+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:49.961+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm8i3iei8 --profiles-dir /tmp/tmp6jpfht47 --profile weather --target dev`
[2025-06-20T08:13:49.962+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:49.961+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm8i3iei8 --profiles-dir /tmp/tmp6jpfht47 --profile weather --target dev`
[2025-06-20T08:13:49.962+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:49.962+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:49.962+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:49.962+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:49.963+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:49.962+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:13:57.831+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:13:57.829+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpm8i3iei8', '--profiles-dir', '/tmp/tmp6jpfht47', '--profile', 'weather', '--target', 'dev'] due to the error:
08:13:54  Running with dbt=1.7.9
08:13:55  Registered adapter: postgres=1.7.9
08:13:55  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:13:56  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:13:57.832+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:13:57.829+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpm8i3iei8', '--profiles-dir', '/tmp/tmp6jpfht47', '--profile', 'weather', '--target', 'dev'] due to the error:
08:13:54  Running with dbt=1.7.9
08:13:55  Registered adapter: postgres=1.7.9
08:13:55  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:13:56  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:13:57.832+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:13:57.857+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.739 seconds
[2025-06-20T08:14:28.231+0000] {processor.py:161} INFO - Started process (PID=727) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:14:28.232+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:14:28.234+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.234+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:14:28.275+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.274+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:14:28.604+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.603+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:14:28.604+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.603+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:14:28.604+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.603+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:14:28.605+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.605+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:14:28.605+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.605+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:14:28.606+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.605+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:14:28.606+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.606+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:14:28.606+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.606+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:14:28.607+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.606+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:14:28.608+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.608+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwa_2_s7f/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:14:28.608+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.608+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpwa_2_s7f/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:14:28.609+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.608+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwa_2_s7f/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:14:28.609+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.609+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpayhvz4p7 --profiles-dir /tmp/tmpwa_2_s7f --profile weather --target dev`
[2025-06-20T08:14:28.609+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.609+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpayhvz4p7 --profiles-dir /tmp/tmpwa_2_s7f --profile weather --target dev`
[2025-06-20T08:14:28.610+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.609+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpayhvz4p7 --profiles-dir /tmp/tmpwa_2_s7f --profile weather --target dev`
[2025-06-20T08:14:28.610+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.610+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:14:28.610+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:28.610+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:14:28.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:28.610+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:14:35.231+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:35.230+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpayhvz4p7 --profiles-dir /tmp/tmpwa_2_s7f --profile weather --target dev`
[2025-06-20T08:14:35.231+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:35.230+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpayhvz4p7 --profiles-dir /tmp/tmpwa_2_s7f --profile weather --target dev`
[2025-06-20T08:14:35.232+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:35.230+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpayhvz4p7 --profiles-dir /tmp/tmpwa_2_s7f --profile weather --target dev`
[2025-06-20T08:14:35.232+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:35.232+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:14:35.233+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:35.232+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:14:35.233+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:35.232+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:14:41.499+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:14:41.497+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpayhvz4p7', '--profiles-dir', '/tmp/tmpwa_2_s7f', '--profile', 'weather', '--target', 'dev'] due to the error:
08:14:38  Running with dbt=1.7.9
08:14:38  Registered adapter: postgres=1.7.9
08:14:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:14:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:14:41.499+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:14:41.497+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpayhvz4p7', '--profiles-dir', '/tmp/tmpwa_2_s7f', '--profile', 'weather', '--target', 'dev'] due to the error:
08:14:38  Running with dbt=1.7.9
08:14:38  Registered adapter: postgres=1.7.9
08:14:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:14:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:14:41.500+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:14:41.520+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.291 seconds
[2025-06-20T08:15:11.679+0000] {processor.py:161} INFO - Started process (PID=778) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:15:11.680+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:15:11.682+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:11.682+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:15:11.744+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:11.744+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:15:12.243+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.243+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:15:12.244+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:12.243+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:15:12.244+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.243+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:15:12.245+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.245+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:15:12.246+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:12.245+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:15:12.246+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.245+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:15:12.247+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.246+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:15:12.247+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:12.246+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:15:12.248+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.246+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:15:12.249+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.249+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7ki5mrjq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:15:12.250+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:12.249+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp7ki5mrjq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:15:12.250+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.249+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7ki5mrjq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:15:12.251+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.251+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx6_u4xqv --profiles-dir /tmp/tmp7ki5mrjq --profile weather --target dev`
[2025-06-20T08:15:12.251+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:12.251+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx6_u4xqv --profiles-dir /tmp/tmp7ki5mrjq --profile weather --target dev`
[2025-06-20T08:15:12.252+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.251+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx6_u4xqv --profiles-dir /tmp/tmp7ki5mrjq --profile weather --target dev`
[2025-06-20T08:15:12.253+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.252+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:15:12.253+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:15:12.252+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:15:12.254+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:15:12.252+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:28:46.451+0000] {processor.py:161} INFO - Started process (PID=67) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:28:46.465+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:28:46.479+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:46.478+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:28:46.807+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:46.805+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:28:53.802+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.801+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:28:53.805+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:53.801+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:28:53.808+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.801+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:28:53.831+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.831+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:28:53.833+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:53.831+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:28:53.834+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.831+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:28:53.837+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.834+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:28:53.838+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:53.834+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:28:53.838+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.834+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:28:53.844+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.844+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpje7n3v1z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:28:53.845+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:53.844+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpje7n3v1z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:28:53.848+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.844+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpje7n3v1z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:28:53.850+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.850+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3eyuwi2c --profiles-dir /tmp/tmpje7n3v1z --profile weather --target dev`
[2025-06-20T08:28:53.853+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:53.850+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3eyuwi2c --profiles-dir /tmp/tmpje7n3v1z --profile weather --target dev`
[2025-06-20T08:28:53.854+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.850+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3eyuwi2c --profiles-dir /tmp/tmpje7n3v1z --profile weather --target dev`
[2025-06-20T08:28:53.859+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.858+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:28:53.862+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:28:53.858+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:28:53.863+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:28:53.858+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:01.833+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:01.832+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3eyuwi2c --profiles-dir /tmp/tmpje7n3v1z --profile weather --target dev`
[2025-06-20T08:29:01.835+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:01.832+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3eyuwi2c --profiles-dir /tmp/tmpje7n3v1z --profile weather --target dev`
[2025-06-20T08:29:01.836+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:01.832+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3eyuwi2c --profiles-dir /tmp/tmpje7n3v1z --profile weather --target dev`
[2025-06-20T08:29:01.837+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:01.837+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:01.839+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:01.837+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:01.840+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:01.837+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:09.096+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:09.092+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3eyuwi2c', '--profiles-dir', '/tmp/tmpje7n3v1z', '--profile', 'weather', '--target', 'dev'] due to the error:
08:29:06  Running with dbt=1.7.9
08:29:06  Registered adapter: postgres=1.7.9
08:29:06  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:29:07  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:29:09.097+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:09.092+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3eyuwi2c', '--profiles-dir', '/tmp/tmpje7n3v1z', '--profile', 'weather', '--target', 'dev'] due to the error:
08:29:06  Running with dbt=1.7.9
08:29:06  Registered adapter: postgres=1.7.9
08:29:06  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:29:07  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:29:09.097+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:29:09.117+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 22.672 seconds
[2025-06-20T08:29:39.636+0000] {processor.py:161} INFO - Started process (PID=108) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:29:39.637+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:29:39.638+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:39.638+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:29:39.684+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:39.684+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:29:40.155+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.154+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:29:40.155+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:40.154+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:29:40.156+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.154+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:29:40.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.156+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:29:40.157+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:40.156+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:29:40.158+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.156+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:29:40.159+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.158+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:29:40.159+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:40.158+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:29:40.160+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.158+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:29:40.162+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.162+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpoo99vswb/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:29:40.162+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:40.162+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpoo99vswb/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:29:40.163+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.162+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpoo99vswb/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:29:40.163+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.163+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdjetefow --profiles-dir /tmp/tmpoo99vswb --profile weather --target dev`
[2025-06-20T08:29:40.164+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:40.163+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdjetefow --profiles-dir /tmp/tmpoo99vswb --profile weather --target dev`
[2025-06-20T08:29:40.164+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.163+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdjetefow --profiles-dir /tmp/tmpoo99vswb --profile weather --target dev`
[2025-06-20T08:29:40.165+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.164+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:40.166+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:40.164+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:40.166+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:40.164+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:48.605+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:48.605+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdjetefow --profiles-dir /tmp/tmpoo99vswb --profile weather --target dev`
[2025-06-20T08:29:48.606+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:48.605+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdjetefow --profiles-dir /tmp/tmpoo99vswb --profile weather --target dev`
[2025-06-20T08:29:48.606+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:48.605+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdjetefow --profiles-dir /tmp/tmpoo99vswb --profile weather --target dev`
[2025-06-20T08:29:48.607+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:48.606+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:48.607+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:48.606+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:48.607+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:48.606+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:29:54.481+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:29:54.479+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdjetefow', '--profiles-dir', '/tmp/tmpoo99vswb', '--profile', 'weather', '--target', 'dev'] due to the error:
08:29:51  Running with dbt=1.7.9
08:29:51  Registered adapter: postgres=1.7.9
08:29:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:29:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:29:54.481+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:29:54.479+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdjetefow', '--profiles-dir', '/tmp/tmpoo99vswb', '--profile', 'weather', '--target', 'dev'] due to the error:
08:29:51  Running with dbt=1.7.9
08:29:51  Registered adapter: postgres=1.7.9
08:29:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:29:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:29:54.482+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:29:54.497+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.864 seconds
[2025-06-20T08:30:24.694+0000] {processor.py:161} INFO - Started process (PID=161) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:30:24.694+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:30:24.696+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:24.696+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:30:24.743+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:24.743+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:30:25.095+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.094+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:30:25.095+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:25.094+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:30:25.096+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.094+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:30:25.096+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.096+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:30:25.097+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:25.096+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:30:25.097+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.096+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:30:25.098+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.097+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:30:25.098+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:25.097+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:30:25.098+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.097+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:30:25.099+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.099+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1fcn_gnt/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:30:25.100+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:25.099+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp1fcn_gnt/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:30:25.100+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.099+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1fcn_gnt/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:30:25.101+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.100+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprn_m5v83 --profiles-dir /tmp/tmp1fcn_gnt --profile weather --target dev`
[2025-06-20T08:30:25.101+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:25.100+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprn_m5v83 --profiles-dir /tmp/tmp1fcn_gnt --profile weather --target dev`
[2025-06-20T08:30:25.101+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.100+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprn_m5v83 --profiles-dir /tmp/tmp1fcn_gnt --profile weather --target dev`
[2025-06-20T08:30:25.102+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.101+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:30:25.102+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:25.101+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:30:25.102+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:25.101+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:30:29.217+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:29.217+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprn_m5v83 --profiles-dir /tmp/tmp1fcn_gnt --profile weather --target dev`
[2025-06-20T08:30:29.218+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:29.217+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprn_m5v83 --profiles-dir /tmp/tmp1fcn_gnt --profile weather --target dev`
[2025-06-20T08:30:29.218+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:29.217+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprn_m5v83 --profiles-dir /tmp/tmp1fcn_gnt --profile weather --target dev`
[2025-06-20T08:30:29.218+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:29.218+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:30:29.219+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:29.218+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:30:29.219+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:29.218+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:30:35.194+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:30:35.192+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprn_m5v83', '--profiles-dir', '/tmp/tmp1fcn_gnt', '--profile', 'weather', '--target', 'dev'] due to the error:
08:30:32  Running with dbt=1.7.9
08:30:32  Registered adapter: postgres=1.7.9
08:30:32  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:30:33  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:30:35.195+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:30:35.192+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprn_m5v83', '--profiles-dir', '/tmp/tmp1fcn_gnt', '--profile', 'weather', '--target', 'dev'] due to the error:
08:30:32  Running with dbt=1.7.9
08:30:32  Registered adapter: postgres=1.7.9
08:30:32  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:30:33  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:30:35.196+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:30:35.215+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.524 seconds
[2025-06-20T08:31:06.168+0000] {processor.py:161} INFO - Started process (PID=202) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:31:06.169+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:31:06.170+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.170+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:31:06.215+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.215+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:31:06.570+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.569+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:31:06.570+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.569+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:31:06.570+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.569+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:31:06.571+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.571+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:31:06.571+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.571+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:31:06.572+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.571+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:31:06.572+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.572+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:31:06.573+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.572+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:31:06.573+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.572+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:31:06.574+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.574+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdxzmmryp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:31:06.575+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.574+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpdxzmmryp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:31:06.575+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.574+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdxzmmryp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:31:06.575+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.575+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_oqd3fhd --profiles-dir /tmp/tmpdxzmmryp --profile weather --target dev`
[2025-06-20T08:31:06.576+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.575+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_oqd3fhd --profiles-dir /tmp/tmpdxzmmryp --profile weather --target dev`
[2025-06-20T08:31:06.576+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.575+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_oqd3fhd --profiles-dir /tmp/tmpdxzmmryp --profile weather --target dev`
[2025-06-20T08:31:06.576+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.576+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:06.577+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:06.576+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:06.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:06.576+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:10.776+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:10.775+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_oqd3fhd --profiles-dir /tmp/tmpdxzmmryp --profile weather --target dev`
[2025-06-20T08:31:10.776+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:10.775+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_oqd3fhd --profiles-dir /tmp/tmpdxzmmryp --profile weather --target dev`
[2025-06-20T08:31:10.777+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:10.775+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_oqd3fhd --profiles-dir /tmp/tmpdxzmmryp --profile weather --target dev`
[2025-06-20T08:31:10.778+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:10.777+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:10.778+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:10.777+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:10.779+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:10.777+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:21.141+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:21.139+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_oqd3fhd', '--profiles-dir', '/tmp/tmpdxzmmryp', '--profile', 'weather', '--target', 'dev'] due to the error:
08:31:16  Running with dbt=1.7.9
08:31:17  Registered adapter: postgres=1.7.9
08:31:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:31:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:31:21.141+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:21.139+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_oqd3fhd', '--profiles-dir', '/tmp/tmpdxzmmryp', '--profile', 'weather', '--target', 'dev'] due to the error:
08:31:16  Running with dbt=1.7.9
08:31:17  Registered adapter: postgres=1.7.9
08:31:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:31:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:31:21.142+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:31:21.157+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.991 seconds
[2025-06-20T08:31:51.446+0000] {processor.py:161} INFO - Started process (PID=249) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:31:51.447+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:31:51.449+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.448+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:31:51.493+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.493+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:31:51.807+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.807+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:31:51.807+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.807+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:31:51.808+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.807+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:31:51.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.808+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:31:51.809+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.808+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:31:51.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.808+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:31:51.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.809+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:31:51.810+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.809+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:31:51.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.809+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:31:51.812+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.811+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpysbjz0_6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:31:51.812+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.811+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpysbjz0_6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:31:51.812+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.811+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpysbjz0_6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:31:51.813+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.812+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4bswwepd --profiles-dir /tmp/tmpysbjz0_6 --profile weather --target dev`
[2025-06-20T08:31:51.813+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.812+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4bswwepd --profiles-dir /tmp/tmpysbjz0_6 --profile weather --target dev`
[2025-06-20T08:31:51.813+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.812+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4bswwepd --profiles-dir /tmp/tmpysbjz0_6 --profile weather --target dev`
[2025-06-20T08:31:51.814+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.813+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:51.814+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:51.813+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:51.814+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:51.813+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:57.129+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:57.128+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4bswwepd --profiles-dir /tmp/tmpysbjz0_6 --profile weather --target dev`
[2025-06-20T08:31:57.134+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:57.128+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4bswwepd --profiles-dir /tmp/tmpysbjz0_6 --profile weather --target dev`
[2025-06-20T08:31:57.135+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:57.128+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4bswwepd --profiles-dir /tmp/tmpysbjz0_6 --profile weather --target dev`
[2025-06-20T08:31:57.135+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:57.135+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:57.138+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:31:57.135+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:31:57.139+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:31:57.135+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:32:04.450+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:04.448+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4bswwepd', '--profiles-dir', '/tmp/tmpysbjz0_6', '--profile', 'weather', '--target', 'dev'] due to the error:
08:32:01  Running with dbt=1.7.9
08:32:01  Registered adapter: postgres=1.7.9
08:32:01  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:32:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:32:04.450+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:04.448+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4bswwepd', '--profiles-dir', '/tmp/tmpysbjz0_6', '--profile', 'weather', '--target', 'dev'] due to the error:
08:32:01  Running with dbt=1.7.9
08:32:01  Registered adapter: postgres=1.7.9
08:32:01  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:32:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:32:04.451+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:32:04.466+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.023 seconds
[2025-06-20T08:32:34.801+0000] {processor.py:161} INFO - Started process (PID=290) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:32:34.801+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:32:34.803+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:34.803+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:32:34.853+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:34.853+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:32:35.185+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.184+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:32:35.185+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:35.184+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:32:35.186+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.184+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:32:35.186+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.186+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:32:35.187+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:35.186+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:32:35.187+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.186+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:32:35.188+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.187+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:32:35.188+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:35.187+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:32:35.188+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.187+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:32:35.189+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.189+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3lpfhb5z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:32:35.190+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:35.189+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp3lpfhb5z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:32:35.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.189+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3lpfhb5z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:32:35.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.190+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp44mht6k5 --profiles-dir /tmp/tmp3lpfhb5z --profile weather --target dev`
[2025-06-20T08:32:35.191+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:35.190+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp44mht6k5 --profiles-dir /tmp/tmp3lpfhb5z --profile weather --target dev`
[2025-06-20T08:32:35.191+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.190+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp44mht6k5 --profiles-dir /tmp/tmp3lpfhb5z --profile weather --target dev`
[2025-06-20T08:32:35.191+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.191+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:32:35.192+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:35.191+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:32:35.192+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:35.191+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:32:40.504+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:40.503+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp44mht6k5 --profiles-dir /tmp/tmp3lpfhb5z --profile weather --target dev`
[2025-06-20T08:32:40.504+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:40.503+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp44mht6k5 --profiles-dir /tmp/tmp3lpfhb5z --profile weather --target dev`
[2025-06-20T08:32:40.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:40.503+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp44mht6k5 --profiles-dir /tmp/tmp3lpfhb5z --profile weather --target dev`
[2025-06-20T08:32:40.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:40.505+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:32:40.505+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:40.505+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:32:40.506+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:40.505+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:32:46.366+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:32:46.365+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp44mht6k5', '--profiles-dir', '/tmp/tmp3lpfhb5z', '--profile', 'weather', '--target', 'dev'] due to the error:
08:32:43  Running with dbt=1.7.9
08:32:43  Registered adapter: postgres=1.7.9
08:32:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:32:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:32:46.367+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:32:46.365+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp44mht6k5', '--profiles-dir', '/tmp/tmp3lpfhb5z', '--profile', 'weather', '--target', 'dev'] due to the error:
08:32:43  Running with dbt=1.7.9
08:32:43  Registered adapter: postgres=1.7.9
08:32:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:32:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:32:46.367+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:32:46.382+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.584 seconds
[2025-06-20T08:33:17.169+0000] {processor.py:161} INFO - Started process (PID=338) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:33:17.170+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:33:17.173+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.173+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:33:17.244+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.244+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:33:17.771+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.770+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:33:17.772+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.770+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:33:17.772+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.770+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:33:17.774+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.773+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:33:17.775+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.773+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:33:17.776+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.773+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:33:17.778+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.776+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:33:17.779+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.776+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:33:17.779+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.776+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:33:17.783+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.782+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpna9e31ae/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:33:17.784+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.782+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpna9e31ae/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:33:17.785+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.782+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpna9e31ae/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:33:17.786+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.786+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa82l6n3d --profiles-dir /tmp/tmpna9e31ae --profile weather --target dev`
[2025-06-20T08:33:17.788+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.786+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa82l6n3d --profiles-dir /tmp/tmpna9e31ae --profile weather --target dev`
[2025-06-20T08:33:17.788+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.786+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa82l6n3d --profiles-dir /tmp/tmpna9e31ae --profile weather --target dev`
[2025-06-20T08:33:17.789+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.788+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:17.790+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:17.788+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:17.791+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:17.788+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:22.936+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:22.935+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa82l6n3d --profiles-dir /tmp/tmpna9e31ae --profile weather --target dev`
[2025-06-20T08:33:22.936+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:22.935+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa82l6n3d --profiles-dir /tmp/tmpna9e31ae --profile weather --target dev`
[2025-06-20T08:33:22.936+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:22.935+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa82l6n3d --profiles-dir /tmp/tmpna9e31ae --profile weather --target dev`
[2025-06-20T08:33:22.937+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:22.936+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:22.937+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:22.936+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:22.937+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:22.936+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:28.698+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:28.697+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa82l6n3d', '--profiles-dir', '/tmp/tmpna9e31ae', '--profile', 'weather', '--target', 'dev'] due to the error:
08:33:26  Running with dbt=1.7.9
08:33:26  Registered adapter: postgres=1.7.9
08:33:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:33:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:33:28.699+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:28.697+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa82l6n3d', '--profiles-dir', '/tmp/tmpna9e31ae', '--profile', 'weather', '--target', 'dev'] due to the error:
08:33:26  Running with dbt=1.7.9
08:33:26  Registered adapter: postgres=1.7.9
08:33:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:33:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:33:28.699+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:33:28.714+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.549 seconds
[2025-06-20T08:33:59.252+0000] {processor.py:161} INFO - Started process (PID=383) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:33:59.255+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:33:59.257+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.257+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:33:59.352+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.351+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:33:59.835+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.835+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:33:59.836+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.835+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:33:59.836+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.835+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:33:59.837+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.837+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:33:59.838+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.837+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:33:59.838+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.837+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:33:59.839+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.839+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:33:59.839+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.839+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:33:59.840+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.839+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:33:59.842+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.842+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpu2n6nfta/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:33:59.842+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.842+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpu2n6nfta/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:33:59.843+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.842+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpu2n6nfta/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:33:59.843+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.843+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9gp6tk8b --profiles-dir /tmp/tmpu2n6nfta --profile weather --target dev`
[2025-06-20T08:33:59.844+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.843+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9gp6tk8b --profiles-dir /tmp/tmpu2n6nfta --profile weather --target dev`
[2025-06-20T08:33:59.844+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.843+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9gp6tk8b --profiles-dir /tmp/tmpu2n6nfta --profile weather --target dev`
[2025-06-20T08:33:59.845+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.845+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:59.845+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:33:59.845+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:33:59.846+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:33:59.845+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:04.321+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:04.320+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9gp6tk8b --profiles-dir /tmp/tmpu2n6nfta --profile weather --target dev`
[2025-06-20T08:34:04.321+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:04.320+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9gp6tk8b --profiles-dir /tmp/tmpu2n6nfta --profile weather --target dev`
[2025-06-20T08:34:04.322+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:04.320+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9gp6tk8b --profiles-dir /tmp/tmpu2n6nfta --profile weather --target dev`
[2025-06-20T08:34:04.322+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:04.322+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:04.323+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:04.322+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:04.324+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:04.322+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:19.043+0000] {processor.py:161} INFO - Started process (PID=410) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:34:19.044+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:34:19.047+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.046+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:34:19.117+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.117+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:34:19.606+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.606+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:34:19.606+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.606+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:34:19.607+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.606+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:34:19.608+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.608+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:34:19.609+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.608+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:34:19.609+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.608+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:34:19.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.610+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:34:19.611+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.610+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:34:19.612+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.610+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:34:19.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.614+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpf5ii4ho6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:34:19.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.614+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpf5ii4ho6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:34:19.616+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.614+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpf5ii4ho6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:34:19.617+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.617+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjf6uoc46 --profiles-dir /tmp/tmpf5ii4ho6 --profile weather --target dev`
[2025-06-20T08:34:19.619+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.617+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjf6uoc46 --profiles-dir /tmp/tmpf5ii4ho6 --profile weather --target dev`
[2025-06-20T08:34:19.619+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.617+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjf6uoc46 --profiles-dir /tmp/tmpf5ii4ho6 --profile weather --target dev`
[2025-06-20T08:34:19.620+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.619+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:19.621+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:19.619+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:19.621+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:19.619+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:24.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:24.808+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjf6uoc46 --profiles-dir /tmp/tmpf5ii4ho6 --profile weather --target dev`
[2025-06-20T08:34:24.809+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:24.808+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjf6uoc46 --profiles-dir /tmp/tmpf5ii4ho6 --profile weather --target dev`
[2025-06-20T08:34:24.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:24.808+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjf6uoc46 --profiles-dir /tmp/tmpf5ii4ho6 --profile weather --target dev`
[2025-06-20T08:34:24.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:24.810+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:24.810+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:24.810+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:24.811+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:24.810+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:34:32.765+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:34:32.764+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjf6uoc46', '--profiles-dir', '/tmp/tmpf5ii4ho6', '--profile', 'weather', '--target', 'dev'] due to the error:
08:34:28  Running with dbt=1.7.9
08:34:29  Registered adapter: postgres=1.7.9
08:34:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:34:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:34:32.766+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:34:32.764+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjf6uoc46', '--profiles-dir', '/tmp/tmpf5ii4ho6', '--profile', 'weather', '--target', 'dev'] due to the error:
08:34:28  Running with dbt=1.7.9
08:34:29  Registered adapter: postgres=1.7.9
08:34:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:34:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:34:32.766+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:34:32.790+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.750 seconds
[2025-06-20T08:35:03.164+0000] {processor.py:161} INFO - Started process (PID=452) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:35:03.165+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:35:03.167+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.167+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:35:03.241+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.240+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:35:03.574+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.574+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:35:03.575+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.574+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:35:03.575+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.574+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:35:03.576+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.575+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:35:03.576+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.575+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:35:03.576+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.575+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:35:03.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.577+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:35:03.577+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.577+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:35:03.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.577+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:35:03.579+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.579+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpx84h3ysh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:35:03.579+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.579+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpx84h3ysh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:35:03.579+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.579+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpx84h3ysh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:35:03.580+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.580+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg55gwryf --profiles-dir /tmp/tmpx84h3ysh --profile weather --target dev`
[2025-06-20T08:35:03.580+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.580+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg55gwryf --profiles-dir /tmp/tmpx84h3ysh --profile weather --target dev`
[2025-06-20T08:35:03.580+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.580+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg55gwryf --profiles-dir /tmp/tmpx84h3ysh --profile weather --target dev`
[2025-06-20T08:35:03.581+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.580+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:03.581+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:03.580+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:03.581+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:03.580+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:07.733+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:07.732+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg55gwryf --profiles-dir /tmp/tmpx84h3ysh --profile weather --target dev`
[2025-06-20T08:35:07.733+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:07.732+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg55gwryf --profiles-dir /tmp/tmpx84h3ysh --profile weather --target dev`
[2025-06-20T08:35:07.734+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:07.732+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg55gwryf --profiles-dir /tmp/tmpx84h3ysh --profile weather --target dev`
[2025-06-20T08:35:07.735+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:07.734+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:07.735+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:07.734+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:07.736+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:07.734+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:15.187+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:15.184+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpg55gwryf', '--profiles-dir', '/tmp/tmpx84h3ysh', '--profile', 'weather', '--target', 'dev'] due to the error:
08:35:12  Running with dbt=1.7.9
08:35:12  Registered adapter: postgres=1.7.9
08:35:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:35:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:35:15.188+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:15.184+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpg55gwryf', '--profiles-dir', '/tmp/tmpx84h3ysh', '--profile', 'weather', '--target', 'dev'] due to the error:
08:35:12  Running with dbt=1.7.9
08:35:12  Registered adapter: postgres=1.7.9
08:35:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:35:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:35:15.189+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:35:15.209+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.052 seconds
[2025-06-20T08:35:46.027+0000] {processor.py:161} INFO - Started process (PID=492) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:35:46.028+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:35:46.030+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.030+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:35:46.225+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.225+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:35:46.426+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.425+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:35:46.426+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.425+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:35:46.426+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.425+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:35:46.427+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.427+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:35:46.427+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.427+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:35:46.427+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.427+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:35:46.428+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.428+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:35:46.428+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.428+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:35:46.429+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.428+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:35:46.430+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.430+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpx1a1zpm7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:35:46.430+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.430+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpx1a1zpm7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:35:46.431+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.430+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpx1a1zpm7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:35:46.431+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.431+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgtj35_na --profiles-dir /tmp/tmpx1a1zpm7 --profile weather --target dev`
[2025-06-20T08:35:46.431+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.431+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgtj35_na --profiles-dir /tmp/tmpx1a1zpm7 --profile weather --target dev`
[2025-06-20T08:35:46.432+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.431+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgtj35_na --profiles-dir /tmp/tmpx1a1zpm7 --profile weather --target dev`
[2025-06-20T08:35:46.432+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.432+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:46.433+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:46.432+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:46.433+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:46.432+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:55.506+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:55.505+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgtj35_na --profiles-dir /tmp/tmpx1a1zpm7 --profile weather --target dev`
[2025-06-20T08:35:55.506+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:55.505+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgtj35_na --profiles-dir /tmp/tmpx1a1zpm7 --profile weather --target dev`
[2025-06-20T08:35:55.506+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:55.505+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgtj35_na --profiles-dir /tmp/tmpx1a1zpm7 --profile weather --target dev`
[2025-06-20T08:35:55.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:55.507+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:55.507+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:35:55.507+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:35:55.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:35:55.507+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:36:02.801+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:02.799+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgtj35_na', '--profiles-dir', '/tmp/tmpx1a1zpm7', '--profile', 'weather', '--target', 'dev'] due to the error:
08:35:58  Running with dbt=1.7.9
08:35:59  Registered adapter: postgres=1.7.9
08:35:59  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:36:01  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:36:02.802+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:02.799+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgtj35_na', '--profiles-dir', '/tmp/tmpx1a1zpm7', '--profile', 'weather', '--target', 'dev'] due to the error:
08:35:58  Running with dbt=1.7.9
08:35:59  Registered adapter: postgres=1.7.9
08:35:59  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:36:01  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:36:02.803+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:36:02.819+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 16.795 seconds
[2025-06-20T08:36:32.878+0000] {processor.py:161} INFO - Started process (PID=546) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:36:32.879+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:36:32.881+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:32.881+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:36:32.962+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:32.962+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:36:33.534+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.533+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:36:33.534+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:33.533+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:36:33.535+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.533+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:36:33.536+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.536+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:36:33.537+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:33.536+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:36:33.537+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.536+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:36:33.538+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.538+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:36:33.539+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:33.538+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:36:33.539+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.538+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:36:33.541+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.541+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpqsrv87wy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:36:33.542+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:33.541+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpqsrv87wy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:36:33.542+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.541+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpqsrv87wy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:36:33.543+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.543+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxf5hvsws --profiles-dir /tmp/tmpqsrv87wy --profile weather --target dev`
[2025-06-20T08:36:33.543+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:33.543+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxf5hvsws --profiles-dir /tmp/tmpqsrv87wy --profile weather --target dev`
[2025-06-20T08:36:33.544+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.543+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxf5hvsws --profiles-dir /tmp/tmpqsrv87wy --profile weather --target dev`
[2025-06-20T08:36:33.545+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.544+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:36:33.545+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:33.544+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:36:33.546+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:33.544+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:36:39.613+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:39.613+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxf5hvsws --profiles-dir /tmp/tmpqsrv87wy --profile weather --target dev`
[2025-06-20T08:36:39.614+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:39.613+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxf5hvsws --profiles-dir /tmp/tmpqsrv87wy --profile weather --target dev`
[2025-06-20T08:36:39.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:39.613+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxf5hvsws --profiles-dir /tmp/tmpqsrv87wy --profile weather --target dev`
[2025-06-20T08:36:39.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:39.614+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:36:39.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:39.614+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:36:39.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:39.614+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:36:46.915+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:36:46.913+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxf5hvsws', '--profiles-dir', '/tmp/tmpqsrv87wy', '--profile', 'weather', '--target', 'dev'] due to the error:
08:36:42  Running with dbt=1.7.9
08:36:43  Registered adapter: postgres=1.7.9
08:36:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:36:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:36:46.915+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:36:46.913+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxf5hvsws', '--profiles-dir', '/tmp/tmpqsrv87wy', '--profile', 'weather', '--target', 'dev'] due to the error:
08:36:42  Running with dbt=1.7.9
08:36:43  Registered adapter: postgres=1.7.9
08:36:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:36:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:36:46.916+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:36:46.930+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.055 seconds
[2025-06-20T08:37:17.401+0000] {processor.py:161} INFO - Started process (PID=588) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:37:17.401+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:37:17.405+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.404+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:37:17.609+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.608+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:37:17.804+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.804+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:37:17.805+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.804+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:37:17.805+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.804+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:37:17.806+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.805+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:37:17.806+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.805+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:37:17.806+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.805+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:37:17.807+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.807+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:37:17.807+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.807+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:37:17.807+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.807+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:37:17.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.809+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp_y1xoc4r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:37:17.809+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.809+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp_y1xoc4r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:37:17.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.809+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp_y1xoc4r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:37:17.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.810+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpsecjasli --profiles-dir /tmp/tmp_y1xoc4r --profile weather --target dev`
[2025-06-20T08:37:17.810+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.810+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpsecjasli --profiles-dir /tmp/tmp_y1xoc4r --profile weather --target dev`
[2025-06-20T08:37:17.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.810+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpsecjasli --profiles-dir /tmp/tmp_y1xoc4r --profile weather --target dev`
[2025-06-20T08:37:17.811+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.811+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:37:17.811+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:17.811+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:37:17.811+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:17.811+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:37:22.140+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:22.139+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpsecjasli --profiles-dir /tmp/tmp_y1xoc4r --profile weather --target dev`
[2025-06-20T08:37:22.140+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:22.139+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpsecjasli --profiles-dir /tmp/tmp_y1xoc4r --profile weather --target dev`
[2025-06-20T08:37:22.141+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:22.139+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpsecjasli --profiles-dir /tmp/tmp_y1xoc4r --profile weather --target dev`
[2025-06-20T08:37:22.142+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:22.141+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:37:22.142+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:22.141+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:37:22.143+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:22.141+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:37:32.280+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:37:32.278+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpsecjasli', '--profiles-dir', '/tmp/tmp_y1xoc4r', '--profile', 'weather', '--target', 'dev'] due to the error:
08:37:28  Running with dbt=1.7.9
08:37:29  Registered adapter: postgres=1.7.9
08:37:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:37:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:37:32.281+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:37:32.278+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpsecjasli', '--profiles-dir', '/tmp/tmp_y1xoc4r', '--profile', 'weather', '--target', 'dev'] due to the error:
08:37:28  Running with dbt=1.7.9
08:37:29  Registered adapter: postgres=1.7.9
08:37:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:37:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:37:32.282+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:37:32.308+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.911 seconds
[2025-06-20T08:38:02.460+0000] {processor.py:161} INFO - Started process (PID=634) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:38:02.461+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:38:02.467+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:02.467+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:38:02.531+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:02.531+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:38:03.182+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.181+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:38:03.186+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:03.181+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:38:03.187+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.181+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:38:03.188+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.188+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:38:03.188+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:03.188+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:38:03.189+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.188+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:38:03.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.190+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:38:03.191+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:03.190+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:38:03.191+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.190+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:38:03.194+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.194+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwg7k1qfh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:38:03.194+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:03.194+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpwg7k1qfh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:38:03.195+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.194+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwg7k1qfh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:38:03.196+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.196+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq_4umt_t --profiles-dir /tmp/tmpwg7k1qfh --profile weather --target dev`
[2025-06-20T08:38:03.197+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:03.196+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq_4umt_t --profiles-dir /tmp/tmpwg7k1qfh --profile weather --target dev`
[2025-06-20T08:38:03.197+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.196+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq_4umt_t --profiles-dir /tmp/tmpwg7k1qfh --profile weather --target dev`
[2025-06-20T08:38:03.198+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.197+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:03.198+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:03.197+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:03.199+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:03.197+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:08.760+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:08.759+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq_4umt_t --profiles-dir /tmp/tmpwg7k1qfh --profile weather --target dev`
[2025-06-20T08:38:08.761+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:08.759+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq_4umt_t --profiles-dir /tmp/tmpwg7k1qfh --profile weather --target dev`
[2025-06-20T08:38:08.761+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:08.759+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq_4umt_t --profiles-dir /tmp/tmpwg7k1qfh --profile weather --target dev`
[2025-06-20T08:38:08.762+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:08.761+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:08.762+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:08.761+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:08.763+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:08.761+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:14.410+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:14.409+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq_4umt_t', '--profiles-dir', '/tmp/tmpwg7k1qfh', '--profile', 'weather', '--target', 'dev'] due to the error:
08:38:11  Running with dbt=1.7.9
08:38:11  Registered adapter: postgres=1.7.9
08:38:11  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:38:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:38:14.411+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:14.409+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq_4umt_t', '--profiles-dir', '/tmp/tmpwg7k1qfh', '--profile', 'weather', '--target', 'dev'] due to the error:
08:38:11  Running with dbt=1.7.9
08:38:11  Registered adapter: postgres=1.7.9
08:38:11  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:38:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:38:14.411+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:38:14.425+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.971 seconds
[2025-06-20T08:38:45.445+0000] {processor.py:161} INFO - Started process (PID=682) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:38:45.446+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:38:45.448+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.448+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:38:45.511+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.511+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:38:45.967+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.967+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:38:45.968+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.967+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:38:45.968+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.967+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:38:45.970+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.969+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:38:45.970+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.969+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:38:45.971+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.969+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:38:45.972+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.971+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:38:45.972+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.971+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:38:45.973+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.971+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:38:45.975+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.974+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpv3n8e08a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:38:45.975+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.974+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpv3n8e08a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:38:45.976+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.974+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpv3n8e08a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:38:45.976+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.976+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6mduftg1 --profiles-dir /tmp/tmpv3n8e08a --profile weather --target dev`
[2025-06-20T08:38:45.977+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.976+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6mduftg1 --profiles-dir /tmp/tmpv3n8e08a --profile weather --target dev`
[2025-06-20T08:38:45.977+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.976+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6mduftg1 --profiles-dir /tmp/tmpv3n8e08a --profile weather --target dev`
[2025-06-20T08:38:45.978+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.977+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:45.978+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:45.977+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:45.979+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:45.977+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:51.347+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:51.346+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6mduftg1 --profiles-dir /tmp/tmpv3n8e08a --profile weather --target dev`
[2025-06-20T08:38:51.347+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:51.346+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6mduftg1 --profiles-dir /tmp/tmpv3n8e08a --profile weather --target dev`
[2025-06-20T08:38:51.348+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:51.346+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6mduftg1 --profiles-dir /tmp/tmpv3n8e08a --profile weather --target dev`
[2025-06-20T08:38:51.348+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:51.348+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:51.349+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:51.348+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:51.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:51.348+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:38:59.820+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:38:59.818+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6mduftg1', '--profiles-dir', '/tmp/tmpv3n8e08a', '--profile', 'weather', '--target', 'dev'] due to the error:
08:38:56  Running with dbt=1.7.9
08:38:56  Registered adapter: postgres=1.7.9
08:38:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:38:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:38:59.821+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:38:59.818+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6mduftg1', '--profiles-dir', '/tmp/tmpv3n8e08a', '--profile', 'weather', '--target', 'dev'] due to the error:
08:38:56  Running with dbt=1.7.9
08:38:56  Registered adapter: postgres=1.7.9
08:38:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:38:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:38:59.822+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:38:59.842+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.404 seconds
[2025-06-20T08:39:29.889+0000] {processor.py:161} INFO - Started process (PID=731) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:39:29.890+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:39:29.894+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:29.893+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:39:30.139+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:30.139+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:39:30.351+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.350+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:39:30.351+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:30.350+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:39:30.351+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.350+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:39:30.352+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.352+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:39:30.352+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:30.352+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:39:30.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.352+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:39:30.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.353+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:39:30.353+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:30.353+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:39:30.354+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.353+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:39:30.355+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.355+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4d1qtlor/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:39:30.355+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:30.355+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp4d1qtlor/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:39:30.356+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.355+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4d1qtlor/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:39:30.356+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.356+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpad2ik5vn --profiles-dir /tmp/tmp4d1qtlor --profile weather --target dev`
[2025-06-20T08:39:30.356+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:30.356+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpad2ik5vn --profiles-dir /tmp/tmp4d1qtlor --profile weather --target dev`
[2025-06-20T08:39:30.357+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.356+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpad2ik5vn --profiles-dir /tmp/tmp4d1qtlor --profile weather --target dev`
[2025-06-20T08:39:30.357+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.357+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:39:30.357+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:30.357+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:39:30.358+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:30.357+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:39:34.491+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:34.490+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpad2ik5vn --profiles-dir /tmp/tmp4d1qtlor --profile weather --target dev`
[2025-06-20T08:39:34.491+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:34.490+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpad2ik5vn --profiles-dir /tmp/tmp4d1qtlor --profile weather --target dev`
[2025-06-20T08:39:34.492+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:34.490+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpad2ik5vn --profiles-dir /tmp/tmp4d1qtlor --profile weather --target dev`
[2025-06-20T08:39:34.492+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:34.492+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:39:34.492+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:34.492+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:39:34.493+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:34.492+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:39:43.094+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:39:43.089+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpad2ik5vn', '--profiles-dir', '/tmp/tmp4d1qtlor', '--profile', 'weather', '--target', 'dev'] due to the error:
08:39:37  Running with dbt=1.7.9
08:39:37  Registered adapter: postgres=1.7.9
08:39:37  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:39:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:39:43.096+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:39:43.089+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpad2ik5vn', '--profiles-dir', '/tmp/tmp4d1qtlor', '--profile', 'weather', '--target', 'dev'] due to the error:
08:39:37  Running with dbt=1.7.9
08:39:37  Registered adapter: postgres=1.7.9
08:39:37  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:39:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:39:43.097+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:39:43.130+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.245 seconds
[2025-06-20T08:40:13.234+0000] {processor.py:161} INFO - Started process (PID=771) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:40:13.235+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:40:13.237+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.237+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:40:13.299+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.299+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:40:13.943+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.942+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:40:13.943+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.942+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:40:13.944+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.942+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:40:13.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.945+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:40:13.945+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.945+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:40:13.946+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.945+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:40:13.947+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.947+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:40:13.948+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.947+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:40:13.948+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.947+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:40:13.951+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.950+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpin7vul95/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:40:13.951+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.950+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpin7vul95/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:40:13.951+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.950+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpin7vul95/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:40:13.952+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.952+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmer7anyx --profiles-dir /tmp/tmpin7vul95 --profile weather --target dev`
[2025-06-20T08:40:13.953+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.952+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmer7anyx --profiles-dir /tmp/tmpin7vul95 --profile weather --target dev`
[2025-06-20T08:40:13.953+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.952+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmer7anyx --profiles-dir /tmp/tmpin7vul95 --profile weather --target dev`
[2025-06-20T08:40:13.954+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.954+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:13.955+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:13.954+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:13.955+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:13.954+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:19.890+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:19.889+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmer7anyx --profiles-dir /tmp/tmpin7vul95 --profile weather --target dev`
[2025-06-20T08:40:19.891+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:19.889+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmer7anyx --profiles-dir /tmp/tmpin7vul95 --profile weather --target dev`
[2025-06-20T08:40:19.891+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:19.889+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmer7anyx --profiles-dir /tmp/tmpin7vul95 --profile weather --target dev`
[2025-06-20T08:40:19.892+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:19.891+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:19.892+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:19.891+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:19.893+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:19.891+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:26.880+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:26.878+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmer7anyx', '--profiles-dir', '/tmp/tmpin7vul95', '--profile', 'weather', '--target', 'dev'] due to the error:
08:40:23  Running with dbt=1.7.9
08:40:24  Registered adapter: postgres=1.7.9
08:40:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:40:25  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:40:26.880+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:26.878+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmer7anyx', '--profiles-dir', '/tmp/tmpin7vul95', '--profile', 'weather', '--target', 'dev'] due to the error:
08:40:23  Running with dbt=1.7.9
08:40:24  Registered adapter: postgres=1.7.9
08:40:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:40:25  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:40:26.881+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:40:26.895+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.665 seconds
[2025-06-20T08:40:57.579+0000] {processor.py:161} INFO - Started process (PID=811) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:40:57.580+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:40:57.582+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:57.581+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:40:57.779+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:57.779+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:40:57.999+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:57.998+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:40:57.999+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:57.998+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:40:57.999+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:57.998+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:40:58.000+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.000+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:40:58.000+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:58.000+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:40:58.001+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.000+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:40:58.001+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.001+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:40:58.002+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:58.001+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:40:58.002+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.001+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:40:58.003+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.003+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkm0vdtub/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:40:58.004+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:58.003+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpkm0vdtub/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:40:58.004+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.003+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkm0vdtub/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:40:58.004+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.004+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpydr9c9f1 --profiles-dir /tmp/tmpkm0vdtub --profile weather --target dev`
[2025-06-20T08:40:58.005+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:58.004+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpydr9c9f1 --profiles-dir /tmp/tmpkm0vdtub --profile weather --target dev`
[2025-06-20T08:40:58.005+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.004+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpydr9c9f1 --profiles-dir /tmp/tmpkm0vdtub --profile weather --target dev`
[2025-06-20T08:40:58.005+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.005+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:58.006+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:40:58.005+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:40:58.006+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:40:58.005+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:04.382+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:04.381+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpydr9c9f1 --profiles-dir /tmp/tmpkm0vdtub --profile weather --target dev`
[2025-06-20T08:41:04.382+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:04.381+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpydr9c9f1 --profiles-dir /tmp/tmpkm0vdtub --profile weather --target dev`
[2025-06-20T08:41:04.383+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:04.381+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpydr9c9f1 --profiles-dir /tmp/tmpkm0vdtub --profile weather --target dev`
[2025-06-20T08:41:04.383+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:04.383+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:04.383+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:04.383+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:04.384+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:04.383+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:11.302+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:11.299+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpydr9c9f1', '--profiles-dir', '/tmp/tmpkm0vdtub', '--profile', 'weather', '--target', 'dev'] due to the error:
08:41:07  Running with dbt=1.7.9
08:41:07  Registered adapter: postgres=1.7.9
08:41:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:41:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:41:11.303+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:11.299+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpydr9c9f1', '--profiles-dir', '/tmp/tmpkm0vdtub', '--profile', 'weather', '--target', 'dev'] due to the error:
08:41:07  Running with dbt=1.7.9
08:41:07  Registered adapter: postgres=1.7.9
08:41:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:41:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:41:11.303+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:41:11.322+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.746 seconds
[2025-06-20T08:41:41.414+0000] {processor.py:161} INFO - Started process (PID=865) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:41:41.415+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:41:41.418+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.418+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:41:41.491+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.491+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:41:41.930+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.929+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:41:41.930+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.929+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:41:41.931+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.929+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:41:41.932+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.932+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:41:41.932+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.932+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:41:41.933+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.932+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:41:41.934+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.933+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:41:41.934+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.933+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:41:41.935+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.933+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:41:41.937+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.937+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpyncxw9db/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:41:41.937+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.937+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpyncxw9db/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:41:41.938+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.937+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpyncxw9db/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:41:41.938+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.938+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa06blupv --profiles-dir /tmp/tmpyncxw9db --profile weather --target dev`
[2025-06-20T08:41:41.939+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.938+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa06blupv --profiles-dir /tmp/tmpyncxw9db --profile weather --target dev`
[2025-06-20T08:41:41.939+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.938+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa06blupv --profiles-dir /tmp/tmpyncxw9db --profile weather --target dev`
[2025-06-20T08:41:41.940+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.940+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:41.941+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:41.940+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:41.941+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:41.940+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:48.041+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:48.040+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa06blupv --profiles-dir /tmp/tmpyncxw9db --profile weather --target dev`
[2025-06-20T08:41:48.041+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:48.040+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa06blupv --profiles-dir /tmp/tmpyncxw9db --profile weather --target dev`
[2025-06-20T08:41:48.042+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:48.040+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa06blupv --profiles-dir /tmp/tmpyncxw9db --profile weather --target dev`
[2025-06-20T08:41:48.042+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:48.042+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:48.042+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:48.042+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:48.043+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:48.042+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:41:55.021+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:41:55.007+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa06blupv', '--profiles-dir', '/tmp/tmpyncxw9db', '--profile', 'weather', '--target', 'dev'] due to the error:
08:41:51  Running with dbt=1.7.9
08:41:51  Registered adapter: postgres=1.7.9
08:41:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:41:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:41:55.025+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:41:55.007+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa06blupv', '--profiles-dir', '/tmp/tmpyncxw9db', '--profile', 'weather', '--target', 'dev'] due to the error:
08:41:51  Running with dbt=1.7.9
08:41:51  Registered adapter: postgres=1.7.9
08:41:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:41:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:41:55.026+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:41:55.078+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.668 seconds
[2025-06-20T08:42:25.299+0000] {processor.py:161} INFO - Started process (PID=907) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:42:25.300+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:42:25.302+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.302+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:42:25.348+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.348+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:42:25.554+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.554+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:42:25.555+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.554+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:42:25.555+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.554+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:42:25.556+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.556+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:42:25.556+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.556+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:42:25.556+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.556+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:42:25.557+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.557+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:42:25.557+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.557+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:42:25.558+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.557+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:42:25.559+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.559+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpi2b3ck_0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:42:25.559+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.559+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpi2b3ck_0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:42:25.559+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.559+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpi2b3ck_0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:42:25.560+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.560+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqjq7ld85 --profiles-dir /tmp/tmpi2b3ck_0 --profile weather --target dev`
[2025-06-20T08:42:25.560+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.560+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqjq7ld85 --profiles-dir /tmp/tmpi2b3ck_0 --profile weather --target dev`
[2025-06-20T08:42:25.561+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.560+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqjq7ld85 --profiles-dir /tmp/tmpi2b3ck_0 --profile weather --target dev`
[2025-06-20T08:42:25.561+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.561+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:42:25.561+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:25.561+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:42:25.562+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:25.561+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:42:30.966+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:30.965+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqjq7ld85 --profiles-dir /tmp/tmpi2b3ck_0 --profile weather --target dev`
[2025-06-20T08:42:30.966+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:30.965+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqjq7ld85 --profiles-dir /tmp/tmpi2b3ck_0 --profile weather --target dev`
[2025-06-20T08:42:30.966+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:30.965+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqjq7ld85 --profiles-dir /tmp/tmpi2b3ck_0 --profile weather --target dev`
[2025-06-20T08:42:30.967+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:30.966+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:42:30.967+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:30.966+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:42:30.968+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:30.966+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:42:38.862+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:42:38.860+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqjq7ld85', '--profiles-dir', '/tmp/tmpi2b3ck_0', '--profile', 'weather', '--target', 'dev'] due to the error:
08:42:35  Running with dbt=1.7.9
08:42:36  Registered adapter: postgres=1.7.9
08:42:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:42:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:42:38.863+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:42:38.860+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqjq7ld85', '--profiles-dir', '/tmp/tmpi2b3ck_0', '--profile', 'weather', '--target', 'dev'] due to the error:
08:42:35  Running with dbt=1.7.9
08:42:36  Registered adapter: postgres=1.7.9
08:42:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:42:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:42:38.863+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:42:38.878+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.582 seconds
[2025-06-20T08:43:08.907+0000] {processor.py:161} INFO - Started process (PID=953) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:43:08.907+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:43:08.910+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:08.910+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:43:08.950+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:08.950+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:43:09.171+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.170+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:43:09.171+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:09.170+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:43:09.171+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.170+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:43:09.172+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.172+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:43:09.172+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:09.172+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:43:09.173+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.172+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:43:09.173+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.173+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:43:09.174+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:09.173+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:43:09.174+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.173+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:43:09.175+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.175+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp9kac5g4o/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:43:09.176+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:09.175+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp9kac5g4o/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:43:09.176+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.175+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp9kac5g4o/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:43:09.177+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.176+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppq7gs9hc --profiles-dir /tmp/tmp9kac5g4o --profile weather --target dev`
[2025-06-20T08:43:09.177+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:09.176+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppq7gs9hc --profiles-dir /tmp/tmp9kac5g4o --profile weather --target dev`
[2025-06-20T08:43:09.177+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.176+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppq7gs9hc --profiles-dir /tmp/tmp9kac5g4o --profile weather --target dev`
[2025-06-20T08:43:09.178+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.177+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:09.178+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:09.177+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:09.178+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:09.177+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:13.525+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:13.524+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppq7gs9hc --profiles-dir /tmp/tmp9kac5g4o --profile weather --target dev`
[2025-06-20T08:43:13.525+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:13.524+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppq7gs9hc --profiles-dir /tmp/tmp9kac5g4o --profile weather --target dev`
[2025-06-20T08:43:13.526+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:13.524+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppq7gs9hc --profiles-dir /tmp/tmp9kac5g4o --profile weather --target dev`
[2025-06-20T08:43:13.526+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:13.526+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:13.526+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:13.526+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:13.526+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:13.526+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:20.885+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:20.883+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmppq7gs9hc', '--profiles-dir', '/tmp/tmp9kac5g4o', '--profile', 'weather', '--target', 'dev'] due to the error:
08:43:18  Running with dbt=1.7.9
08:43:18  Registered adapter: postgres=1.7.9
08:43:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:43:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:43:20.885+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:20.883+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmppq7gs9hc', '--profiles-dir', '/tmp/tmp9kac5g4o', '--profile', 'weather', '--target', 'dev'] due to the error:
08:43:18  Running with dbt=1.7.9
08:43:18  Registered adapter: postgres=1.7.9
08:43:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:43:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:43:20.886+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:43:20.900+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.996 seconds
[2025-06-20T08:43:51.130+0000] {processor.py:161} INFO - Started process (PID=992) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:43:51.131+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:43:51.133+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.133+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:43:51.173+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.173+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:43:51.384+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.384+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:43:51.385+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.384+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:43:51.385+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.384+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:43:51.386+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.386+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:43:51.386+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.386+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:43:51.386+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.386+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:43:51.387+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.387+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:43:51.387+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.387+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:43:51.388+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.387+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:43:51.389+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.389+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpat0iycl5/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:43:51.389+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.389+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpat0iycl5/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:43:51.389+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.389+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpat0iycl5/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:43:51.390+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.390+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjqdbq6uj --profiles-dir /tmp/tmpat0iycl5 --profile weather --target dev`
[2025-06-20T08:43:51.390+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.390+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjqdbq6uj --profiles-dir /tmp/tmpat0iycl5 --profile weather --target dev`
[2025-06-20T08:43:51.391+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.390+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjqdbq6uj --profiles-dir /tmp/tmpat0iycl5 --profile weather --target dev`
[2025-06-20T08:43:51.391+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.391+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:51.391+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:51.391+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:51.392+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:51.391+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:56.737+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:56.737+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjqdbq6uj --profiles-dir /tmp/tmpat0iycl5 --profile weather --target dev`
[2025-06-20T08:43:56.738+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:56.737+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjqdbq6uj --profiles-dir /tmp/tmpat0iycl5 --profile weather --target dev`
[2025-06-20T08:43:56.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:56.737+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjqdbq6uj --profiles-dir /tmp/tmpat0iycl5 --profile weather --target dev`
[2025-06-20T08:43:56.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:56.738+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:56.739+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:43:56.738+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:43:56.739+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:43:56.738+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:44:04.914+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:04.912+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjqdbq6uj', '--profiles-dir', '/tmp/tmpat0iycl5', '--profile', 'weather', '--target', 'dev'] due to the error:
08:44:01  Running with dbt=1.7.9
08:44:02  Registered adapter: postgres=1.7.9
08:44:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:44:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:44:04.914+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:04.912+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjqdbq6uj', '--profiles-dir', '/tmp/tmpat0iycl5', '--profile', 'weather', '--target', 'dev'] due to the error:
08:44:01  Running with dbt=1.7.9
08:44:02  Registered adapter: postgres=1.7.9
08:44:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:44:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:44:04.915+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:44:04.929+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.803 seconds
[2025-06-20T08:44:35.943+0000] {processor.py:161} INFO - Started process (PID=1047) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:44:35.953+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:44:35.957+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:35.957+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:44:36.069+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:36.069+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:44:36.557+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.556+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:44:36.557+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:36.556+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:44:36.558+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.556+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:44:36.559+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.559+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:44:36.560+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:36.559+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:44:36.561+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.559+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:44:36.563+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.562+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:44:36.564+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:36.562+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:44:36.566+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.562+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:44:36.568+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.568+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvmrcdy26/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:44:36.571+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:36.568+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpvmrcdy26/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:44:36.572+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.568+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvmrcdy26/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:44:36.573+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.572+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzzrg8ktl --profiles-dir /tmp/tmpvmrcdy26 --profile weather --target dev`
[2025-06-20T08:44:36.575+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:36.572+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzzrg8ktl --profiles-dir /tmp/tmpvmrcdy26 --profile weather --target dev`
[2025-06-20T08:44:36.576+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.572+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzzrg8ktl --profiles-dir /tmp/tmpvmrcdy26 --profile weather --target dev`
[2025-06-20T08:44:36.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.576+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:44:36.577+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:36.576+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:44:36.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:36.576+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:44:42.000+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:41.999+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzzrg8ktl --profiles-dir /tmp/tmpvmrcdy26 --profile weather --target dev`
[2025-06-20T08:44:42.000+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:41.999+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzzrg8ktl --profiles-dir /tmp/tmpvmrcdy26 --profile weather --target dev`
[2025-06-20T08:44:42.001+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:41.999+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzzrg8ktl --profiles-dir /tmp/tmpvmrcdy26 --profile weather --target dev`
[2025-06-20T08:44:42.002+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:42.001+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:44:42.002+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:42.001+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:44:42.003+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:42.001+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:44:48.944+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:44:48.941+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzzrg8ktl', '--profiles-dir', '/tmp/tmpvmrcdy26', '--profile', 'weather', '--target', 'dev'] due to the error:
08:44:46  Running with dbt=1.7.9
08:44:46  Registered adapter: postgres=1.7.9
08:44:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:44:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:44:48.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:44:48.941+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzzrg8ktl', '--profiles-dir', '/tmp/tmpvmrcdy26', '--profile', 'weather', '--target', 'dev'] due to the error:
08:44:46  Running with dbt=1.7.9
08:44:46  Registered adapter: postgres=1.7.9
08:44:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:44:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:44:48.945+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:44:48.965+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.042 seconds
[2025-06-20T08:45:19.112+0000] {processor.py:161} INFO - Started process (PID=1088) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:45:19.113+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:45:19.115+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.115+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:45:19.156+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.156+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:45:19.360+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.360+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:45:19.361+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.360+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:45:19.361+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.360+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:45:19.362+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.362+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:45:19.362+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.362+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:45:19.362+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.362+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:45:19.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.363+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:45:19.363+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.363+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:45:19.364+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.363+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:45:19.365+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.365+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpikel4y1u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:45:19.365+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.365+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpikel4y1u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:45:19.365+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.365+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpikel4y1u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:45:19.366+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.366+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvuw4az3f --profiles-dir /tmp/tmpikel4y1u --profile weather --target dev`
[2025-06-20T08:45:19.366+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.366+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvuw4az3f --profiles-dir /tmp/tmpikel4y1u --profile weather --target dev`
[2025-06-20T08:45:19.366+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.366+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvuw4az3f --profiles-dir /tmp/tmpikel4y1u --profile weather --target dev`
[2025-06-20T08:45:19.367+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.367+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:19.367+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:19.367+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:19.368+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:19.367+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:23.584+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:23.583+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvuw4az3f --profiles-dir /tmp/tmpikel4y1u --profile weather --target dev`
[2025-06-20T08:45:23.585+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:23.583+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvuw4az3f --profiles-dir /tmp/tmpikel4y1u --profile weather --target dev`
[2025-06-20T08:45:23.585+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:23.583+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvuw4az3f --profiles-dir /tmp/tmpikel4y1u --profile weather --target dev`
[2025-06-20T08:45:23.586+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:23.585+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:23.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:23.585+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:23.586+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:23.585+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:29.465+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:29.463+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvuw4az3f', '--profiles-dir', '/tmp/tmpikel4y1u', '--profile', 'weather', '--target', 'dev'] due to the error:
08:45:26  Running with dbt=1.7.9
08:45:26  Registered adapter: postgres=1.7.9
08:45:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:45:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:45:29.466+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:29.463+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvuw4az3f', '--profiles-dir', '/tmp/tmpikel4y1u', '--profile', 'weather', '--target', 'dev'] due to the error:
08:45:26  Running with dbt=1.7.9
08:45:26  Registered adapter: postgres=1.7.9
08:45:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:45:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:45:29.467+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:45:29.486+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.378 seconds
[2025-06-20T08:45:59.613+0000] {processor.py:161} INFO - Started process (PID=1128) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:45:59.613+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:45:59.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.615+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:45:59.656+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.655+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:45:59.866+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.866+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:45:59.867+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.866+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:45:59.867+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.866+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:45:59.868+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.868+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:45:59.868+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.868+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:45:59.868+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.868+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:45:59.869+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.869+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:45:59.869+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.869+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:45:59.870+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.869+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:45:59.871+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.871+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmponi77538/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:45:59.871+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.871+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmponi77538/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:45:59.871+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.871+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmponi77538/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:45:59.872+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.872+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpog9z58nd --profiles-dir /tmp/tmponi77538 --profile weather --target dev`
[2025-06-20T08:45:59.872+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.872+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpog9z58nd --profiles-dir /tmp/tmponi77538 --profile weather --target dev`
[2025-06-20T08:45:59.873+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.872+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpog9z58nd --profiles-dir /tmp/tmponi77538 --profile weather --target dev`
[2025-06-20T08:45:59.873+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.873+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:59.873+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:45:59.873+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:45:59.874+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:45:59.873+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:04.023+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:04.022+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpog9z58nd --profiles-dir /tmp/tmponi77538 --profile weather --target dev`
[2025-06-20T08:46:04.023+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:04.022+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpog9z58nd --profiles-dir /tmp/tmponi77538 --profile weather --target dev`
[2025-06-20T08:46:04.023+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:04.022+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpog9z58nd --profiles-dir /tmp/tmponi77538 --profile weather --target dev`
[2025-06-20T08:46:04.024+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:04.023+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:04.024+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:04.023+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:04.024+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:04.023+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:10.785+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:10.783+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpog9z58nd', '--profiles-dir', '/tmp/tmponi77538', '--profile', 'weather', '--target', 'dev'] due to the error:
08:46:07  Running with dbt=1.7.9
08:46:07  Registered adapter: postgres=1.7.9
08:46:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:46:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:46:10.786+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:10.783+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpog9z58nd', '--profiles-dir', '/tmp/tmponi77538', '--profile', 'weather', '--target', 'dev'] due to the error:
08:46:07  Running with dbt=1.7.9
08:46:07  Registered adapter: postgres=1.7.9
08:46:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:46:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:46:10.787+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:46:10.808+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.198 seconds
[2025-06-20T08:46:40.892+0000] {processor.py:161} INFO - Started process (PID=1173) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:46:40.893+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:46:40.895+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:40.895+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:46:40.937+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:40.937+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:46:41.150+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.149+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:46:41.150+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:41.149+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:46:41.150+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.149+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:46:41.151+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.151+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:46:41.152+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:41.151+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:46:41.152+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.151+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:46:41.153+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.152+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:46:41.153+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:41.152+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:46:41.154+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.152+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:46:41.155+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.155+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpw_uvqb6m/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:46:41.156+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:41.155+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpw_uvqb6m/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:46:41.156+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.155+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpw_uvqb6m/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:46:41.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.157+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8ce_fbd9 --profiles-dir /tmp/tmpw_uvqb6m --profile weather --target dev`
[2025-06-20T08:46:41.157+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:41.157+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8ce_fbd9 --profiles-dir /tmp/tmpw_uvqb6m --profile weather --target dev`
[2025-06-20T08:46:41.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.157+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8ce_fbd9 --profiles-dir /tmp/tmpw_uvqb6m --profile weather --target dev`
[2025-06-20T08:46:41.158+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.157+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:41.158+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:41.157+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:41.159+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:41.157+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:45.486+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:45.485+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8ce_fbd9 --profiles-dir /tmp/tmpw_uvqb6m --profile weather --target dev`
[2025-06-20T08:46:45.487+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:45.485+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8ce_fbd9 --profiles-dir /tmp/tmpw_uvqb6m --profile weather --target dev`
[2025-06-20T08:46:45.487+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:45.485+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8ce_fbd9 --profiles-dir /tmp/tmpw_uvqb6m --profile weather --target dev`
[2025-06-20T08:46:45.488+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:45.488+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:45.488+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:45.488+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:45.489+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:45.488+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:46:55.313+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:46:55.306+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8ce_fbd9', '--profiles-dir', '/tmp/tmpw_uvqb6m', '--profile', 'weather', '--target', 'dev'] due to the error:
08:46:49  Running with dbt=1.7.9
08:46:50  Registered adapter: postgres=1.7.9
08:46:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:46:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:46:55.313+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:46:55.306+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8ce_fbd9', '--profiles-dir', '/tmp/tmpw_uvqb6m', '--profile', 'weather', '--target', 'dev'] due to the error:
08:46:49  Running with dbt=1.7.9
08:46:50  Registered adapter: postgres=1.7.9
08:46:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:46:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:46:55.316+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:46:55.346+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.456 seconds
[2025-06-20T08:47:26.319+0000] {processor.py:161} INFO - Started process (PID=1214) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:47:26.320+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:47:26.323+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.322+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:47:26.426+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.426+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:47:26.739+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.739+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:47:26.739+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.739+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:47:26.740+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.739+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:47:26.741+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.741+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:47:26.742+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.741+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:47:26.742+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.741+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:47:26.743+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.743+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:47:26.744+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.743+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:47:26.744+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.743+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:47:26.746+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.746+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmppx7b3sy5/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:47:26.746+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.746+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmppx7b3sy5/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:47:26.747+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.746+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmppx7b3sy5/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:47:26.748+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.748+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0epuboy6 --profiles-dir /tmp/tmppx7b3sy5 --profile weather --target dev`
[2025-06-20T08:47:26.748+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.748+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0epuboy6 --profiles-dir /tmp/tmppx7b3sy5 --profile weather --target dev`
[2025-06-20T08:47:26.749+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.748+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0epuboy6 --profiles-dir /tmp/tmppx7b3sy5 --profile weather --target dev`
[2025-06-20T08:47:26.749+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.749+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:47:26.750+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:26.749+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:47:26.750+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:26.749+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:47:36.720+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:36.719+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0epuboy6 --profiles-dir /tmp/tmppx7b3sy5 --profile weather --target dev`
[2025-06-20T08:47:36.720+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:36.719+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0epuboy6 --profiles-dir /tmp/tmppx7b3sy5 --profile weather --target dev`
[2025-06-20T08:47:36.720+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:36.719+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0epuboy6 --profiles-dir /tmp/tmppx7b3sy5 --profile weather --target dev`
[2025-06-20T08:47:36.721+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:36.720+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:47:36.721+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:36.720+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:47:36.721+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:36.720+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:47:42.840+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:47:42.838+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0epuboy6', '--profiles-dir', '/tmp/tmppx7b3sy5', '--profile', 'weather', '--target', 'dev'] due to the error:
08:47:39  Running with dbt=1.7.9
08:47:40  Registered adapter: postgres=1.7.9
08:47:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:47:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:47:42.841+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:47:42.838+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0epuboy6', '--profiles-dir', '/tmp/tmppx7b3sy5', '--profile', 'weather', '--target', 'dev'] due to the error:
08:47:39  Running with dbt=1.7.9
08:47:40  Registered adapter: postgres=1.7.9
08:47:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:47:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:47:42.841+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:47:42.856+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 16.541 seconds
[2025-06-20T08:48:13.520+0000] {processor.py:161} INFO - Started process (PID=1270) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:48:13.521+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:48:13.546+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:13.543+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:48:13.686+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:13.686+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:48:14.078+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.078+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:48:14.079+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:14.078+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:48:14.079+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.078+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:48:14.080+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.080+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:48:14.080+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:14.080+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:48:14.081+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.080+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:48:14.082+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.081+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:48:14.082+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:14.081+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:48:14.082+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.081+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:48:14.084+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.084+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpi02rdhbp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:48:14.084+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:14.084+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpi02rdhbp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:48:14.085+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.084+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpi02rdhbp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:48:14.085+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.085+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcvcz7tzy --profiles-dir /tmp/tmpi02rdhbp --profile weather --target dev`
[2025-06-20T08:48:14.085+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:14.085+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcvcz7tzy --profiles-dir /tmp/tmpi02rdhbp --profile weather --target dev`
[2025-06-20T08:48:14.086+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.085+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcvcz7tzy --profiles-dir /tmp/tmpi02rdhbp --profile weather --target dev`
[2025-06-20T08:48:14.086+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.086+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:14.087+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:14.086+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:14.087+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:14.086+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:18.334+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:18.333+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcvcz7tzy --profiles-dir /tmp/tmpi02rdhbp --profile weather --target dev`
[2025-06-20T08:48:18.334+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:18.333+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcvcz7tzy --profiles-dir /tmp/tmpi02rdhbp --profile weather --target dev`
[2025-06-20T08:48:18.334+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:18.333+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcvcz7tzy --profiles-dir /tmp/tmpi02rdhbp --profile weather --target dev`
[2025-06-20T08:48:18.335+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:18.334+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:18.335+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:18.334+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:18.335+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:18.334+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:23.888+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:23.886+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpcvcz7tzy', '--profiles-dir', '/tmp/tmpi02rdhbp', '--profile', 'weather', '--target', 'dev'] due to the error:
08:48:21  Running with dbt=1.7.9
08:48:21  Registered adapter: postgres=1.7.9
08:48:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:48:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:48:23.889+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:23.886+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpcvcz7tzy', '--profiles-dir', '/tmp/tmpi02rdhbp', '--profile', 'weather', '--target', 'dev'] due to the error:
08:48:21  Running with dbt=1.7.9
08:48:21  Registered adapter: postgres=1.7.9
08:48:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:48:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:48:23.889+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:48:23.903+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.391 seconds
[2025-06-20T08:48:54.307+0000] {processor.py:161} INFO - Started process (PID=1310) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:48:54.308+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:48:54.310+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.310+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:48:54.350+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.350+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:48:54.558+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.558+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:48:54.558+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.558+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:48:54.559+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.558+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:48:54.560+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.559+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:48:54.560+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.559+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:48:54.560+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.559+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:48:54.561+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.561+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:48:54.562+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.561+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:48:54.562+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.561+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:48:54.564+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.564+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjo8_ifp3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:48:54.564+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.564+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpjo8_ifp3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:48:54.565+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.564+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjo8_ifp3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:48:54.566+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.565+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_7900fpo --profiles-dir /tmp/tmpjo8_ifp3 --profile weather --target dev`
[2025-06-20T08:48:54.566+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.565+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_7900fpo --profiles-dir /tmp/tmpjo8_ifp3 --profile weather --target dev`
[2025-06-20T08:48:54.566+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.565+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_7900fpo --profiles-dir /tmp/tmpjo8_ifp3 --profile weather --target dev`
[2025-06-20T08:48:54.567+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.566+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:54.567+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:54.566+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:54.568+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:54.566+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:58.782+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:58.781+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_7900fpo --profiles-dir /tmp/tmpjo8_ifp3 --profile weather --target dev`
[2025-06-20T08:48:58.782+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:58.781+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_7900fpo --profiles-dir /tmp/tmpjo8_ifp3 --profile weather --target dev`
[2025-06-20T08:48:58.783+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:58.781+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_7900fpo --profiles-dir /tmp/tmpjo8_ifp3 --profile weather --target dev`
[2025-06-20T08:48:58.783+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:58.783+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:58.783+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:48:58.783+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:48:58.784+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:48:58.783+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:49:04.564+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:04.560+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_7900fpo', '--profiles-dir', '/tmp/tmpjo8_ifp3', '--profile', 'weather', '--target', 'dev'] due to the error:
08:49:01  Running with dbt=1.7.9
08:49:02  Registered adapter: postgres=1.7.9
08:49:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:49:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:49:04.565+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:04.560+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_7900fpo', '--profiles-dir', '/tmp/tmpjo8_ifp3', '--profile', 'weather', '--target', 'dev'] due to the error:
08:49:01  Running with dbt=1.7.9
08:49:02  Registered adapter: postgres=1.7.9
08:49:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:49:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:49:04.566+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:49:04.586+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.282 seconds
[2025-06-20T08:49:34.796+0000] {processor.py:161} INFO - Started process (PID=1350) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:49:34.797+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:49:34.799+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:34.799+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:49:34.839+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:34.839+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:49:35.057+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.057+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:49:35.058+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:35.057+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:49:35.058+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.057+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:49:35.059+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.059+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:49:35.059+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:35.059+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:49:35.059+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.059+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:49:35.060+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.060+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:49:35.060+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:35.060+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:49:35.060+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.060+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:49:35.062+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.062+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmphnafeoq6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:49:35.062+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:35.062+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmphnafeoq6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:49:35.062+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.062+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmphnafeoq6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:49:35.063+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.063+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1cczomp2 --profiles-dir /tmp/tmphnafeoq6 --profile weather --target dev`
[2025-06-20T08:49:35.063+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:35.063+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1cczomp2 --profiles-dir /tmp/tmphnafeoq6 --profile weather --target dev`
[2025-06-20T08:49:35.063+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.063+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1cczomp2 --profiles-dir /tmp/tmphnafeoq6 --profile weather --target dev`
[2025-06-20T08:49:35.064+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.064+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:49:35.064+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:35.064+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:49:35.065+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:35.064+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:49:39.336+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:39.335+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1cczomp2 --profiles-dir /tmp/tmphnafeoq6 --profile weather --target dev`
[2025-06-20T08:49:39.336+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:39.335+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1cczomp2 --profiles-dir /tmp/tmphnafeoq6 --profile weather --target dev`
[2025-06-20T08:49:39.336+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:39.335+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1cczomp2 --profiles-dir /tmp/tmphnafeoq6 --profile weather --target dev`
[2025-06-20T08:49:39.337+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:39.337+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:49:39.337+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:39.337+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:49:39.337+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:39.337+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:49:50.960+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:49:50.958+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1cczomp2', '--profiles-dir', '/tmp/tmphnafeoq6', '--profile', 'weather', '--target', 'dev'] due to the error:
08:49:45  Running with dbt=1.7.9
08:49:46  Registered adapter: postgres=1.7.9
08:49:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:49:49  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:49:50.961+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:49:50.958+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1cczomp2', '--profiles-dir', '/tmp/tmphnafeoq6', '--profile', 'weather', '--target', 'dev'] due to the error:
08:49:45  Running with dbt=1.7.9
08:49:46  Registered adapter: postgres=1.7.9
08:49:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:49:49  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:49:50.962+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:49:50.982+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 16.188 seconds
[2025-06-20T08:50:21.553+0000] {processor.py:161} INFO - Started process (PID=1396) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:50:21.556+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:50:21.559+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.559+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:50:21.624+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.622+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:50:21.949+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.948+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:50:21.949+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.948+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:50:21.950+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.948+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:50:21.951+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.950+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:50:21.951+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.950+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:50:21.952+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.950+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:50:21.953+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.952+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:50:21.953+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.952+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:50:21.954+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.952+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:50:21.956+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.955+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpj24j34sp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:50:21.956+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.955+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpj24j34sp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:50:21.957+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.955+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpj24j34sp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:50:21.957+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.957+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyfp6v4tv --profiles-dir /tmp/tmpj24j34sp --profile weather --target dev`
[2025-06-20T08:50:21.958+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.957+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyfp6v4tv --profiles-dir /tmp/tmpj24j34sp --profile weather --target dev`
[2025-06-20T08:50:21.958+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.957+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyfp6v4tv --profiles-dir /tmp/tmpj24j34sp --profile weather --target dev`
[2025-06-20T08:50:21.959+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.959+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:50:21.960+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:21.959+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:50:21.960+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:21.959+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:50:29.604+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:29.603+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyfp6v4tv --profiles-dir /tmp/tmpj24j34sp --profile weather --target dev`
[2025-06-20T08:50:29.604+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:29.603+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyfp6v4tv --profiles-dir /tmp/tmpj24j34sp --profile weather --target dev`
[2025-06-20T08:50:29.605+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:29.603+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyfp6v4tv --profiles-dir /tmp/tmpj24j34sp --profile weather --target dev`
[2025-06-20T08:50:29.605+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:29.605+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:50:29.606+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:29.605+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:50:29.606+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:29.605+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:50:35.397+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:50:35.394+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyfp6v4tv', '--profiles-dir', '/tmp/tmpj24j34sp', '--profile', 'weather', '--target', 'dev'] due to the error:
08:50:32  Running with dbt=1.7.9
08:50:32  Registered adapter: postgres=1.7.9
08:50:32  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:50:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:50:35.398+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:50:35.394+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyfp6v4tv', '--profiles-dir', '/tmp/tmpj24j34sp', '--profile', 'weather', '--target', 'dev'] due to the error:
08:50:32  Running with dbt=1.7.9
08:50:32  Registered adapter: postgres=1.7.9
08:50:32  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:50:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:50:35.398+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:50:35.414+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.865 seconds
[2025-06-20T08:51:05.625+0000] {processor.py:161} INFO - Started process (PID=1447) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:51:05.626+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:51:05.630+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:05.630+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:51:05.691+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:05.691+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:51:06.017+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.017+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:51:06.018+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:06.017+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:51:06.018+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.017+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:51:06.020+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.019+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:51:06.020+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:06.019+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:51:06.020+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.019+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:51:06.022+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.021+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:51:06.022+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:06.021+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:51:06.023+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.021+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:51:06.025+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.025+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp339z05v1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:51:06.025+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:06.025+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp339z05v1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:51:06.026+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.025+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp339z05v1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:51:06.027+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.026+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl3lr5la3 --profiles-dir /tmp/tmp339z05v1 --profile weather --target dev`
[2025-06-20T08:51:06.027+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:06.026+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl3lr5la3 --profiles-dir /tmp/tmp339z05v1 --profile weather --target dev`
[2025-06-20T08:51:06.028+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.026+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl3lr5la3 --profiles-dir /tmp/tmp339z05v1 --profile weather --target dev`
[2025-06-20T08:51:06.029+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.028+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:06.029+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:06.028+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:06.030+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:06.028+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:10.887+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:10.887+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl3lr5la3 --profiles-dir /tmp/tmp339z05v1 --profile weather --target dev`
[2025-06-20T08:51:10.888+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:10.887+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl3lr5la3 --profiles-dir /tmp/tmp339z05v1 --profile weather --target dev`
[2025-06-20T08:51:10.888+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:10.887+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl3lr5la3 --profiles-dir /tmp/tmp339z05v1 --profile weather --target dev`
[2025-06-20T08:51:10.888+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:10.888+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:10.889+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:10.888+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:10.889+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:10.888+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:16.801+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:16.798+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl3lr5la3', '--profiles-dir', '/tmp/tmp339z05v1', '--profile', 'weather', '--target', 'dev'] due to the error:
08:51:13  Running with dbt=1.7.9
08:51:14  Registered adapter: postgres=1.7.9
08:51:14  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:51:15  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:51:16.801+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:16.798+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl3lr5la3', '--profiles-dir', '/tmp/tmp339z05v1', '--profile', 'weather', '--target', 'dev'] due to the error:
08:51:13  Running with dbt=1.7.9
08:51:14  Registered adapter: postgres=1.7.9
08:51:14  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:51:15  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:51:16.802+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:51:16.818+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.197 seconds
[2025-06-20T08:51:47.362+0000] {processor.py:161} INFO - Started process (PID=1493) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:51:47.363+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:51:47.365+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.365+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:51:47.405+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.404+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:51:47.616+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.616+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:51:47.616+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.616+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:51:47.616+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.616+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:51:47.617+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.617+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:51:47.617+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.617+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:51:47.618+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.617+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:51:47.618+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.618+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:51:47.619+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.618+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:51:47.619+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.618+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:51:47.620+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.620+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2jbd5dzo/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:51:47.620+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.620+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp2jbd5dzo/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:51:47.621+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.620+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2jbd5dzo/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:51:47.621+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.621+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjkqq4j0r --profiles-dir /tmp/tmp2jbd5dzo --profile weather --target dev`
[2025-06-20T08:51:47.622+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.621+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjkqq4j0r --profiles-dir /tmp/tmp2jbd5dzo --profile weather --target dev`
[2025-06-20T08:51:47.622+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.621+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjkqq4j0r --profiles-dir /tmp/tmp2jbd5dzo --profile weather --target dev`
[2025-06-20T08:51:47.622+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.622+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:47.623+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:47.622+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:47.623+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:47.622+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:51.700+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:51.699+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjkqq4j0r --profiles-dir /tmp/tmp2jbd5dzo --profile weather --target dev`
[2025-06-20T08:51:51.700+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:51.699+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjkqq4j0r --profiles-dir /tmp/tmp2jbd5dzo --profile weather --target dev`
[2025-06-20T08:51:51.701+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:51.699+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjkqq4j0r --profiles-dir /tmp/tmp2jbd5dzo --profile weather --target dev`
[2025-06-20T08:51:51.701+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:51.701+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:51.701+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:51.701+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:51.702+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:51.701+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:51:59.646+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:51:59.644+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjkqq4j0r', '--profiles-dir', '/tmp/tmp2jbd5dzo', '--profile', 'weather', '--target', 'dev'] due to the error:
08:51:56  Running with dbt=1.7.9
08:51:56  Registered adapter: postgres=1.7.9
08:51:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:51:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:51:59.647+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:51:59.644+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjkqq4j0r', '--profiles-dir', '/tmp/tmp2jbd5dzo', '--profile', 'weather', '--target', 'dev'] due to the error:
08:51:56  Running with dbt=1.7.9
08:51:56  Registered adapter: postgres=1.7.9
08:51:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:51:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:51:59.648+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:51:59.667+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.307 seconds
[2025-06-20T08:52:30.578+0000] {processor.py:161} INFO - Started process (PID=1533) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:52:30.582+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:52:30.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.586+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:52:30.675+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.675+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:52:30.918+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.917+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:52:30.918+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.917+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:52:30.918+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.917+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:52:30.919+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.919+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:52:30.919+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.919+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:52:30.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.919+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:52:30.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.920+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:52:30.920+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.920+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:52:30.921+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.920+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:52:30.922+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.922+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpsx4zcw8j/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:52:30.922+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.922+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpsx4zcw8j/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:52:30.923+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.922+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpsx4zcw8j/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:52:30.923+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.923+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4cmdjoqt --profiles-dir /tmp/tmpsx4zcw8j --profile weather --target dev`
[2025-06-20T08:52:30.923+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.923+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4cmdjoqt --profiles-dir /tmp/tmpsx4zcw8j --profile weather --target dev`
[2025-06-20T08:52:30.924+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.923+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4cmdjoqt --profiles-dir /tmp/tmpsx4zcw8j --profile weather --target dev`
[2025-06-20T08:52:30.924+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.924+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:52:30.924+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:30.924+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:52:30.925+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:30.924+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:52:34.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:34.989+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4cmdjoqt --profiles-dir /tmp/tmpsx4zcw8j --profile weather --target dev`
[2025-06-20T08:52:34.990+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:34.989+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4cmdjoqt --profiles-dir /tmp/tmpsx4zcw8j --profile weather --target dev`
[2025-06-20T08:52:34.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:34.989+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4cmdjoqt --profiles-dir /tmp/tmpsx4zcw8j --profile weather --target dev`
[2025-06-20T08:52:34.991+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:34.990+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:52:34.991+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:34.990+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:52:34.991+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:34.990+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:52:44.426+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:52:44.423+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4cmdjoqt', '--profiles-dir', '/tmp/tmpsx4zcw8j', '--profile', 'weather', '--target', 'dev'] due to the error:
08:52:39  Running with dbt=1.7.9
08:52:40  Registered adapter: postgres=1.7.9
08:52:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:52:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:52:44.426+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:52:44.423+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4cmdjoqt', '--profiles-dir', '/tmp/tmpsx4zcw8j', '--profile', 'weather', '--target', 'dev'] due to the error:
08:52:39  Running with dbt=1.7.9
08:52:40  Registered adapter: postgres=1.7.9
08:52:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:52:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:52:44.427+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:52:44.445+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.874 seconds
[2025-06-20T08:53:14.574+0000] {processor.py:161} INFO - Started process (PID=1578) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:53:14.577+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:53:14.582+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:14.582+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:53:14.659+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:14.659+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:53:15.197+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.197+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:53:15.200+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:15.197+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:53:15.201+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.197+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:53:15.204+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.204+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:53:15.206+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:15.204+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:53:15.207+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.204+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:53:15.212+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.210+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:53:15.214+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:15.210+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:53:15.215+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.210+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:53:15.220+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.220+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpi7jlel4d/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:53:15.222+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:15.220+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpi7jlel4d/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:53:15.223+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.220+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpi7jlel4d/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:53:15.225+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.225+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzf27rv4x --profiles-dir /tmp/tmpi7jlel4d --profile weather --target dev`
[2025-06-20T08:53:15.227+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:15.225+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzf27rv4x --profiles-dir /tmp/tmpi7jlel4d --profile weather --target dev`
[2025-06-20T08:53:15.228+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.225+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzf27rv4x --profiles-dir /tmp/tmpi7jlel4d --profile weather --target dev`
[2025-06-20T08:53:15.229+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.229+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:15.230+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:15.229+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:15.230+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:15.229+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:23.101+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:23.100+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzf27rv4x --profiles-dir /tmp/tmpi7jlel4d --profile weather --target dev`
[2025-06-20T08:53:23.101+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:23.100+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzf27rv4x --profiles-dir /tmp/tmpi7jlel4d --profile weather --target dev`
[2025-06-20T08:53:23.101+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:23.100+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzf27rv4x --profiles-dir /tmp/tmpi7jlel4d --profile weather --target dev`
[2025-06-20T08:53:23.102+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:23.101+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:23.102+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:23.101+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:23.102+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:23.101+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:28.716+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:28.714+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzf27rv4x', '--profiles-dir', '/tmp/tmpi7jlel4d', '--profile', 'weather', '--target', 'dev'] due to the error:
08:53:25  Running with dbt=1.7.9
08:53:26  Registered adapter: postgres=1.7.9
08:53:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:53:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:53:28.717+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:28.714+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzf27rv4x', '--profiles-dir', '/tmp/tmpi7jlel4d', '--profile', 'weather', '--target', 'dev'] due to the error:
08:53:25  Running with dbt=1.7.9
08:53:26  Registered adapter: postgres=1.7.9
08:53:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:53:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:53:28.717+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:53:28.732+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.161 seconds
[2025-06-20T08:53:58.865+0000] {processor.py:161} INFO - Started process (PID=1629) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:53:58.866+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:53:58.869+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:58.869+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:53:58.931+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:58.930+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:53:59.304+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.303+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:53:59.304+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:59.303+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:53:59.305+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.303+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:53:59.306+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.306+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:53:59.306+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:59.306+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:53:59.307+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.306+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:53:59.308+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.307+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:53:59.308+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:59.307+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:53:59.309+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.307+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:53:59.311+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.311+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkxt9b8r1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:53:59.311+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:59.311+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpkxt9b8r1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:53:59.312+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.311+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkxt9b8r1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:53:59.313+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.313+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzjbgt_br --profiles-dir /tmp/tmpkxt9b8r1 --profile weather --target dev`
[2025-06-20T08:53:59.313+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:59.313+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzjbgt_br --profiles-dir /tmp/tmpkxt9b8r1 --profile weather --target dev`
[2025-06-20T08:53:59.314+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.313+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzjbgt_br --profiles-dir /tmp/tmpkxt9b8r1 --profile weather --target dev`
[2025-06-20T08:53:59.315+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.314+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:59.315+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:53:59.314+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:53:59.316+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:53:59.314+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:04.983+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:04.982+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzjbgt_br --profiles-dir /tmp/tmpkxt9b8r1 --profile weather --target dev`
[2025-06-20T08:54:04.984+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:04.982+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzjbgt_br --profiles-dir /tmp/tmpkxt9b8r1 --profile weather --target dev`
[2025-06-20T08:54:04.985+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:04.982+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzjbgt_br --profiles-dir /tmp/tmpkxt9b8r1 --profile weather --target dev`
[2025-06-20T08:54:04.985+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:04.985+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:04.986+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:04.985+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:04.986+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:04.985+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:11.921+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:11.919+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzjbgt_br', '--profiles-dir', '/tmp/tmpkxt9b8r1', '--profile', 'weather', '--target', 'dev'] due to the error:
08:54:08  Running with dbt=1.7.9
08:54:09  Registered adapter: postgres=1.7.9
08:54:09  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:54:10  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:54:11.921+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:11.919+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzjbgt_br', '--profiles-dir', '/tmp/tmpkxt9b8r1', '--profile', 'weather', '--target', 'dev'] due to the error:
08:54:08  Running with dbt=1.7.9
08:54:09  Registered adapter: postgres=1.7.9
08:54:09  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:54:10  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:54:11.922+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:54:11.937+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.076 seconds
[2025-06-20T08:54:42.020+0000] {processor.py:161} INFO - Started process (PID=1669) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:54:42.021+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:54:42.025+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.024+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:54:42.089+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.088+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:54:42.426+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.426+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:54:42.428+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.426+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:54:42.428+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.426+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:54:42.429+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.429+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:54:42.432+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.429+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:54:42.433+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.429+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:54:42.434+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.433+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:54:42.435+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.433+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:54:42.436+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.433+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:54:42.440+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.439+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpn6b9cw64/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:54:42.441+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.439+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpn6b9cw64/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:54:42.442+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.439+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpn6b9cw64/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:54:42.443+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.443+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnboxhvfk --profiles-dir /tmp/tmpn6b9cw64 --profile weather --target dev`
[2025-06-20T08:54:42.445+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.443+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnboxhvfk --profiles-dir /tmp/tmpn6b9cw64 --profile weather --target dev`
[2025-06-20T08:54:42.446+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.443+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnboxhvfk --profiles-dir /tmp/tmpn6b9cw64 --profile weather --target dev`
[2025-06-20T08:54:42.447+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.447+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:42.448+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:42.447+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:42.450+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:42.447+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:46.633+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:46.632+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnboxhvfk --profiles-dir /tmp/tmpn6b9cw64 --profile weather --target dev`
[2025-06-20T08:54:46.633+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:46.632+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnboxhvfk --profiles-dir /tmp/tmpn6b9cw64 --profile weather --target dev`
[2025-06-20T08:54:46.634+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:46.632+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnboxhvfk --profiles-dir /tmp/tmpn6b9cw64 --profile weather --target dev`
[2025-06-20T08:54:46.634+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:46.634+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:46.635+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:46.634+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:46.635+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:46.634+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:54:52.616+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:54:52.614+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpnboxhvfk', '--profiles-dir', '/tmp/tmpn6b9cw64', '--profile', 'weather', '--target', 'dev'] due to the error:
08:54:49  Running with dbt=1.7.9
08:54:50  Registered adapter: postgres=1.7.9
08:54:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:54:51  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:54:52.617+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:54:52.614+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpnboxhvfk', '--profiles-dir', '/tmp/tmpn6b9cw64', '--profile', 'weather', '--target', 'dev'] due to the error:
08:54:49  Running with dbt=1.7.9
08:54:50  Registered adapter: postgres=1.7.9
08:54:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:54:51  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:54:52.617+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:54:52.640+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.624 seconds
[2025-06-20T08:55:23.315+0000] {processor.py:161} INFO - Started process (PID=1713) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:55:23.318+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:55:23.323+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.323+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:55:23.396+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.396+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:55:23.635+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.635+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:55:23.635+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.635+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:55:23.636+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.635+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:55:23.637+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.636+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:55:23.637+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.636+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:55:23.637+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.636+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:55:23.638+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.637+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:55:23.638+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.637+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:55:23.638+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.637+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:55:23.640+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.640+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxqmufojs/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:55:23.640+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.640+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpxqmufojs/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:55:23.640+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.640+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxqmufojs/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:55:23.641+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.641+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6e6nxfej --profiles-dir /tmp/tmpxqmufojs --profile weather --target dev`
[2025-06-20T08:55:23.641+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.641+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6e6nxfej --profiles-dir /tmp/tmpxqmufojs --profile weather --target dev`
[2025-06-20T08:55:23.641+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.641+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6e6nxfej --profiles-dir /tmp/tmpxqmufojs --profile weather --target dev`
[2025-06-20T08:55:23.642+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.641+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:55:23.642+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:23.641+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:55:23.642+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:23.641+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:55:27.700+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:27.700+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6e6nxfej --profiles-dir /tmp/tmpxqmufojs --profile weather --target dev`
[2025-06-20T08:55:27.701+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:27.700+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6e6nxfej --profiles-dir /tmp/tmpxqmufojs --profile weather --target dev`
[2025-06-20T08:55:27.701+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:27.700+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6e6nxfej --profiles-dir /tmp/tmpxqmufojs --profile weather --target dev`
[2025-06-20T08:55:27.701+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:27.701+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:55:27.702+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:27.701+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:55:27.702+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:27.701+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:55:35.175+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:55:35.168+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6e6nxfej', '--profiles-dir', '/tmp/tmpxqmufojs', '--profile', 'weather', '--target', 'dev'] due to the error:
08:55:30  Running with dbt=1.7.9
08:55:31  Registered adapter: postgres=1.7.9
08:55:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:55:33  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:55:35.176+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:55:35.168+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6e6nxfej', '--profiles-dir', '/tmp/tmpxqmufojs', '--profile', 'weather', '--target', 'dev'] due to the error:
08:55:30  Running with dbt=1.7.9
08:55:31  Registered adapter: postgres=1.7.9
08:55:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:55:33  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:55:35.176+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:55:35.198+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.891 seconds
[2025-06-20T08:56:06.071+0000] {processor.py:161} INFO - Started process (PID=1754) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:56:06.072+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:56:06.074+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.074+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:56:06.121+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.121+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:56:06.334+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.334+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:56:06.334+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.334+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:56:06.335+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.334+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:56:06.335+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.335+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:56:06.336+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.335+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:56:06.336+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.335+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:56:06.337+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.336+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:56:06.337+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.336+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:56:06.337+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.336+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:56:06.339+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.338+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpu6fqnlg7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:56:06.339+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.338+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpu6fqnlg7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:56:06.339+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.338+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpu6fqnlg7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:56:06.340+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.340+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy6pndppe --profiles-dir /tmp/tmpu6fqnlg7 --profile weather --target dev`
[2025-06-20T08:56:06.340+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.340+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy6pndppe --profiles-dir /tmp/tmpu6fqnlg7 --profile weather --target dev`
[2025-06-20T08:56:06.340+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.340+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy6pndppe --profiles-dir /tmp/tmpu6fqnlg7 --profile weather --target dev`
[2025-06-20T08:56:06.341+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.340+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:06.341+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:06.340+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:06.341+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:06.340+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:13.094+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:13.093+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy6pndppe --profiles-dir /tmp/tmpu6fqnlg7 --profile weather --target dev`
[2025-06-20T08:56:13.097+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:13.093+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy6pndppe --profiles-dir /tmp/tmpu6fqnlg7 --profile weather --target dev`
[2025-06-20T08:56:13.098+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:13.093+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy6pndppe --profiles-dir /tmp/tmpu6fqnlg7 --profile weather --target dev`
[2025-06-20T08:56:13.100+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:13.100+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:13.101+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:13.100+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:13.103+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:13.100+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:21.409+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:21.407+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpy6pndppe', '--profiles-dir', '/tmp/tmpu6fqnlg7', '--profile', 'weather', '--target', 'dev'] due to the error:
08:56:17  Running with dbt=1.7.9
08:56:17  Registered adapter: postgres=1.7.9
08:56:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:56:20  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:56:21.410+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:21.407+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpy6pndppe', '--profiles-dir', '/tmp/tmpu6fqnlg7', '--profile', 'weather', '--target', 'dev'] due to the error:
08:56:17  Running with dbt=1.7.9
08:56:17  Registered adapter: postgres=1.7.9
08:56:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:56:20  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:56:21.410+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:56:21.428+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.359 seconds
[2025-06-20T08:56:52.261+0000] {processor.py:161} INFO - Started process (PID=1807) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:56:52.264+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:56:52.269+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:52.267+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:56:52.413+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:52.412+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:56:53.151+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.150+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:56:53.155+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:53.150+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:56:53.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.150+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:56:53.159+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.159+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:56:53.161+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:53.159+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:56:53.162+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.159+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:56:53.167+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.164+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:56:53.167+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:53.164+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:56:53.168+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.164+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:56:53.176+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.174+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpuf2cri9u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:56:53.176+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:53.174+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpuf2cri9u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:56:53.179+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.174+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpuf2cri9u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:56:53.180+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.180+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpayeeneg7 --profiles-dir /tmp/tmpuf2cri9u --profile weather --target dev`
[2025-06-20T08:56:53.182+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:53.180+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpayeeneg7 --profiles-dir /tmp/tmpuf2cri9u --profile weather --target dev`
[2025-06-20T08:56:53.182+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.180+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpayeeneg7 --profiles-dir /tmp/tmpuf2cri9u --profile weather --target dev`
[2025-06-20T08:56:53.184+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.184+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:53.186+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:53.184+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:53.188+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:53.184+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:58.890+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:58.890+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpayeeneg7 --profiles-dir /tmp/tmpuf2cri9u --profile weather --target dev`
[2025-06-20T08:56:58.891+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:58.890+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpayeeneg7 --profiles-dir /tmp/tmpuf2cri9u --profile weather --target dev`
[2025-06-20T08:56:58.891+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:58.890+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpayeeneg7 --profiles-dir /tmp/tmpuf2cri9u --profile weather --target dev`
[2025-06-20T08:56:58.892+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:58.891+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:58.892+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:56:58.891+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:56:58.892+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:56:58.891+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:57:04.751+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:04.749+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpayeeneg7', '--profiles-dir', '/tmp/tmpuf2cri9u', '--profile', 'weather', '--target', 'dev'] due to the error:
08:57:01  Running with dbt=1.7.9
08:57:02  Registered adapter: postgres=1.7.9
08:57:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:57:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:57:04.752+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:04.749+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpayeeneg7', '--profiles-dir', '/tmp/tmpuf2cri9u', '--profile', 'weather', '--target', 'dev'] due to the error:
08:57:01  Running with dbt=1.7.9
08:57:02  Registered adapter: postgres=1.7.9
08:57:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:57:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:57:04.752+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:57:04.770+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.516 seconds
[2025-06-20T08:57:34.833+0000] {processor.py:161} INFO - Started process (PID=1850) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:57:34.834+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:57:34.836+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:34.836+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:57:34.878+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:34.878+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:57:35.130+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.129+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:57:35.130+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:35.129+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:57:35.130+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.129+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:57:35.132+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.131+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:57:35.132+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:35.131+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:57:35.132+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.131+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:57:35.134+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.133+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:57:35.134+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:35.133+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:57:35.134+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.133+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:57:35.136+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.136+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvhf0w7r1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:57:35.137+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:35.136+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpvhf0w7r1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:57:35.137+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.136+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvhf0w7r1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:57:35.138+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.138+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqroskuvs --profiles-dir /tmp/tmpvhf0w7r1 --profile weather --target dev`
[2025-06-20T08:57:35.139+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:35.138+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqroskuvs --profiles-dir /tmp/tmpvhf0w7r1 --profile weather --target dev`
[2025-06-20T08:57:35.140+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.138+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqroskuvs --profiles-dir /tmp/tmpvhf0w7r1 --profile weather --target dev`
[2025-06-20T08:57:35.141+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.140+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:57:35.141+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:35.140+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:57:35.142+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:35.140+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:57:39.262+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:39.261+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqroskuvs --profiles-dir /tmp/tmpvhf0w7r1 --profile weather --target dev`
[2025-06-20T08:57:39.262+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:39.261+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqroskuvs --profiles-dir /tmp/tmpvhf0w7r1 --profile weather --target dev`
[2025-06-20T08:57:39.263+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:39.261+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqroskuvs --profiles-dir /tmp/tmpvhf0w7r1 --profile weather --target dev`
[2025-06-20T08:57:39.263+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:39.263+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:57:39.263+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:39.263+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:57:39.264+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:39.263+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:57:45.398+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:57:45.391+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqroskuvs', '--profiles-dir', '/tmp/tmpvhf0w7r1', '--profile', 'weather', '--target', 'dev'] due to the error:
08:57:42  Running with dbt=1.7.9
08:57:42  Registered adapter: postgres=1.7.9
08:57:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:57:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:57:45.400+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:57:45.391+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqroskuvs', '--profiles-dir', '/tmp/tmpvhf0w7r1', '--profile', 'weather', '--target', 'dev'] due to the error:
08:57:42  Running with dbt=1.7.9
08:57:42  Registered adapter: postgres=1.7.9
08:57:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:57:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:57:45.402+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:57:45.454+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.624 seconds
[2025-06-20T08:58:16.017+0000] {processor.py:161} INFO - Started process (PID=1890) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:58:16.017+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:58:16.020+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.019+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:58:16.060+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.060+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:58:16.283+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.283+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:58:16.283+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.283+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:58:16.284+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.283+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:58:16.284+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.284+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:58:16.284+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.284+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:58:16.285+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.284+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:58:16.286+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.285+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:58:16.286+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.285+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:58:16.286+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.285+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:58:16.287+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.287+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp9q4wpm35/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:58:16.288+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.287+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp9q4wpm35/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:58:16.288+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.287+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp9q4wpm35/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:58:16.289+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.288+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx6n4swq9 --profiles-dir /tmp/tmp9q4wpm35 --profile weather --target dev`
[2025-06-20T08:58:16.289+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.288+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx6n4swq9 --profiles-dir /tmp/tmp9q4wpm35 --profile weather --target dev`
[2025-06-20T08:58:16.289+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.288+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx6n4swq9 --profiles-dir /tmp/tmp9q4wpm35 --profile weather --target dev`
[2025-06-20T08:58:16.290+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.289+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:58:16.290+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:16.289+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:58:16.290+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:16.289+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:58:20.303+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:20.302+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx6n4swq9 --profiles-dir /tmp/tmp9q4wpm35 --profile weather --target dev`
[2025-06-20T08:58:20.304+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:20.302+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx6n4swq9 --profiles-dir /tmp/tmp9q4wpm35 --profile weather --target dev`
[2025-06-20T08:58:20.304+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:20.302+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx6n4swq9 --profiles-dir /tmp/tmp9q4wpm35 --profile weather --target dev`
[2025-06-20T08:58:20.305+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:20.304+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:58:20.305+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:20.304+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:58:20.306+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:20.304+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:58:28.877+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:58:28.855+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpx6n4swq9', '--profiles-dir', '/tmp/tmp9q4wpm35', '--profile', 'weather', '--target', 'dev'] due to the error:
08:58:23  Running with dbt=1.7.9
08:58:24  Registered adapter: postgres=1.7.9
08:58:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:58:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:58:28.884+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:58:28.855+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpx6n4swq9', '--profiles-dir', '/tmp/tmp9q4wpm35', '--profile', 'weather', '--target', 'dev'] due to the error:
08:58:23  Running with dbt=1.7.9
08:58:24  Registered adapter: postgres=1.7.9
08:58:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:58:27  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:58:28.886+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:58:28.994+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.980 seconds
[2025-06-20T08:59:00.062+0000] {processor.py:161} INFO - Started process (PID=1937) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:59:00.063+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:59:00.066+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.065+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:59:00.127+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.126+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:59:00.490+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.482+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:59:00.490+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.482+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:59:00.491+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.482+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:59:00.492+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.491+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:59:00.496+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.491+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:59:00.496+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.491+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:59:00.497+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.497+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:59:00.497+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.497+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:59:00.498+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.497+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:59:00.508+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.504+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp550fnqvi/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:59:00.508+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.504+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp550fnqvi/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:59:00.509+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.504+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp550fnqvi/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:59:00.512+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.511+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbni3wqlq --profiles-dir /tmp/tmp550fnqvi --profile weather --target dev`
[2025-06-20T08:59:00.514+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.511+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbni3wqlq --profiles-dir /tmp/tmp550fnqvi --profile weather --target dev`
[2025-06-20T08:59:00.515+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.511+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbni3wqlq --profiles-dir /tmp/tmp550fnqvi --profile weather --target dev`
[2025-06-20T08:59:00.517+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.516+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:00.519+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:00.516+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:00.520+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:00.516+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:08.736+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:08.735+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbni3wqlq --profiles-dir /tmp/tmp550fnqvi --profile weather --target dev`
[2025-06-20T08:59:08.737+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:08.735+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbni3wqlq --profiles-dir /tmp/tmp550fnqvi --profile weather --target dev`
[2025-06-20T08:59:08.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:08.735+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbni3wqlq --profiles-dir /tmp/tmp550fnqvi --profile weather --target dev`
[2025-06-20T08:59:08.739+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:08.739+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:08.740+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:08.739+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:08.740+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:08.739+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:14.834+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:14.833+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbni3wqlq', '--profiles-dir', '/tmp/tmp550fnqvi', '--profile', 'weather', '--target', 'dev'] due to the error:
08:59:12  Running with dbt=1.7.9
08:59:12  Registered adapter: postgres=1.7.9
08:59:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:59:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:59:14.835+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:14.833+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbni3wqlq', '--profiles-dir', '/tmp/tmp550fnqvi', '--profile', 'weather', '--target', 'dev'] due to the error:
08:59:12  Running with dbt=1.7.9
08:59:12  Registered adapter: postgres=1.7.9
08:59:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:59:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:59:14.835+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:59:14.850+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.792 seconds
[2025-06-20T08:59:45.591+0000] {processor.py:161} INFO - Started process (PID=1986) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:59:45.592+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T08:59:45.595+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:45.595+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:59:45.656+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:45.656+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T08:59:46.024+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.024+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:59:46.025+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:46.024+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:59:46.025+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.024+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T08:59:46.027+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.026+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:59:46.027+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:46.026+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:59:46.027+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.026+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T08:59:46.029+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.028+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:59:46.029+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:46.028+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T08:59:46.030+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.028+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T08:59:46.032+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.032+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1b__nrct/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:59:46.032+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:46.032+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp1b__nrct/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T08:59:46.033+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.032+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1b__nrct/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T08:59:46.034+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.033+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_sx3sw50 --profiles-dir /tmp/tmp1b__nrct --profile weather --target dev`
[2025-06-20T08:59:46.034+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:46.033+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_sx3sw50 --profiles-dir /tmp/tmp1b__nrct --profile weather --target dev`
[2025-06-20T08:59:46.035+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.033+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_sx3sw50 --profiles-dir /tmp/tmp1b__nrct --profile weather --target dev`
[2025-06-20T08:59:46.036+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.035+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:46.036+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:46.035+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:46.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:46.035+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:51.651+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:51.651+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_sx3sw50 --profiles-dir /tmp/tmp1b__nrct --profile weather --target dev`
[2025-06-20T08:59:51.652+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:51.651+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_sx3sw50 --profiles-dir /tmp/tmp1b__nrct --profile weather --target dev`
[2025-06-20T08:59:51.652+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:51.651+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_sx3sw50 --profiles-dir /tmp/tmp1b__nrct --profile weather --target dev`
[2025-06-20T08:59:51.653+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:51.652+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:51.653+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:51.652+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:51.653+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:51.652+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T08:59:57.683+0000] {logging_mixin.py:188} INFO - [2025-06-20T08:59:57.682+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_sx3sw50', '--profiles-dir', '/tmp/tmp1b__nrct', '--profile', 'weather', '--target', 'dev'] due to the error:
08:59:54  Running with dbt=1.7.9
08:59:55  Registered adapter: postgres=1.7.9
08:59:55  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:59:56  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:59:57.684+0000] {logging_mixin.py:188} WARNING - [2025-06-20T08:59:57.682+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_sx3sw50', '--profiles-dir', '/tmp/tmp1b__nrct', '--profile', 'weather', '--target', 'dev'] due to the error:
08:59:54  Running with dbt=1.7.9
08:59:55  Registered adapter: postgres=1.7.9
08:59:55  Unable to do partial parsing because saved manifest not found. Starting full parse.
08:59:56  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T08:59:57.684+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T08:59:57.700+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.112 seconds
[2025-06-20T09:00:28.510+0000] {processor.py:161} INFO - Started process (PID=2031) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:00:28.511+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:00:28.514+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.514+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:00:28.576+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.576+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:00:28.899+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.899+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:00:28.900+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.899+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:00:28.900+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.899+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:00:28.901+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.901+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:00:28.902+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.901+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:00:28.902+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.901+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:00:28.903+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.903+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:00:28.904+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.903+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:00:28.904+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.903+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:00:28.906+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.906+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpw3to6sxh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:00:28.906+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.906+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpw3to6sxh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:00:28.907+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.906+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpw3to6sxh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:00:28.908+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.908+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpydis2sw1 --profiles-dir /tmp/tmpw3to6sxh --profile weather --target dev`
[2025-06-20T09:00:28.908+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.908+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpydis2sw1 --profiles-dir /tmp/tmpw3to6sxh --profile weather --target dev`
[2025-06-20T09:00:28.909+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.908+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpydis2sw1 --profiles-dir /tmp/tmpw3to6sxh --profile weather --target dev`
[2025-06-20T09:00:28.910+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.909+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:00:28.910+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:28.909+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:00:28.910+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:28.909+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:00:33.342+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:33.342+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpydis2sw1 --profiles-dir /tmp/tmpw3to6sxh --profile weather --target dev`
[2025-06-20T09:00:33.343+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:33.342+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpydis2sw1 --profiles-dir /tmp/tmpw3to6sxh --profile weather --target dev`
[2025-06-20T09:00:33.343+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:33.342+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpydis2sw1 --profiles-dir /tmp/tmpw3to6sxh --profile weather --target dev`
[2025-06-20T09:00:33.343+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:33.343+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:00:33.344+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:33.343+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:00:33.344+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:33.343+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:00:39.114+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:00:39.111+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpydis2sw1', '--profiles-dir', '/tmp/tmpw3to6sxh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:00:36  Running with dbt=1.7.9
09:00:36  Registered adapter: postgres=1.7.9
09:00:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:00:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:00:39.114+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:00:39.111+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpydis2sw1', '--profiles-dir', '/tmp/tmpw3to6sxh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:00:36  Running with dbt=1.7.9
09:00:36  Registered adapter: postgres=1.7.9
09:00:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:00:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:00:39.115+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:00:39.136+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.630 seconds
[2025-06-20T09:01:09.809+0000] {processor.py:161} INFO - Started process (PID=2074) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:01:09.810+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:01:09.812+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:09.812+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:01:09.854+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:09.853+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:01:10.087+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.087+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:01:10.087+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:10.087+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:01:10.088+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.087+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:01:10.089+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.088+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:01:10.089+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:10.088+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:01:10.089+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.088+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:01:10.090+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.089+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:01:10.090+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:10.089+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:01:10.090+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.089+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:01:10.092+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.092+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1bpqp_ld/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:01:10.092+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:10.092+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp1bpqp_ld/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:01:10.092+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.092+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1bpqp_ld/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:01:10.093+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.093+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp193cynte --profiles-dir /tmp/tmp1bpqp_ld --profile weather --target dev`
[2025-06-20T09:01:10.093+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:10.093+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp193cynte --profiles-dir /tmp/tmp1bpqp_ld --profile weather --target dev`
[2025-06-20T09:01:10.093+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.093+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp193cynte --profiles-dir /tmp/tmp1bpqp_ld --profile weather --target dev`
[2025-06-20T09:01:10.094+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.093+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:10.094+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:10.093+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:10.095+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:10.093+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:14.377+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:14.376+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp193cynte --profiles-dir /tmp/tmp1bpqp_ld --profile weather --target dev`
[2025-06-20T09:01:14.377+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:14.376+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp193cynte --profiles-dir /tmp/tmp1bpqp_ld --profile weather --target dev`
[2025-06-20T09:01:14.378+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:14.376+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp193cynte --profiles-dir /tmp/tmp1bpqp_ld --profile weather --target dev`
[2025-06-20T09:01:14.378+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:14.378+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:14.378+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:14.378+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:14.379+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:14.378+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:24.436+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:24.431+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp193cynte', '--profiles-dir', '/tmp/tmp1bpqp_ld', '--profile', 'weather', '--target', 'dev'] due to the error:
09:01:17  Running with dbt=1.7.9
09:01:17  Registered adapter: postgres=1.7.9
09:01:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:01:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:01:24.437+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:24.431+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp193cynte', '--profiles-dir', '/tmp/tmp1bpqp_ld', '--profile', 'weather', '--target', 'dev'] due to the error:
09:01:17  Running with dbt=1.7.9
09:01:17  Registered adapter: postgres=1.7.9
09:01:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:01:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:01:24.438+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:01:24.470+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.664 seconds
[2025-06-20T09:01:55.579+0000] {processor.py:161} INFO - Started process (PID=2117) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:01:55.582+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:01:55.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.586+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:01:55.659+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.658+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:01:55.988+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.988+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:01:55.989+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.988+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:01:55.989+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.988+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:01:55.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.990+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:01:55.990+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.990+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:01:55.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.990+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:01:55.991+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.991+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:01:55.991+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.991+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:01:55.992+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.991+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:01:55.993+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.993+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkfu9lvxo/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:01:55.993+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.993+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpkfu9lvxo/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:01:55.994+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.993+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkfu9lvxo/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:01:55.994+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.994+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxch60opg --profiles-dir /tmp/tmpkfu9lvxo --profile weather --target dev`
[2025-06-20T09:01:55.994+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.994+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxch60opg --profiles-dir /tmp/tmpkfu9lvxo --profile weather --target dev`
[2025-06-20T09:01:55.995+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.994+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxch60opg --profiles-dir /tmp/tmpkfu9lvxo --profile weather --target dev`
[2025-06-20T09:01:55.995+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.995+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:55.996+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:01:55.995+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:01:55.996+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:01:55.995+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:02.808+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:02.808+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxch60opg --profiles-dir /tmp/tmpkfu9lvxo --profile weather --target dev`
[2025-06-20T09:02:02.809+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:02.808+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxch60opg --profiles-dir /tmp/tmpkfu9lvxo --profile weather --target dev`
[2025-06-20T09:02:02.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:02.808+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxch60opg --profiles-dir /tmp/tmpkfu9lvxo --profile weather --target dev`
[2025-06-20T09:02:02.810+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:02.810+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:02.811+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:02.810+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:02.811+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:02.810+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:09.390+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:09.389+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxch60opg', '--profiles-dir', '/tmp/tmpkfu9lvxo', '--profile', 'weather', '--target', 'dev'] due to the error:
09:02:06  Running with dbt=1.7.9
09:02:06  Registered adapter: postgres=1.7.9
09:02:06  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:02:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:02:09.391+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:09.389+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxch60opg', '--profiles-dir', '/tmp/tmpkfu9lvxo', '--profile', 'weather', '--target', 'dev'] due to the error:
09:02:06  Running with dbt=1.7.9
09:02:06  Registered adapter: postgres=1.7.9
09:02:06  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:02:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:02:09.391+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:02:09.407+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.833 seconds
[2025-06-20T09:02:39.789+0000] {processor.py:161} INFO - Started process (PID=2163) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:02:39.790+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:02:39.792+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:39.792+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:02:39.838+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:39.838+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:02:40.054+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.054+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:02:40.054+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:40.054+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:02:40.055+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.054+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:02:40.057+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.057+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:02:40.058+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:40.057+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:02:40.058+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.057+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:02:40.059+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.059+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:02:40.060+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:40.059+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:02:40.060+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.059+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:02:40.062+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.062+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjdrdlzje/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:02:40.063+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:40.062+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpjdrdlzje/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:02:40.063+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.062+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjdrdlzje/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:02:40.064+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.064+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoyuzbsw9 --profiles-dir /tmp/tmpjdrdlzje --profile weather --target dev`
[2025-06-20T09:02:40.065+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:40.064+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoyuzbsw9 --profiles-dir /tmp/tmpjdrdlzje --profile weather --target dev`
[2025-06-20T09:02:40.065+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.064+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoyuzbsw9 --profiles-dir /tmp/tmpjdrdlzje --profile weather --target dev`
[2025-06-20T09:02:40.066+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.065+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:40.066+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:40.065+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:40.067+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:40.065+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:45.906+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:45.905+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoyuzbsw9 --profiles-dir /tmp/tmpjdrdlzje --profile weather --target dev`
[2025-06-20T09:02:45.906+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:45.905+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoyuzbsw9 --profiles-dir /tmp/tmpjdrdlzje --profile weather --target dev`
[2025-06-20T09:02:45.906+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:45.905+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoyuzbsw9 --profiles-dir /tmp/tmpjdrdlzje --profile weather --target dev`
[2025-06-20T09:02:45.907+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:45.907+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:45.907+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:45.907+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:45.907+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:45.907+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:02:51.576+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:02:51.574+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpoyuzbsw9', '--profiles-dir', '/tmp/tmpjdrdlzje', '--profile', 'weather', '--target', 'dev'] due to the error:
09:02:48  Running with dbt=1.7.9
09:02:48  Registered adapter: postgres=1.7.9
09:02:48  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:02:50  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:02:51.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:02:51.574+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpoyuzbsw9', '--profiles-dir', '/tmp/tmpjdrdlzje', '--profile', 'weather', '--target', 'dev'] due to the error:
09:02:48  Running with dbt=1.7.9
09:02:48  Registered adapter: postgres=1.7.9
09:02:48  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:02:50  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:02:51.577+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:02:51.592+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.806 seconds
[2025-06-20T09:03:22.322+0000] {processor.py:161} INFO - Started process (PID=2210) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:03:22.323+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:03:22.327+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.326+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:03:22.407+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.405+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:03:22.728+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.727+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:03:22.728+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.727+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:03:22.729+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.727+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:03:22.730+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.730+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:03:22.730+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.730+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:03:22.731+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.730+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:03:22.732+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.731+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:03:22.732+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.731+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:03:22.733+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.731+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:03:22.735+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.735+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmps_8ofhqu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:03:22.736+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.735+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmps_8ofhqu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:03:22.736+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.735+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmps_8ofhqu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:03:22.737+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.737+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvk53qqtt --profiles-dir /tmp/tmps_8ofhqu --profile weather --target dev`
[2025-06-20T09:03:22.738+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.737+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvk53qqtt --profiles-dir /tmp/tmps_8ofhqu --profile weather --target dev`
[2025-06-20T09:03:22.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.737+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvk53qqtt --profiles-dir /tmp/tmps_8ofhqu --profile weather --target dev`
[2025-06-20T09:03:22.739+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.738+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:03:22.739+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:22.738+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:03:22.740+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:22.738+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:03:27.189+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:27.188+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvk53qqtt --profiles-dir /tmp/tmps_8ofhqu --profile weather --target dev`
[2025-06-20T09:03:27.189+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:27.188+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvk53qqtt --profiles-dir /tmp/tmps_8ofhqu --profile weather --target dev`
[2025-06-20T09:03:27.189+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:27.188+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvk53qqtt --profiles-dir /tmp/tmps_8ofhqu --profile weather --target dev`
[2025-06-20T09:03:27.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:27.189+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:03:27.190+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:27.189+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:03:27.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:27.189+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:03:33.195+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:03:33.185+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvk53qqtt', '--profiles-dir', '/tmp/tmps_8ofhqu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:03:30  Running with dbt=1.7.9
09:03:30  Registered adapter: postgres=1.7.9
09:03:30  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:03:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:03:33.197+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:03:33.185+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvk53qqtt', '--profiles-dir', '/tmp/tmps_8ofhqu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:03:30  Running with dbt=1.7.9
09:03:30  Registered adapter: postgres=1.7.9
09:03:30  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:03:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:03:33.199+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:03:33.251+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.932 seconds
[2025-06-20T09:04:03.731+0000] {processor.py:161} INFO - Started process (PID=2253) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:04:03.732+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:04:03.734+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:03.734+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:04:03.775+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:03.775+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:04:04.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.038+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:04:04.038+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:04.038+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:04:04.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.038+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:04:04.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.039+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:04:04.040+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:04.039+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:04:04.040+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.039+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:04:04.041+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.040+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:04:04.041+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:04.040+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:04:04.041+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.040+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:04:04.043+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.043+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpiz2c3ctv/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:04:04.043+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:04.043+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpiz2c3ctv/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:04:04.043+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.043+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpiz2c3ctv/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:04:04.044+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.044+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmcb6iqhj --profiles-dir /tmp/tmpiz2c3ctv --profile weather --target dev`
[2025-06-20T09:04:04.044+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:04.044+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmcb6iqhj --profiles-dir /tmp/tmpiz2c3ctv --profile weather --target dev`
[2025-06-20T09:04:04.044+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.044+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmcb6iqhj --profiles-dir /tmp/tmpiz2c3ctv --profile weather --target dev`
[2025-06-20T09:04:04.045+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.045+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:04.045+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:04.045+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:04.046+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:04.045+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:09.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:09.945+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmcb6iqhj --profiles-dir /tmp/tmpiz2c3ctv --profile weather --target dev`
[2025-06-20T09:04:09.946+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:09.945+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmcb6iqhj --profiles-dir /tmp/tmpiz2c3ctv --profile weather --target dev`
[2025-06-20T09:04:09.946+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:09.945+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmcb6iqhj --profiles-dir /tmp/tmpiz2c3ctv --profile weather --target dev`
[2025-06-20T09:04:09.947+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:09.946+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:09.947+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:09.946+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:09.947+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:09.946+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:19.867+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:19.865+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmcb6iqhj', '--profiles-dir', '/tmp/tmpiz2c3ctv', '--profile', 'weather', '--target', 'dev'] due to the error:
09:04:14  Running with dbt=1.7.9
09:04:15  Registered adapter: postgres=1.7.9
09:04:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:04:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:04:19.868+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:19.865+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmcb6iqhj', '--profiles-dir', '/tmp/tmpiz2c3ctv', '--profile', 'weather', '--target', 'dev'] due to the error:
09:04:14  Running with dbt=1.7.9
09:04:15  Registered adapter: postgres=1.7.9
09:04:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:04:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:04:19.869+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:04:19.883+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 16.155 seconds
[2025-06-20T09:04:50.480+0000] {processor.py:161} INFO - Started process (PID=2298) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:04:50.482+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:04:50.488+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.487+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:04:50.592+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.592+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:04:50.982+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.981+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:04:50.982+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.981+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:04:50.982+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.981+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:04:50.983+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.983+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:04:50.984+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.983+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:04:50.984+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.983+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:04:50.985+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.985+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:04:50.986+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.985+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:04:50.986+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.985+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:04:50.988+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.988+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpd89ej2sr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:04:50.988+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.988+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpd89ej2sr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:04:50.989+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.988+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpd89ej2sr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:04:50.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.989+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphhtkkqhn --profiles-dir /tmp/tmpd89ej2sr --profile weather --target dev`
[2025-06-20T09:04:50.990+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.989+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphhtkkqhn --profiles-dir /tmp/tmpd89ej2sr --profile weather --target dev`
[2025-06-20T09:04:50.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.989+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphhtkkqhn --profiles-dir /tmp/tmpd89ej2sr --profile weather --target dev`
[2025-06-20T09:04:50.991+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.991+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:50.992+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:50.991+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:50.992+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:50.991+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:57.730+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:57.729+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphhtkkqhn --profiles-dir /tmp/tmpd89ej2sr --profile weather --target dev`
[2025-06-20T09:04:57.730+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:57.729+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphhtkkqhn --profiles-dir /tmp/tmpd89ej2sr --profile weather --target dev`
[2025-06-20T09:04:57.731+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:57.729+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphhtkkqhn --profiles-dir /tmp/tmpd89ej2sr --profile weather --target dev`
[2025-06-20T09:04:57.731+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:57.731+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:57.732+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:04:57.731+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:04:57.733+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:04:57.731+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:05:03.432+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:03.430+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphhtkkqhn', '--profiles-dir', '/tmp/tmpd89ej2sr', '--profile', 'weather', '--target', 'dev'] due to the error:
09:05:00  Running with dbt=1.7.9
09:05:00  Registered adapter: postgres=1.7.9
09:05:00  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:05:02  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:05:03.433+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:03.430+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphhtkkqhn', '--profiles-dir', '/tmp/tmpd89ej2sr', '--profile', 'weather', '--target', 'dev'] due to the error:
09:05:00  Running with dbt=1.7.9
09:05:00  Registered adapter: postgres=1.7.9
09:05:00  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:05:02  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:05:03.433+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:05:03.448+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.980 seconds
[2025-06-20T09:05:33.907+0000] {processor.py:161} INFO - Started process (PID=2350) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:05:33.908+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:05:33.910+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:33.910+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:05:33.979+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:33.979+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:05:34.290+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.289+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:05:34.290+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:34.289+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:05:34.291+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.289+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:05:34.292+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.292+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:05:34.292+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:34.292+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:05:34.293+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.292+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:05:34.294+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.293+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:05:34.294+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:34.293+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:05:34.295+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.293+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:05:34.297+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.297+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpnx0ye5qa/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:05:34.298+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:34.297+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpnx0ye5qa/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:05:34.298+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.297+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpnx0ye5qa/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:05:34.299+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.299+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1eg8tj_f --profiles-dir /tmp/tmpnx0ye5qa --profile weather --target dev`
[2025-06-20T09:05:34.300+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:34.299+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1eg8tj_f --profiles-dir /tmp/tmpnx0ye5qa --profile weather --target dev`
[2025-06-20T09:05:34.300+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.299+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1eg8tj_f --profiles-dir /tmp/tmpnx0ye5qa --profile weather --target dev`
[2025-06-20T09:05:34.301+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.300+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:05:34.301+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:34.300+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:05:34.302+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:34.300+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:05:39.332+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:39.331+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1eg8tj_f --profiles-dir /tmp/tmpnx0ye5qa --profile weather --target dev`
[2025-06-20T09:05:39.332+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:39.331+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1eg8tj_f --profiles-dir /tmp/tmpnx0ye5qa --profile weather --target dev`
[2025-06-20T09:05:39.333+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:39.331+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1eg8tj_f --profiles-dir /tmp/tmpnx0ye5qa --profile weather --target dev`
[2025-06-20T09:05:39.333+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:39.333+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:05:39.333+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:39.333+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:05:39.333+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:39.333+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:05:45.161+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:05:45.159+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1eg8tj_f', '--profiles-dir', '/tmp/tmpnx0ye5qa', '--profile', 'weather', '--target', 'dev'] due to the error:
09:05:42  Running with dbt=1.7.9
09:05:42  Registered adapter: postgres=1.7.9
09:05:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:05:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:05:45.163+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:05:45.159+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1eg8tj_f', '--profiles-dir', '/tmp/tmpnx0ye5qa', '--profile', 'weather', '--target', 'dev'] due to the error:
09:05:42  Running with dbt=1.7.9
09:05:42  Registered adapter: postgres=1.7.9
09:05:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:05:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:05:45.163+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:05:45.186+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.283 seconds
[2025-06-20T09:06:15.836+0000] {processor.py:161} INFO - Started process (PID=2394) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:06:15.836+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:06:15.839+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:15.839+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:06:15.881+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:15.881+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:06:16.133+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.133+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:06:16.134+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:16.133+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:06:16.134+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.133+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:06:16.135+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.135+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:06:16.135+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:16.135+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:06:16.135+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.135+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:06:16.136+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.136+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:06:16.136+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:16.136+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:06:16.137+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.136+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:06:16.138+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.138+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzw285g_8/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:06:16.138+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:16.138+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpzw285g_8/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:06:16.139+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.138+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzw285g_8/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:06:16.139+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.139+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvk2a0buo --profiles-dir /tmp/tmpzw285g_8 --profile weather --target dev`
[2025-06-20T09:06:16.139+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:16.139+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvk2a0buo --profiles-dir /tmp/tmpzw285g_8 --profile weather --target dev`
[2025-06-20T09:06:16.140+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.139+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvk2a0buo --profiles-dir /tmp/tmpzw285g_8 --profile weather --target dev`
[2025-06-20T09:06:16.140+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.140+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:16.141+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:16.140+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:16.141+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:16.140+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:21.282+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:21.281+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvk2a0buo --profiles-dir /tmp/tmpzw285g_8 --profile weather --target dev`
[2025-06-20T09:06:21.282+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:21.281+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvk2a0buo --profiles-dir /tmp/tmpzw285g_8 --profile weather --target dev`
[2025-06-20T09:06:21.282+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:21.281+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvk2a0buo --profiles-dir /tmp/tmpzw285g_8 --profile weather --target dev`
[2025-06-20T09:06:21.283+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:21.282+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:21.283+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:21.282+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:21.283+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:21.282+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:27.153+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:27.150+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvk2a0buo', '--profiles-dir', '/tmp/tmpzw285g_8', '--profile', 'weather', '--target', 'dev'] due to the error:
09:06:24  Running with dbt=1.7.9
09:06:24  Registered adapter: postgres=1.7.9
09:06:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:06:25  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:06:27.153+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:27.150+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvk2a0buo', '--profiles-dir', '/tmp/tmpzw285g_8', '--profile', 'weather', '--target', 'dev'] due to the error:
09:06:24  Running with dbt=1.7.9
09:06:24  Registered adapter: postgres=1.7.9
09:06:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:06:25  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:06:27.154+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:06:27.183+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.350 seconds
[2025-06-20T09:06:57.389+0000] {processor.py:161} INFO - Started process (PID=2433) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:06:57.390+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:06:57.392+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.392+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:06:57.441+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.440+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:06:57.673+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.672+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:06:57.673+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.672+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:06:57.673+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.672+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:06:57.674+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.674+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:06:57.674+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.674+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:06:57.675+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.674+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:06:57.675+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.675+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:06:57.676+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.675+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:06:57.676+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.675+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:06:57.677+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.677+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3xxrmdc2/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:06:57.678+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.677+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp3xxrmdc2/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:06:57.678+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.677+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3xxrmdc2/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:06:57.678+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.678+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpatcv5i_h --profiles-dir /tmp/tmp3xxrmdc2 --profile weather --target dev`
[2025-06-20T09:06:57.679+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.678+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpatcv5i_h --profiles-dir /tmp/tmp3xxrmdc2 --profile weather --target dev`
[2025-06-20T09:06:57.679+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.678+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpatcv5i_h --profiles-dir /tmp/tmp3xxrmdc2 --profile weather --target dev`
[2025-06-20T09:06:57.679+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.679+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:57.680+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:06:57.679+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:06:57.680+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:06:57.679+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:02.047+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:02.047+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpatcv5i_h --profiles-dir /tmp/tmp3xxrmdc2 --profile weather --target dev`
[2025-06-20T09:07:02.048+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:02.047+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpatcv5i_h --profiles-dir /tmp/tmp3xxrmdc2 --profile weather --target dev`
[2025-06-20T09:07:02.048+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:02.047+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpatcv5i_h --profiles-dir /tmp/tmp3xxrmdc2 --profile weather --target dev`
[2025-06-20T09:07:02.049+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:02.049+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:02.049+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:02.049+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:02.050+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:02.049+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:10.180+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:10.176+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpatcv5i_h', '--profiles-dir', '/tmp/tmp3xxrmdc2', '--profile', 'weather', '--target', 'dev'] due to the error:
09:07:05  Running with dbt=1.7.9
09:07:05  Registered adapter: postgres=1.7.9
09:07:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:07:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:07:10.183+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:10.176+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpatcv5i_h', '--profiles-dir', '/tmp/tmp3xxrmdc2', '--profile', 'weather', '--target', 'dev'] due to the error:
09:07:05  Running with dbt=1.7.9
09:07:05  Registered adapter: postgres=1.7.9
09:07:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:07:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:07:10.183+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:07:10.220+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.834 seconds
[2025-06-20T09:07:40.969+0000] {processor.py:161} INFO - Started process (PID=2478) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:07:40.970+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:07:40.973+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:40.973+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:07:41.026+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:41.026+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:07:41.250+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.249+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:07:41.250+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:41.249+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:07:41.250+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.249+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:07:41.251+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.251+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:07:41.251+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:41.251+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:07:41.252+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.251+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:07:41.252+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.252+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:07:41.252+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:41.252+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:07:41.253+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.252+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:07:41.254+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.254+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpe2cn6btk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:07:41.254+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:41.254+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpe2cn6btk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:07:41.255+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.254+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpe2cn6btk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:07:41.255+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.255+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpppe5fv1s --profiles-dir /tmp/tmpe2cn6btk --profile weather --target dev`
[2025-06-20T09:07:41.255+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:41.255+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpppe5fv1s --profiles-dir /tmp/tmpe2cn6btk --profile weather --target dev`
[2025-06-20T09:07:41.256+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.255+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpppe5fv1s --profiles-dir /tmp/tmpe2cn6btk --profile weather --target dev`
[2025-06-20T09:07:41.256+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.256+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:41.256+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:41.256+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:41.257+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:41.256+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:47.395+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:47.394+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpppe5fv1s --profiles-dir /tmp/tmpe2cn6btk --profile weather --target dev`
[2025-06-20T09:07:47.395+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:47.394+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpppe5fv1s --profiles-dir /tmp/tmpe2cn6btk --profile weather --target dev`
[2025-06-20T09:07:47.396+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:47.394+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpppe5fv1s --profiles-dir /tmp/tmpe2cn6btk --profile weather --target dev`
[2025-06-20T09:07:47.396+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:47.396+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:47.397+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:47.396+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:47.397+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:47.396+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:07:53.987+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:07:53.984+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpppe5fv1s', '--profiles-dir', '/tmp/tmpe2cn6btk', '--profile', 'weather', '--target', 'dev'] due to the error:
09:07:51  Running with dbt=1.7.9
09:07:51  Registered adapter: postgres=1.7.9
09:07:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:07:52  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:07:53.987+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:07:53.984+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpppe5fv1s', '--profiles-dir', '/tmp/tmpe2cn6btk', '--profile', 'weather', '--target', 'dev'] due to the error:
09:07:51  Running with dbt=1.7.9
09:07:51  Registered adapter: postgres=1.7.9
09:07:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:07:52  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:07:53.988+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:07:54.007+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.042 seconds
[2025-06-20T09:08:24.460+0000] {processor.py:161} INFO - Started process (PID=2522) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:08:24.461+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:08:24.464+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.464+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:08:24.505+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.505+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:08:24.707+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.707+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:08:24.707+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.707+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:08:24.708+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.707+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:08:24.708+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.708+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:08:24.709+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.708+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:08:24.709+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.708+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:08:24.710+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.709+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:08:24.710+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.709+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:08:24.710+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.709+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:08:24.711+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.711+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg_nlqsb4/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:08:24.712+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.711+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpg_nlqsb4/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:08:24.712+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.711+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg_nlqsb4/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:08:24.712+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.712+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmz0lyqfv --profiles-dir /tmp/tmpg_nlqsb4 --profile weather --target dev`
[2025-06-20T09:08:24.713+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.712+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmz0lyqfv --profiles-dir /tmp/tmpg_nlqsb4 --profile weather --target dev`
[2025-06-20T09:08:24.713+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.712+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmz0lyqfv --profiles-dir /tmp/tmpg_nlqsb4 --profile weather --target dev`
[2025-06-20T09:08:24.713+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.713+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:08:24.714+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:24.713+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:08:24.714+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:24.713+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:08:31.047+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:31.046+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmz0lyqfv --profiles-dir /tmp/tmpg_nlqsb4 --profile weather --target dev`
[2025-06-20T09:08:31.050+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:31.046+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmz0lyqfv --profiles-dir /tmp/tmpg_nlqsb4 --profile weather --target dev`
[2025-06-20T09:08:31.051+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:31.046+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmz0lyqfv --profiles-dir /tmp/tmpg_nlqsb4 --profile weather --target dev`
[2025-06-20T09:08:31.051+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:31.051+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:08:31.052+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:31.051+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:08:31.054+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:31.051+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:08:37.735+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:08:37.732+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmz0lyqfv', '--profiles-dir', '/tmp/tmpg_nlqsb4', '--profile', 'weather', '--target', 'dev'] due to the error:
09:08:34  Running with dbt=1.7.9
09:08:35  Registered adapter: postgres=1.7.9
09:08:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:08:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:08:37.737+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:08:37.732+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmz0lyqfv', '--profiles-dir', '/tmp/tmpg_nlqsb4', '--profile', 'weather', '--target', 'dev'] due to the error:
09:08:34  Running with dbt=1.7.9
09:08:35  Registered adapter: postgres=1.7.9
09:08:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:08:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:08:37.739+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:08:37.763+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.306 seconds
[2025-06-20T09:09:08.252+0000] {processor.py:161} INFO - Started process (PID=2573) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:09:08.255+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:09:08.266+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.265+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:09:08.383+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.382+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:09:08.798+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.798+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:09:08.799+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.798+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:09:08.799+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.798+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:09:08.801+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.800+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:09:08.801+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.800+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:09:08.801+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.800+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:09:08.803+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.802+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:09:08.803+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.802+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:09:08.803+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.802+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:09:08.805+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.805+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpo2nkpg4g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:09:08.806+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.805+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpo2nkpg4g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:09:08.806+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.805+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpo2nkpg4g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:09:08.807+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.807+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9x7lcnvv --profiles-dir /tmp/tmpo2nkpg4g --profile weather --target dev`
[2025-06-20T09:09:08.807+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.807+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9x7lcnvv --profiles-dir /tmp/tmpo2nkpg4g --profile weather --target dev`
[2025-06-20T09:09:08.808+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.807+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9x7lcnvv --profiles-dir /tmp/tmpo2nkpg4g --profile weather --target dev`
[2025-06-20T09:09:08.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.808+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:08.809+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:08.808+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:08.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:08.808+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:13.031+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:13.031+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9x7lcnvv --profiles-dir /tmp/tmpo2nkpg4g --profile weather --target dev`
[2025-06-20T09:09:13.032+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:13.031+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9x7lcnvv --profiles-dir /tmp/tmpo2nkpg4g --profile weather --target dev`
[2025-06-20T09:09:13.032+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:13.031+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9x7lcnvv --profiles-dir /tmp/tmpo2nkpg4g --profile weather --target dev`
[2025-06-20T09:09:13.032+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:13.032+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:13.033+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:13.032+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:13.033+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:13.032+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:18.626+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:18.624+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9x7lcnvv', '--profiles-dir', '/tmp/tmpo2nkpg4g', '--profile', 'weather', '--target', 'dev'] due to the error:
09:09:15  Running with dbt=1.7.9
09:09:16  Registered adapter: postgres=1.7.9
09:09:16  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:09:17  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:09:18.627+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:18.624+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9x7lcnvv', '--profiles-dir', '/tmp/tmpo2nkpg4g', '--profile', 'weather', '--target', 'dev'] due to the error:
09:09:15  Running with dbt=1.7.9
09:09:16  Registered adapter: postgres=1.7.9
09:09:16  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:09:17  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:09:18.628+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:09:18.645+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.402 seconds
[2025-06-20T09:09:49.184+0000] {processor.py:161} INFO - Started process (PID=2615) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:09:49.187+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:09:49.195+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.195+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:09:49.320+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.320+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:09:49.608+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.607+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:09:49.608+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.607+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:09:49.608+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.607+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:09:49.609+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.609+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:09:49.609+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.609+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:09:49.610+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.609+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:09:49.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.610+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:09:49.611+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.610+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:09:49.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.610+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:09:49.612+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.612+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp17wsl2ci/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:09:49.613+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.612+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp17wsl2ci/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:09:49.613+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.612+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp17wsl2ci/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:09:49.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.613+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdx2ek6zm --profiles-dir /tmp/tmp17wsl2ci --profile weather --target dev`
[2025-06-20T09:09:49.614+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.613+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdx2ek6zm --profiles-dir /tmp/tmp17wsl2ci --profile weather --target dev`
[2025-06-20T09:09:49.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.613+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdx2ek6zm --profiles-dir /tmp/tmp17wsl2ci --profile weather --target dev`
[2025-06-20T09:09:49.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.614+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:49.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:49.614+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:49.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:49.614+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:53.596+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:53.595+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdx2ek6zm --profiles-dir /tmp/tmp17wsl2ci --profile weather --target dev`
[2025-06-20T09:09:53.596+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:53.595+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdx2ek6zm --profiles-dir /tmp/tmp17wsl2ci --profile weather --target dev`
[2025-06-20T09:09:53.597+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:53.595+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdx2ek6zm --profiles-dir /tmp/tmp17wsl2ci --profile weather --target dev`
[2025-06-20T09:09:53.598+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:53.597+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:53.598+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:09:53.597+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:09:53.599+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:09:53.597+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:10:00.589+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:00.584+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdx2ek6zm', '--profiles-dir', '/tmp/tmp17wsl2ci', '--profile', 'weather', '--target', 'dev'] due to the error:
09:09:56  Running with dbt=1.7.9
09:09:56  Registered adapter: postgres=1.7.9
09:09:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:09:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:10:00.591+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:00.584+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdx2ek6zm', '--profiles-dir', '/tmp/tmp17wsl2ci', '--profile', 'weather', '--target', 'dev'] due to the error:
09:09:56  Running with dbt=1.7.9
09:09:56  Registered adapter: postgres=1.7.9
09:09:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:09:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:10:00.594+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:10:00.628+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.450 seconds
[2025-06-20T09:10:30.777+0000] {processor.py:161} INFO - Started process (PID=2656) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:10:30.777+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:10:30.780+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:30.779+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:10:30.821+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:30.821+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:10:31.022+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.021+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:10:31.022+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:31.021+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:10:31.022+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.021+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:10:31.023+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.023+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:10:31.023+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:31.023+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:10:31.024+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.023+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:10:31.024+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.024+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:10:31.025+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:31.024+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:10:31.025+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.024+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:10:31.026+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.026+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg8ovf6kx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:10:31.027+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:31.026+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpg8ovf6kx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:10:31.027+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.026+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg8ovf6kx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:10:31.028+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.027+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprvxphwco --profiles-dir /tmp/tmpg8ovf6kx --profile weather --target dev`
[2025-06-20T09:10:31.028+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:31.027+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprvxphwco --profiles-dir /tmp/tmpg8ovf6kx --profile weather --target dev`
[2025-06-20T09:10:31.028+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.027+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprvxphwco --profiles-dir /tmp/tmpg8ovf6kx --profile weather --target dev`
[2025-06-20T09:10:31.029+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.028+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:10:31.029+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:31.028+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:10:31.029+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:31.028+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:10:35.566+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:35.565+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprvxphwco --profiles-dir /tmp/tmpg8ovf6kx --profile weather --target dev`
[2025-06-20T09:10:35.567+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:35.565+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprvxphwco --profiles-dir /tmp/tmpg8ovf6kx --profile weather --target dev`
[2025-06-20T09:10:35.567+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:35.565+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprvxphwco --profiles-dir /tmp/tmpg8ovf6kx --profile weather --target dev`
[2025-06-20T09:10:35.568+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:35.568+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:10:35.568+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:35.568+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:10:35.569+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:35.568+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:10:46.522+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:10:46.520+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprvxphwco', '--profiles-dir', '/tmp/tmpg8ovf6kx', '--profile', 'weather', '--target', 'dev'] due to the error:
09:10:41  Running with dbt=1.7.9
09:10:42  Registered adapter: postgres=1.7.9
09:10:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:10:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:10:46.522+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:10:46.520+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprvxphwco', '--profiles-dir', '/tmp/tmpg8ovf6kx', '--profile', 'weather', '--target', 'dev'] due to the error:
09:10:41  Running with dbt=1.7.9
09:10:42  Registered adapter: postgres=1.7.9
09:10:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:10:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:10:46.523+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:10:46.537+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.763 seconds
[2025-06-20T09:11:17.178+0000] {processor.py:161} INFO - Started process (PID=2706) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:11:17.179+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:11:17.181+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.181+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:11:17.250+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.249+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:11:17.570+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.570+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:11:17.571+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.570+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:11:17.571+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.570+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:11:17.573+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.572+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:11:17.573+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.572+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:11:17.573+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.572+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:11:17.574+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.574+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:11:17.575+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.574+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:11:17.575+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.574+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:11:17.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.577+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxuczgmtl/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:11:17.577+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.577+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpxuczgmtl/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:11:17.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.577+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxuczgmtl/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:11:17.579+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.579+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx5go3yz1 --profiles-dir /tmp/tmpxuczgmtl --profile weather --target dev`
[2025-06-20T09:11:17.579+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.579+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx5go3yz1 --profiles-dir /tmp/tmpxuczgmtl --profile weather --target dev`
[2025-06-20T09:11:17.580+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.579+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx5go3yz1 --profiles-dir /tmp/tmpxuczgmtl --profile weather --target dev`
[2025-06-20T09:11:17.580+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.580+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:11:17.581+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:17.580+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:11:17.581+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:17.580+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:11:23.743+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:23.743+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx5go3yz1 --profiles-dir /tmp/tmpxuczgmtl --profile weather --target dev`
[2025-06-20T09:11:23.743+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:23.743+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx5go3yz1 --profiles-dir /tmp/tmpxuczgmtl --profile weather --target dev`
[2025-06-20T09:11:23.744+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:23.743+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx5go3yz1 --profiles-dir /tmp/tmpxuczgmtl --profile weather --target dev`
[2025-06-20T09:11:23.744+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:23.744+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:11:23.744+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:23.744+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:11:23.745+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:23.744+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:11:29.325+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:11:29.322+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpx5go3yz1', '--profiles-dir', '/tmp/tmpxuczgmtl', '--profile', 'weather', '--target', 'dev'] due to the error:
09:11:26  Running with dbt=1.7.9
09:11:26  Registered adapter: postgres=1.7.9
09:11:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:11:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:11:29.329+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:11:29.322+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpx5go3yz1', '--profiles-dir', '/tmp/tmpxuczgmtl', '--profile', 'weather', '--target', 'dev'] due to the error:
09:11:26  Running with dbt=1.7.9
09:11:26  Registered adapter: postgres=1.7.9
09:11:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:11:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:11:29.329+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:11:29.344+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.172 seconds
[2025-06-20T09:12:00.041+0000] {processor.py:161} INFO - Started process (PID=2755) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:12:00.042+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:12:00.045+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.045+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:12:00.108+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.108+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:12:00.504+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.503+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:12:00.505+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.503+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:12:00.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.503+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:12:00.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.506+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:12:00.507+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.506+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:12:00.508+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.506+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:12:00.509+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.508+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:12:00.509+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.508+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:12:00.509+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.508+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:12:00.511+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.511+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpuaf90bsz/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:12:00.512+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.511+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpuaf90bsz/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:12:00.512+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.511+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpuaf90bsz/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:12:00.513+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.513+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpf672hc1s --profiles-dir /tmp/tmpuaf90bsz --profile weather --target dev`
[2025-06-20T09:12:00.513+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.513+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpf672hc1s --profiles-dir /tmp/tmpuaf90bsz --profile weather --target dev`
[2025-06-20T09:12:00.514+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.513+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpf672hc1s --profiles-dir /tmp/tmpuaf90bsz --profile weather --target dev`
[2025-06-20T09:12:00.515+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.514+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:00.515+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:00.514+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:00.516+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:00.514+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:04.835+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:04.834+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpf672hc1s --profiles-dir /tmp/tmpuaf90bsz --profile weather --target dev`
[2025-06-20T09:12:04.835+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:04.834+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpf672hc1s --profiles-dir /tmp/tmpuaf90bsz --profile weather --target dev`
[2025-06-20T09:12:04.836+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:04.834+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpf672hc1s --profiles-dir /tmp/tmpuaf90bsz --profile weather --target dev`
[2025-06-20T09:12:04.836+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:04.836+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:04.836+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:04.836+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:04.837+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:04.836+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:10.612+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:10.610+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpf672hc1s', '--profiles-dir', '/tmp/tmpuaf90bsz', '--profile', 'weather', '--target', 'dev'] due to the error:
09:12:07  Running with dbt=1.7.9
09:12:08  Registered adapter: postgres=1.7.9
09:12:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:12:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:12:10.613+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:10.610+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpf672hc1s', '--profiles-dir', '/tmp/tmpuaf90bsz', '--profile', 'weather', '--target', 'dev'] due to the error:
09:12:07  Running with dbt=1.7.9
09:12:08  Registered adapter: postgres=1.7.9
09:12:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:12:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:12:10.613+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:12:10.630+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.597 seconds
[2025-06-20T09:12:41.275+0000] {processor.py:161} INFO - Started process (PID=2798) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:12:41.276+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:12:41.278+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.278+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:12:41.318+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.318+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:12:41.529+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.529+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:12:41.530+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.529+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:12:41.530+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.529+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:12:41.531+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.531+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:12:41.531+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.531+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:12:41.531+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.531+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:12:41.532+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.532+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:12:41.532+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.532+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:12:41.532+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.532+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:12:41.534+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.534+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpnepy6qlh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:12:41.534+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.534+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpnepy6qlh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:12:41.534+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.534+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpnepy6qlh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:12:41.535+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.535+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj7fls8km --profiles-dir /tmp/tmpnepy6qlh --profile weather --target dev`
[2025-06-20T09:12:41.535+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.535+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj7fls8km --profiles-dir /tmp/tmpnepy6qlh --profile weather --target dev`
[2025-06-20T09:12:41.535+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.535+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj7fls8km --profiles-dir /tmp/tmpnepy6qlh --profile weather --target dev`
[2025-06-20T09:12:41.536+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.536+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:41.536+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:41.536+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:41.537+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:41.536+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:45.763+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:45.763+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj7fls8km --profiles-dir /tmp/tmpnepy6qlh --profile weather --target dev`
[2025-06-20T09:12:45.763+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:45.763+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj7fls8km --profiles-dir /tmp/tmpnepy6qlh --profile weather --target dev`
[2025-06-20T09:12:45.764+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:45.763+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj7fls8km --profiles-dir /tmp/tmpnepy6qlh --profile weather --target dev`
[2025-06-20T09:12:45.764+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:45.764+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:45.764+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:45.764+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:45.765+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:45.764+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:12:54.906+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:12:54.897+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpj7fls8km', '--profiles-dir', '/tmp/tmpnepy6qlh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:12:48  Running with dbt=1.7.9
09:12:49  Registered adapter: postgres=1.7.9
09:12:49  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:12:52  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:12:54.913+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:12:54.897+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpj7fls8km', '--profiles-dir', '/tmp/tmpnepy6qlh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:12:48  Running with dbt=1.7.9
09:12:49  Registered adapter: postgres=1.7.9
09:12:49  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:12:52  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:12:54.915+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:12:54.996+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.725 seconds
[2025-06-20T09:13:25.504+0000] {processor.py:161} INFO - Started process (PID=2840) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:13:25.504+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:13:25.507+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.507+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:13:25.578+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.578+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:13:25.839+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.839+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:13:25.839+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.839+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:13:25.840+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.839+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:13:25.840+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.840+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:13:25.841+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.840+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:13:25.841+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.840+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:13:25.842+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.841+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:13:25.842+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.841+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:13:25.842+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.841+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:13:25.844+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.843+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpoljned82/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:13:25.844+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.843+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpoljned82/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:13:25.844+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.843+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpoljned82/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:13:25.845+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.845+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmps4hlnxx1 --profiles-dir /tmp/tmpoljned82 --profile weather --target dev`
[2025-06-20T09:13:25.845+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.845+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmps4hlnxx1 --profiles-dir /tmp/tmpoljned82 --profile weather --target dev`
[2025-06-20T09:13:25.846+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.845+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmps4hlnxx1 --profiles-dir /tmp/tmpoljned82 --profile weather --target dev`
[2025-06-20T09:13:25.846+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.846+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:13:25.847+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:25.846+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:13:25.847+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:25.846+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:13:34.889+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:34.888+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmps4hlnxx1 --profiles-dir /tmp/tmpoljned82 --profile weather --target dev`
[2025-06-20T09:13:34.889+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:34.888+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmps4hlnxx1 --profiles-dir /tmp/tmpoljned82 --profile weather --target dev`
[2025-06-20T09:13:34.889+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:34.888+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmps4hlnxx1 --profiles-dir /tmp/tmpoljned82 --profile weather --target dev`
[2025-06-20T09:13:34.890+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:34.889+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:13:34.890+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:34.889+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:13:34.890+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:34.889+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:13:41.307+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:13:41.304+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmps4hlnxx1', '--profiles-dir', '/tmp/tmpoljned82', '--profile', 'weather', '--target', 'dev'] due to the error:
09:13:38  Running with dbt=1.7.9
09:13:38  Registered adapter: postgres=1.7.9
09:13:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:13:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:13:41.308+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:13:41.304+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmps4hlnxx1', '--profiles-dir', '/tmp/tmpoljned82', '--profile', 'weather', '--target', 'dev'] due to the error:
09:13:38  Running with dbt=1.7.9
09:13:38  Registered adapter: postgres=1.7.9
09:13:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:13:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:13:41.308+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:13:41.323+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.823 seconds
[2025-06-20T09:14:11.703+0000] {processor.py:161} INFO - Started process (PID=2884) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:14:11.704+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:14:11.707+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.707+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:14:11.750+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.750+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:14:11.988+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.988+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:14:11.988+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.988+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:14:11.989+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.988+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:14:11.989+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.989+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:14:11.990+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.989+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:14:11.990+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.989+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:14:11.991+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.990+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:14:11.991+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.990+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:14:11.991+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.990+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:14:11.993+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.992+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp5mrxn15z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:14:11.993+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.992+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp5mrxn15z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:14:11.993+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.992+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp5mrxn15z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:14:11.994+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.994+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpckbuyn_4 --profiles-dir /tmp/tmp5mrxn15z --profile weather --target dev`
[2025-06-20T09:14:11.994+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.994+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpckbuyn_4 --profiles-dir /tmp/tmp5mrxn15z --profile weather --target dev`
[2025-06-20T09:14:11.994+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.994+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpckbuyn_4 --profiles-dir /tmp/tmp5mrxn15z --profile weather --target dev`
[2025-06-20T09:14:11.995+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.994+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:11.995+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:11.994+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:11.995+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:11.994+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:18.133+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:18.132+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpckbuyn_4 --profiles-dir /tmp/tmp5mrxn15z --profile weather --target dev`
[2025-06-20T09:14:18.133+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:18.132+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpckbuyn_4 --profiles-dir /tmp/tmp5mrxn15z --profile weather --target dev`
[2025-06-20T09:14:18.133+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:18.132+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpckbuyn_4 --profiles-dir /tmp/tmp5mrxn15z --profile weather --target dev`
[2025-06-20T09:14:18.134+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:18.133+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:18.134+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:18.133+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:18.134+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:18.133+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:23.944+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:23.942+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpckbuyn_4', '--profiles-dir', '/tmp/tmp5mrxn15z', '--profile', 'weather', '--target', 'dev'] due to the error:
09:14:21  Running with dbt=1.7.9
09:14:21  Registered adapter: postgres=1.7.9
09:14:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:14:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:14:23.944+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:23.942+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpckbuyn_4', '--profiles-dir', '/tmp/tmp5mrxn15z', '--profile', 'weather', '--target', 'dev'] due to the error:
09:14:21  Running with dbt=1.7.9
09:14:21  Registered adapter: postgres=1.7.9
09:14:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:14:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:14:23.945+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:14:23.960+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.261 seconds
[2025-06-20T09:14:54.098+0000] {processor.py:161} INFO - Started process (PID=2935) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:14:54.100+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:14:54.104+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.104+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:14:54.163+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.163+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:14:54.483+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.482+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:14:54.483+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.482+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:14:54.484+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.482+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:14:54.485+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.485+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:14:54.485+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.485+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:14:54.486+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.485+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:14:54.487+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.486+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:14:54.487+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.486+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:14:54.488+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.486+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:14:54.490+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.490+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvfjyjqin/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:14:54.490+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.490+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpvfjyjqin/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:14:54.491+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.490+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvfjyjqin/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:14:54.492+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.491+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkiih7d8d --profiles-dir /tmp/tmpvfjyjqin --profile weather --target dev`
[2025-06-20T09:14:54.492+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.491+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkiih7d8d --profiles-dir /tmp/tmpvfjyjqin --profile weather --target dev`
[2025-06-20T09:14:54.493+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.491+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkiih7d8d --profiles-dir /tmp/tmpvfjyjqin --profile weather --target dev`
[2025-06-20T09:14:54.494+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.493+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:54.494+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:54.493+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:54.495+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:54.493+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:59.898+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:59.897+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkiih7d8d --profiles-dir /tmp/tmpvfjyjqin --profile weather --target dev`
[2025-06-20T09:14:59.898+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:59.897+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkiih7d8d --profiles-dir /tmp/tmpvfjyjqin --profile weather --target dev`
[2025-06-20T09:14:59.898+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:59.897+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkiih7d8d --profiles-dir /tmp/tmpvfjyjqin --profile weather --target dev`
[2025-06-20T09:14:59.899+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:59.898+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:59.899+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:14:59.898+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:14:59.899+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:14:59.898+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:15:05.649+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:05.647+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpkiih7d8d', '--profiles-dir', '/tmp/tmpvfjyjqin', '--profile', 'weather', '--target', 'dev'] due to the error:
09:15:02  Running with dbt=1.7.9
09:15:03  Registered adapter: postgres=1.7.9
09:15:03  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:15:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:15:05.650+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:05.647+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpkiih7d8d', '--profiles-dir', '/tmp/tmpvfjyjqin', '--profile', 'weather', '--target', 'dev'] due to the error:
09:15:02  Running with dbt=1.7.9
09:15:03  Registered adapter: postgres=1.7.9
09:15:03  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:15:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:15:05.650+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:15:05.664+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.572 seconds
[2025-06-20T09:15:36.294+0000] {processor.py:161} INFO - Started process (PID=2975) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:15:36.295+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:15:36.297+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.297+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:15:36.350+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.350+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:15:36.609+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.608+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:15:36.609+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.608+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:15:36.609+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.608+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:15:36.610+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.610+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:15:36.610+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.610+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:15:36.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.610+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:15:36.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.611+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:15:36.612+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.611+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:15:36.612+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.611+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:15:36.613+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.613+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfj8ban12/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:15:36.614+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.613+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpfj8ban12/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:15:36.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.613+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfj8ban12/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:15:36.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.614+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi1jzgd0o --profiles-dir /tmp/tmpfj8ban12 --profile weather --target dev`
[2025-06-20T09:15:36.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.614+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi1jzgd0o --profiles-dir /tmp/tmpfj8ban12 --profile weather --target dev`
[2025-06-20T09:15:36.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.614+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi1jzgd0o --profiles-dir /tmp/tmpfj8ban12 --profile weather --target dev`
[2025-06-20T09:15:36.616+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.615+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:15:36.616+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:36.615+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:15:36.616+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:36.615+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:15:40.845+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:40.845+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi1jzgd0o --profiles-dir /tmp/tmpfj8ban12 --profile weather --target dev`
[2025-06-20T09:15:40.846+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:40.845+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi1jzgd0o --profiles-dir /tmp/tmpfj8ban12 --profile weather --target dev`
[2025-06-20T09:15:40.846+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:40.845+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi1jzgd0o --profiles-dir /tmp/tmpfj8ban12 --profile weather --target dev`
[2025-06-20T09:15:40.847+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:40.847+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:15:40.847+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:40.847+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:15:40.848+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:40.847+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:15:49.109+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:15:49.104+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpi1jzgd0o', '--profiles-dir', '/tmp/tmpfj8ban12', '--profile', 'weather', '--target', 'dev'] due to the error:
09:15:45  Running with dbt=1.7.9
09:15:45  Registered adapter: postgres=1.7.9
09:15:45  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:15:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:15:49.112+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:15:49.104+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpi1jzgd0o', '--profiles-dir', '/tmp/tmpfj8ban12', '--profile', 'weather', '--target', 'dev'] due to the error:
09:15:45  Running with dbt=1.7.9
09:15:45  Registered adapter: postgres=1.7.9
09:15:45  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:15:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:15:49.113+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:15:49.149+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.861 seconds
[2025-06-20T09:16:19.814+0000] {processor.py:161} INFO - Started process (PID=3018) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:16:19.815+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:16:19.816+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:19.816+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:16:19.874+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:19.874+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:16:20.177+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.176+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:16:20.177+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:20.176+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:16:20.177+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.176+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:16:20.178+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.178+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:16:20.178+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:20.178+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:16:20.179+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.178+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:16:20.179+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.179+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:16:20.180+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:20.179+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:16:20.180+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.179+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:16:20.181+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.181+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdz_1bqud/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:16:20.182+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:20.181+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpdz_1bqud/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:16:20.182+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.181+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdz_1bqud/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:16:20.182+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.182+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpct3sti6t --profiles-dir /tmp/tmpdz_1bqud --profile weather --target dev`
[2025-06-20T09:16:20.183+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:20.182+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpct3sti6t --profiles-dir /tmp/tmpdz_1bqud --profile weather --target dev`
[2025-06-20T09:16:20.183+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.182+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpct3sti6t --profiles-dir /tmp/tmpdz_1bqud --profile weather --target dev`
[2025-06-20T09:16:20.184+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.183+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:16:20.184+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:20.183+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:16:20.184+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:20.183+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:16:25.333+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:25.332+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpct3sti6t --profiles-dir /tmp/tmpdz_1bqud --profile weather --target dev`
[2025-06-20T09:16:25.334+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:25.332+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpct3sti6t --profiles-dir /tmp/tmpdz_1bqud --profile weather --target dev`
[2025-06-20T09:16:25.334+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:25.332+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpct3sti6t --profiles-dir /tmp/tmpdz_1bqud --profile weather --target dev`
[2025-06-20T09:16:25.335+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:25.335+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:16:25.335+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:25.335+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:16:25.336+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:25.335+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:16:33.210+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:16:33.208+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpct3sti6t', '--profiles-dir', '/tmp/tmpdz_1bqud', '--profile', 'weather', '--target', 'dev'] due to the error:
09:16:29  Running with dbt=1.7.9
09:16:29  Registered adapter: postgres=1.7.9
09:16:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:16:32  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:16:33.210+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:16:33.208+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpct3sti6t', '--profiles-dir', '/tmp/tmpdz_1bqud', '--profile', 'weather', '--target', 'dev'] due to the error:
09:16:29  Running with dbt=1.7.9
09:16:29  Registered adapter: postgres=1.7.9
09:16:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:16:32  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:16:33.211+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:16:33.225+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.414 seconds
[2025-06-20T09:17:04.072+0000] {processor.py:161} INFO - Started process (PID=3063) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:17:04.072+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:17:04.075+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.074+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:17:04.130+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.130+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:17:04.347+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.347+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:17:04.347+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.347+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:17:04.348+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.347+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:17:04.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.348+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:17:04.349+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.348+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:17:04.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.348+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:17:04.350+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.349+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:17:04.350+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.349+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:17:04.350+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.349+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:17:04.352+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.352+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmph2hqoqkr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:17:04.352+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.352+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmph2hqoqkr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:17:04.352+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.352+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmph2hqoqkr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:17:04.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.353+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqf7iy1_i --profiles-dir /tmp/tmph2hqoqkr --profile weather --target dev`
[2025-06-20T09:17:04.353+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.353+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqf7iy1_i --profiles-dir /tmp/tmph2hqoqkr --profile weather --target dev`
[2025-06-20T09:17:04.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.353+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqf7iy1_i --profiles-dir /tmp/tmph2hqoqkr --profile weather --target dev`
[2025-06-20T09:17:04.354+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.354+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:04.354+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:04.354+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:04.354+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:04.354+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:08.378+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:08.377+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqf7iy1_i --profiles-dir /tmp/tmph2hqoqkr --profile weather --target dev`
[2025-06-20T09:17:08.378+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:08.377+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqf7iy1_i --profiles-dir /tmp/tmph2hqoqkr --profile weather --target dev`
[2025-06-20T09:17:08.379+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:08.377+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqf7iy1_i --profiles-dir /tmp/tmph2hqoqkr --profile weather --target dev`
[2025-06-20T09:17:08.380+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:08.379+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:08.380+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:08.379+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:08.381+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:08.379+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:15.444+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:15.442+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqf7iy1_i', '--profiles-dir', '/tmp/tmph2hqoqkr', '--profile', 'weather', '--target', 'dev'] due to the error:
09:17:12  Running with dbt=1.7.9
09:17:12  Registered adapter: postgres=1.7.9
09:17:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:17:14  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:17:15.444+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:15.442+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqf7iy1_i', '--profiles-dir', '/tmp/tmph2hqoqkr', '--profile', 'weather', '--target', 'dev'] due to the error:
09:17:12  Running with dbt=1.7.9
09:17:12  Registered adapter: postgres=1.7.9
09:17:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:17:14  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:17:15.445+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:17:15.460+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.391 seconds
[2025-06-20T09:17:46.059+0000] {processor.py:161} INFO - Started process (PID=3105) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:17:46.059+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:17:46.061+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.061+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:17:46.101+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.100+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:17:46.315+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.314+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:17:46.315+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.314+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:17:46.315+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.314+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:17:46.316+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.316+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:17:46.316+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.316+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:17:46.317+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.316+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:17:46.317+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.317+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:17:46.318+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.317+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:17:46.318+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.317+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:17:46.319+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.319+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4_yfr8hs/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:17:46.319+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.319+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp4_yfr8hs/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:17:46.320+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.319+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4_yfr8hs/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:17:46.320+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.320+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0y7tepsl --profiles-dir /tmp/tmp4_yfr8hs --profile weather --target dev`
[2025-06-20T09:17:46.321+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.320+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0y7tepsl --profiles-dir /tmp/tmp4_yfr8hs --profile weather --target dev`
[2025-06-20T09:17:46.321+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.320+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0y7tepsl --profiles-dir /tmp/tmp4_yfr8hs --profile weather --target dev`
[2025-06-20T09:17:46.321+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.321+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:46.322+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:46.321+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:46.322+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:46.321+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:52.160+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:52.159+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0y7tepsl --profiles-dir /tmp/tmp4_yfr8hs --profile weather --target dev`
[2025-06-20T09:17:52.160+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:52.159+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0y7tepsl --profiles-dir /tmp/tmp4_yfr8hs --profile weather --target dev`
[2025-06-20T09:17:52.160+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:52.159+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0y7tepsl --profiles-dir /tmp/tmp4_yfr8hs --profile weather --target dev`
[2025-06-20T09:17:52.161+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:52.161+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:52.161+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:52.161+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:52.161+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:52.161+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:17:59.786+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:17:59.783+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0y7tepsl', '--profiles-dir', '/tmp/tmp4_yfr8hs', '--profile', 'weather', '--target', 'dev'] due to the error:
09:17:56  Running with dbt=1.7.9
09:17:56  Registered adapter: postgres=1.7.9
09:17:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:17:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:17:59.787+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:17:59.783+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0y7tepsl', '--profiles-dir', '/tmp/tmp4_yfr8hs', '--profile', 'weather', '--target', 'dev'] due to the error:
09:17:56  Running with dbt=1.7.9
09:17:56  Registered adapter: postgres=1.7.9
09:17:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:17:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:17:59.787+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:17:59.803+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.747 seconds
[2025-06-20T09:22:35.883+0000] {processor.py:161} INFO - Started process (PID=68) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:22:35.925+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:22:35.932+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:35.932+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:22:36.397+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:36.396+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:22:42.901+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:42.898+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:22:42.913+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:42.898+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:22:42.913+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:42.898+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:22:43.423+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.413+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:22:43.436+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:43.413+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:22:43.440+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.413+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:22:43.447+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.446+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:22:43.451+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:43.446+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:22:43.452+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.446+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:22:43.462+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.460+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpmimhckc_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:22:43.463+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:43.460+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpmimhckc_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:22:43.466+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.460+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpmimhckc_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:22:43.469+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.468+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6j2xx325 --profiles-dir /tmp/tmpmimhckc_ --profile weather --target dev`
[2025-06-20T09:22:43.470+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:43.468+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6j2xx325 --profiles-dir /tmp/tmpmimhckc_ --profile weather --target dev`
[2025-06-20T09:22:43.471+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.468+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6j2xx325 --profiles-dir /tmp/tmpmimhckc_ --profile weather --target dev`
[2025-06-20T09:22:43.473+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.471+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:22:43.476+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:43.471+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:22:43.479+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:43.471+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:22:52.271+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:52.271+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6j2xx325 --profiles-dir /tmp/tmpmimhckc_ --profile weather --target dev`
[2025-06-20T09:22:52.274+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:52.271+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6j2xx325 --profiles-dir /tmp/tmpmimhckc_ --profile weather --target dev`
[2025-06-20T09:22:52.274+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:52.271+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6j2xx325 --profiles-dir /tmp/tmpmimhckc_ --profile weather --target dev`
[2025-06-20T09:22:52.275+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:52.275+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:22:52.276+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:52.275+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:22:52.277+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:52.275+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:22:59.646+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:22:59.633+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6j2xx325', '--profiles-dir', '/tmp/tmpmimhckc_', '--profile', 'weather', '--target', 'dev'] due to the error:
09:22:56  Running with dbt=1.7.9
09:22:57  Registered adapter: postgres=1.7.9
09:22:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:22:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:22:59.647+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:22:59.633+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6j2xx325', '--profiles-dir', '/tmp/tmpmimhckc_', '--profile', 'weather', '--target', 'dev'] due to the error:
09:22:56  Running with dbt=1.7.9
09:22:57  Registered adapter: postgres=1.7.9
09:22:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:22:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:22:59.648+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:22:59.671+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 23.797 seconds
[2025-06-20T09:23:29.928+0000] {processor.py:161} INFO - Started process (PID=110) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:23:29.928+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:23:29.931+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:29.930+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:23:29.979+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:29.979+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:23:30.513+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.513+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:23:30.514+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:30.513+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:23:30.515+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.513+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:23:30.516+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.516+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:23:30.517+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:30.516+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:23:30.517+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.516+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:23:30.518+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.518+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:23:30.519+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:30.518+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:23:30.519+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.518+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:23:30.521+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.521+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpt0dt0sae/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:23:30.522+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:30.521+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpt0dt0sae/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:23:30.522+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.521+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpt0dt0sae/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:23:30.523+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.523+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpb935nsk7 --profiles-dir /tmp/tmpt0dt0sae --profile weather --target dev`
[2025-06-20T09:23:30.524+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:30.523+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpb935nsk7 --profiles-dir /tmp/tmpt0dt0sae --profile weather --target dev`
[2025-06-20T09:23:30.524+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.523+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpb935nsk7 --profiles-dir /tmp/tmpt0dt0sae --profile weather --target dev`
[2025-06-20T09:23:30.525+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.524+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:23:30.526+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:30.524+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:23:30.526+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:30.524+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:23:37.192+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:37.191+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpb935nsk7 --profiles-dir /tmp/tmpt0dt0sae --profile weather --target dev`
[2025-06-20T09:23:37.193+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:37.191+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpb935nsk7 --profiles-dir /tmp/tmpt0dt0sae --profile weather --target dev`
[2025-06-20T09:23:37.193+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:37.191+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpb935nsk7 --profiles-dir /tmp/tmpt0dt0sae --profile weather --target dev`
[2025-06-20T09:23:37.194+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:37.194+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:23:37.195+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:37.194+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:23:37.197+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:37.194+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:23:43.596+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:23:43.594+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpb935nsk7', '--profiles-dir', '/tmp/tmpt0dt0sae', '--profile', 'weather', '--target', 'dev'] due to the error:
09:23:40  Running with dbt=1.7.9
09:23:41  Registered adapter: postgres=1.7.9
09:23:41  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:23:42  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:23:43.596+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:23:43.594+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpb935nsk7', '--profiles-dir', '/tmp/tmpt0dt0sae', '--profile', 'weather', '--target', 'dev'] due to the error:
09:23:40  Running with dbt=1.7.9
09:23:41  Registered adapter: postgres=1.7.9
09:23:41  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:23:42  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:23:43.597+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:23:43.611+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.693 seconds
[2025-06-20T09:24:13.752+0000] {processor.py:161} INFO - Started process (PID=163) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:24:13.754+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:24:13.764+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:13.764+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:24:13.999+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:13.999+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:24:15.293+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.292+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:24:15.293+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:15.292+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:24:15.294+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.292+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:24:15.295+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.295+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:24:15.296+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:15.295+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:24:15.296+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.295+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:24:15.297+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.297+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:24:15.298+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:15.297+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:24:15.298+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.297+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:24:15.300+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.300+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp71cdt_el/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:24:15.301+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:15.300+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp71cdt_el/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:24:15.301+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.300+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp71cdt_el/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:24:15.302+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.302+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3crnmqs0 --profiles-dir /tmp/tmp71cdt_el --profile weather --target dev`
[2025-06-20T09:24:15.302+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:15.302+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3crnmqs0 --profiles-dir /tmp/tmp71cdt_el --profile weather --target dev`
[2025-06-20T09:24:15.303+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.302+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3crnmqs0 --profiles-dir /tmp/tmp71cdt_el --profile weather --target dev`
[2025-06-20T09:24:15.304+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.303+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:15.304+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:15.303+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:15.305+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:15.303+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:20.632+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:20.632+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3crnmqs0 --profiles-dir /tmp/tmp71cdt_el --profile weather --target dev`
[2025-06-20T09:24:20.633+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:20.632+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3crnmqs0 --profiles-dir /tmp/tmp71cdt_el --profile weather --target dev`
[2025-06-20T09:24:20.633+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:20.632+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3crnmqs0 --profiles-dir /tmp/tmp71cdt_el --profile weather --target dev`
[2025-06-20T09:24:20.634+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:20.633+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:20.634+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:20.633+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:20.634+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:20.633+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:26.574+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:26.572+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3crnmqs0', '--profiles-dir', '/tmp/tmp71cdt_el', '--profile', 'weather', '--target', 'dev'] due to the error:
09:24:23  Running with dbt=1.7.9
09:24:24  Registered adapter: postgres=1.7.9
09:24:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:24:25  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:24:26.574+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:26.572+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3crnmqs0', '--profiles-dir', '/tmp/tmp71cdt_el', '--profile', 'weather', '--target', 'dev'] due to the error:
09:24:23  Running with dbt=1.7.9
09:24:24  Registered adapter: postgres=1.7.9
09:24:24  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:24:25  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:24:26.574+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:24:26.593+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.866 seconds
[2025-06-20T09:24:57.361+0000] {processor.py:161} INFO - Started process (PID=204) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:24:57.363+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:24:57.366+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.365+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:24:57.430+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.430+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:24:57.958+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.957+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:24:57.958+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.957+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:24:57.959+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.957+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:24:57.960+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.959+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:24:57.960+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.959+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:24:57.960+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.959+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:24:57.961+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.961+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:24:57.962+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.961+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:24:57.962+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.961+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:24:57.964+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.964+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp69yth897/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:24:57.964+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.964+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp69yth897/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:24:57.964+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.964+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp69yth897/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:24:57.965+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.965+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzg6cmmig --profiles-dir /tmp/tmp69yth897 --profile weather --target dev`
[2025-06-20T09:24:57.966+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.965+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzg6cmmig --profiles-dir /tmp/tmp69yth897 --profile weather --target dev`
[2025-06-20T09:24:57.966+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.965+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzg6cmmig --profiles-dir /tmp/tmp69yth897 --profile weather --target dev`
[2025-06-20T09:24:57.967+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.966+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:57.967+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:24:57.966+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:24:57.967+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:24:57.966+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:02.626+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:02.625+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzg6cmmig --profiles-dir /tmp/tmp69yth897 --profile weather --target dev`
[2025-06-20T09:25:02.626+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:02.625+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzg6cmmig --profiles-dir /tmp/tmp69yth897 --profile weather --target dev`
[2025-06-20T09:25:02.626+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:02.625+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzg6cmmig --profiles-dir /tmp/tmp69yth897 --profile weather --target dev`
[2025-06-20T09:25:02.627+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:02.626+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:02.627+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:02.626+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:02.627+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:02.626+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:10.857+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:10.855+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzg6cmmig', '--profiles-dir', '/tmp/tmp69yth897', '--profile', 'weather', '--target', 'dev'] due to the error:
09:25:06  Running with dbt=1.7.9
09:25:07  Registered adapter: postgres=1.7.9
09:25:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:25:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:25:10.858+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:10.855+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzg6cmmig', '--profiles-dir', '/tmp/tmp69yth897', '--profile', 'weather', '--target', 'dev'] due to the error:
09:25:06  Running with dbt=1.7.9
09:25:07  Registered adapter: postgres=1.7.9
09:25:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:25:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:25:10.859+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:25:10.878+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.523 seconds
[2025-06-20T09:25:41.252+0000] {processor.py:161} INFO - Started process (PID=252) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:25:41.253+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:25:41.255+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.254+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:25:41.299+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.298+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:25:41.636+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.635+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:25:41.636+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.635+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:25:41.636+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.635+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:25:41.637+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.637+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:25:41.637+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.637+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:25:41.637+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.637+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:25:41.638+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.638+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:25:41.638+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.638+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:25:41.639+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.638+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:25:41.640+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.640+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpevtkao5a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:25:41.640+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.640+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpevtkao5a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:25:41.640+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.640+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpevtkao5a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:25:41.641+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.641+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxnsf6sf3 --profiles-dir /tmp/tmpevtkao5a --profile weather --target dev`
[2025-06-20T09:25:41.641+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.641+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxnsf6sf3 --profiles-dir /tmp/tmpevtkao5a --profile weather --target dev`
[2025-06-20T09:25:41.641+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.641+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxnsf6sf3 --profiles-dir /tmp/tmpevtkao5a --profile weather --target dev`
[2025-06-20T09:25:41.642+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.642+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:41.642+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:41.642+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:41.643+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:41.642+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:45.912+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:45.911+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxnsf6sf3 --profiles-dir /tmp/tmpevtkao5a --profile weather --target dev`
[2025-06-20T09:25:45.914+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:45.911+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxnsf6sf3 --profiles-dir /tmp/tmpevtkao5a --profile weather --target dev`
[2025-06-20T09:25:45.917+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:45.911+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxnsf6sf3 --profiles-dir /tmp/tmpevtkao5a --profile weather --target dev`
[2025-06-20T09:25:45.917+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:45.917+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:45.918+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:45.917+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:45.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:45.917+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:25:55.643+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:25:55.641+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxnsf6sf3', '--profiles-dir', '/tmp/tmpevtkao5a', '--profile', 'weather', '--target', 'dev'] due to the error:
09:25:50  Running with dbt=1.7.9
09:25:52  Registered adapter: postgres=1.7.9
09:25:52  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:25:54  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:25:55.643+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:25:55.641+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxnsf6sf3', '--profiles-dir', '/tmp/tmpevtkao5a', '--profile', 'weather', '--target', 'dev'] due to the error:
09:25:50  Running with dbt=1.7.9
09:25:52  Registered adapter: postgres=1.7.9
09:25:52  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:25:54  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:25:55.644+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:25:55.658+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.408 seconds
[2025-06-20T09:26:26.181+0000] {processor.py:161} INFO - Started process (PID=292) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:26:26.181+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:26:26.183+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.183+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:26:26.224+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.223+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:26:26.562+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.562+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:26:26.562+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.562+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:26:26.563+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.562+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:26:26.564+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.563+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:26:26.564+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.563+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:26:26.564+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.563+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:26:26.565+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.564+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:26:26.565+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.564+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:26:26.565+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.564+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:26:26.567+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.566+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7fp7r86z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:26:26.567+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.566+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp7fp7r86z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:26:26.567+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.566+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7fp7r86z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:26:26.568+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.568+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpma2q5fv5 --profiles-dir /tmp/tmp7fp7r86z --profile weather --target dev`
[2025-06-20T09:26:26.568+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.568+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpma2q5fv5 --profiles-dir /tmp/tmp7fp7r86z --profile weather --target dev`
[2025-06-20T09:26:26.568+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.568+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpma2q5fv5 --profiles-dir /tmp/tmp7fp7r86z --profile weather --target dev`
[2025-06-20T09:26:26.569+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.568+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:26:26.569+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:26.568+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:26:26.569+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:26.568+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:26:30.820+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:30.817+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpma2q5fv5 --profiles-dir /tmp/tmp7fp7r86z --profile weather --target dev`
[2025-06-20T09:26:30.822+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:30.817+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpma2q5fv5 --profiles-dir /tmp/tmp7fp7r86z --profile weather --target dev`
[2025-06-20T09:26:30.824+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:30.817+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpma2q5fv5 --profiles-dir /tmp/tmp7fp7r86z --profile weather --target dev`
[2025-06-20T09:26:30.825+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:30.825+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:26:30.827+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:30.825+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:26:30.829+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:30.825+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:26:37.868+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:26:37.867+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpma2q5fv5', '--profiles-dir', '/tmp/tmp7fp7r86z', '--profile', 'weather', '--target', 'dev'] due to the error:
09:26:34  Running with dbt=1.7.9
09:26:35  Registered adapter: postgres=1.7.9
09:26:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:26:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:26:37.869+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:26:37.867+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpma2q5fv5', '--profiles-dir', '/tmp/tmp7fp7r86z', '--profile', 'weather', '--target', 'dev'] due to the error:
09:26:34  Running with dbt=1.7.9
09:26:35  Registered adapter: postgres=1.7.9
09:26:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:26:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:26:37.869+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:26:37.883+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.705 seconds
[2025-06-20T09:27:08.606+0000] {processor.py:161} INFO - Started process (PID=332) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:27:08.607+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:27:08.608+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:08.608+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:27:08.670+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:08.669+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:27:09.019+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.019+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:27:09.020+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:09.019+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:27:09.020+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.019+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:27:09.021+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.020+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:27:09.021+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:09.020+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:27:09.021+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.020+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:27:09.022+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.022+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:27:09.022+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:09.022+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:27:09.022+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.022+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:27:09.024+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.024+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpmio77frd/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:27:09.024+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:09.024+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpmio77frd/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:27:09.024+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.024+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpmio77frd/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:27:09.025+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.025+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpneionp4i --profiles-dir /tmp/tmpmio77frd --profile weather --target dev`
[2025-06-20T09:27:09.025+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:09.025+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpneionp4i --profiles-dir /tmp/tmpmio77frd --profile weather --target dev`
[2025-06-20T09:27:09.025+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.025+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpneionp4i --profiles-dir /tmp/tmpmio77frd --profile weather --target dev`
[2025-06-20T09:27:09.026+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.026+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:09.026+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:09.026+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:09.027+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:09.026+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:14.775+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:14.774+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpneionp4i --profiles-dir /tmp/tmpmio77frd --profile weather --target dev`
[2025-06-20T09:27:14.775+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:14.774+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpneionp4i --profiles-dir /tmp/tmpmio77frd --profile weather --target dev`
[2025-06-20T09:27:14.775+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:14.774+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpneionp4i --profiles-dir /tmp/tmpmio77frd --profile weather --target dev`
[2025-06-20T09:27:14.776+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:14.775+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:14.776+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:14.775+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:14.776+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:14.775+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:20.604+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:20.602+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpneionp4i', '--profiles-dir', '/tmp/tmpmio77frd', '--profile', 'weather', '--target', 'dev'] due to the error:
09:27:17  Running with dbt=1.7.9
09:27:18  Registered adapter: postgres=1.7.9
09:27:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:27:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:27:20.605+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:20.602+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpneionp4i', '--profiles-dir', '/tmp/tmpmio77frd', '--profile', 'weather', '--target', 'dev'] due to the error:
09:27:17  Running with dbt=1.7.9
09:27:18  Registered adapter: postgres=1.7.9
09:27:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:27:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:27:20.606+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:27:20.625+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.022 seconds
[2025-06-20T09:27:51.217+0000] {processor.py:161} INFO - Started process (PID=385) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:27:51.219+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:27:51.222+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.222+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:27:51.287+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.287+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:27:51.847+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.846+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:27:51.848+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.846+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:27:51.848+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.846+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:27:51.849+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.849+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:27:51.850+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.849+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:27:51.850+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.849+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:27:51.851+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.851+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:27:51.852+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.851+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:27:51.852+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.851+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:27:51.855+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.854+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmploinhlnh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:27:51.855+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.854+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmploinhlnh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:27:51.856+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.854+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmploinhlnh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:27:51.857+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.856+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp47k7q2sm --profiles-dir /tmp/tmploinhlnh --profile weather --target dev`
[2025-06-20T09:27:51.857+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.856+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp47k7q2sm --profiles-dir /tmp/tmploinhlnh --profile weather --target dev`
[2025-06-20T09:27:51.858+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.856+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp47k7q2sm --profiles-dir /tmp/tmploinhlnh --profile weather --target dev`
[2025-06-20T09:27:51.859+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.858+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:51.859+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:51.858+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:51.860+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:51.858+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:58.189+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:58.189+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp47k7q2sm --profiles-dir /tmp/tmploinhlnh --profile weather --target dev`
[2025-06-20T09:27:58.189+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:58.189+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp47k7q2sm --profiles-dir /tmp/tmploinhlnh --profile weather --target dev`
[2025-06-20T09:27:58.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:58.189+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp47k7q2sm --profiles-dir /tmp/tmploinhlnh --profile weather --target dev`
[2025-06-20T09:27:58.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:58.190+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:58.190+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:27:58.190+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:27:58.191+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:27:58.190+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:28:06.036+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:06.034+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp47k7q2sm', '--profiles-dir', '/tmp/tmploinhlnh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:28:02  Running with dbt=1.7.9
09:28:02  Registered adapter: postgres=1.7.9
09:28:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:28:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:28:06.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:06.034+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp47k7q2sm', '--profiles-dir', '/tmp/tmploinhlnh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:28:02  Running with dbt=1.7.9
09:28:02  Registered adapter: postgres=1.7.9
09:28:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:28:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:28:06.037+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:28:06.057+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.848 seconds
[2025-06-20T09:28:36.161+0000] {processor.py:161} INFO - Started process (PID=428) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:28:36.162+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:28:36.164+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.164+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:28:36.205+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.205+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:28:36.534+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.533+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:28:36.534+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.533+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:28:36.534+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.533+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:28:36.535+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.535+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:28:36.535+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.535+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:28:36.536+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.535+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:28:36.536+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.536+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:28:36.537+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.536+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:28:36.537+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.536+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:28:36.538+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.538+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptzku1wmj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:28:36.538+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.538+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmptzku1wmj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:28:36.539+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.538+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptzku1wmj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:28:36.539+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.539+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl5xhqtk1 --profiles-dir /tmp/tmptzku1wmj --profile weather --target dev`
[2025-06-20T09:28:36.540+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.539+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl5xhqtk1 --profiles-dir /tmp/tmptzku1wmj --profile weather --target dev`
[2025-06-20T09:28:36.540+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.539+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl5xhqtk1 --profiles-dir /tmp/tmptzku1wmj --profile weather --target dev`
[2025-06-20T09:28:36.540+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.540+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:28:36.541+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:36.540+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:28:36.541+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:36.540+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:28:40.981+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:40.981+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl5xhqtk1 --profiles-dir /tmp/tmptzku1wmj --profile weather --target dev`
[2025-06-20T09:28:40.982+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:40.981+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl5xhqtk1 --profiles-dir /tmp/tmptzku1wmj --profile weather --target dev`
[2025-06-20T09:28:40.982+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:40.981+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl5xhqtk1 --profiles-dir /tmp/tmptzku1wmj --profile weather --target dev`
[2025-06-20T09:28:40.982+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:40.982+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:28:40.983+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:40.982+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:28:40.983+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:40.982+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:28:48.661+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:28:48.659+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl5xhqtk1', '--profiles-dir', '/tmp/tmptzku1wmj', '--profile', 'weather', '--target', 'dev'] due to the error:
09:28:45  Running with dbt=1.7.9
09:28:45  Registered adapter: postgres=1.7.9
09:28:45  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:28:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:28:48.661+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:28:48.659+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl5xhqtk1', '--profiles-dir', '/tmp/tmptzku1wmj', '--profile', 'weather', '--target', 'dev'] due to the error:
09:28:45  Running with dbt=1.7.9
09:28:45  Registered adapter: postgres=1.7.9
09:28:45  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:28:47  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:28:48.662+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:28:48.676+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.518 seconds
[2025-06-20T09:29:18.976+0000] {processor.py:161} INFO - Started process (PID=473) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:29:18.976+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:29:18.978+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:18.978+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:29:19.020+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:19.020+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:29:19.362+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.362+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:29:19.362+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:19.362+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:29:19.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.362+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:29:19.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.363+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:29:19.364+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:19.363+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:29:19.364+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.363+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:29:19.365+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.364+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:29:19.365+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:19.364+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:29:19.365+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.364+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:29:19.367+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.366+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpr2ytiu_a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:29:19.367+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:19.366+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpr2ytiu_a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:29:19.367+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.366+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpr2ytiu_a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:29:19.368+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.367+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpin0j8e_8 --profiles-dir /tmp/tmpr2ytiu_a --profile weather --target dev`
[2025-06-20T09:29:19.368+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:19.367+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpin0j8e_8 --profiles-dir /tmp/tmpr2ytiu_a --profile weather --target dev`
[2025-06-20T09:29:19.368+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.367+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpin0j8e_8 --profiles-dir /tmp/tmpr2ytiu_a --profile weather --target dev`
[2025-06-20T09:29:19.369+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.368+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:29:19.369+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:19.368+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:29:19.369+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:19.368+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:29:23.876+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:23.875+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpin0j8e_8 --profiles-dir /tmp/tmpr2ytiu_a --profile weather --target dev`
[2025-06-20T09:29:23.877+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:23.875+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpin0j8e_8 --profiles-dir /tmp/tmpr2ytiu_a --profile weather --target dev`
[2025-06-20T09:29:23.877+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:23.875+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpin0j8e_8 --profiles-dir /tmp/tmpr2ytiu_a --profile weather --target dev`
[2025-06-20T09:29:23.878+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:23.878+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:29:23.879+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:23.878+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:29:23.879+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:23.878+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:29:30.473+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:29:30.472+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpin0j8e_8', '--profiles-dir', '/tmp/tmpr2ytiu_a', '--profile', 'weather', '--target', 'dev'] due to the error:
09:29:27  Running with dbt=1.7.9
09:29:27  Registered adapter: postgres=1.7.9
09:29:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:29:29  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:29:30.474+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:29:30.472+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpin0j8e_8', '--profiles-dir', '/tmp/tmpr2ytiu_a', '--profile', 'weather', '--target', 'dev'] due to the error:
09:29:27  Running with dbt=1.7.9
09:29:27  Registered adapter: postgres=1.7.9
09:29:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:29:29  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:29:30.474+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:29:30.488+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.516 seconds
[2025-06-20T09:30:01.179+0000] {processor.py:161} INFO - Started process (PID=514) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:30:01.181+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:30:01.184+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.183+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:30:01.255+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.255+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:30:01.632+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.631+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:30:01.632+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.631+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:30:01.632+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.631+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:30:01.633+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.633+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:30:01.633+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.633+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:30:01.634+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.633+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:30:01.634+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.634+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:30:01.635+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.634+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:30:01.635+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.634+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:30:01.636+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.636+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdnxp3c9r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:30:01.636+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.636+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpdnxp3c9r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:30:01.637+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.636+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdnxp3c9r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:30:01.637+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.637+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4q7w6acl --profiles-dir /tmp/tmpdnxp3c9r --profile weather --target dev`
[2025-06-20T09:30:01.638+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.637+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4q7w6acl --profiles-dir /tmp/tmpdnxp3c9r --profile weather --target dev`
[2025-06-20T09:30:01.638+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.637+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4q7w6acl --profiles-dir /tmp/tmpdnxp3c9r --profile weather --target dev`
[2025-06-20T09:30:01.639+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.638+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:01.639+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:01.638+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:01.639+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:01.638+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:06.438+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:06.437+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4q7w6acl --profiles-dir /tmp/tmpdnxp3c9r --profile weather --target dev`
[2025-06-20T09:30:06.443+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:06.437+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4q7w6acl --profiles-dir /tmp/tmpdnxp3c9r --profile weather --target dev`
[2025-06-20T09:30:06.444+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:06.437+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4q7w6acl --profiles-dir /tmp/tmpdnxp3c9r --profile weather --target dev`
[2025-06-20T09:30:06.446+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:06.446+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:06.448+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:06.446+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:06.448+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:06.446+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:13.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:13.610+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4q7w6acl', '--profiles-dir', '/tmp/tmpdnxp3c9r', '--profile', 'weather', '--target', 'dev'] due to the error:
09:30:09  Running with dbt=1.7.9
09:30:10  Registered adapter: postgres=1.7.9
09:30:10  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:30:11  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:30:13.622+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:13.610+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4q7w6acl', '--profiles-dir', '/tmp/tmpdnxp3c9r', '--profile', 'weather', '--target', 'dev'] due to the error:
09:30:09  Running with dbt=1.7.9
09:30:10  Registered adapter: postgres=1.7.9
09:30:10  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:30:11  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:30:13.625+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:30:13.681+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.506 seconds
[2025-06-20T09:30:44.779+0000] {processor.py:161} INFO - Started process (PID=564) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:30:44.780+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:30:44.783+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:44.782+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:30:44.844+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:44.844+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:30:45.389+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.388+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:30:45.390+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:45.388+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:30:45.391+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.388+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:30:45.392+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.391+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:30:45.392+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:45.391+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:30:45.393+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.391+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:30:45.394+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.393+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:30:45.394+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:45.393+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:30:45.395+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.393+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:30:45.397+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.397+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp5_uyd6_g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:30:45.397+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:45.397+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp5_uyd6_g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:30:45.398+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.397+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp5_uyd6_g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:30:45.399+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.399+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplnyy0hew --profiles-dir /tmp/tmp5_uyd6_g --profile weather --target dev`
[2025-06-20T09:30:45.399+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:45.399+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplnyy0hew --profiles-dir /tmp/tmp5_uyd6_g --profile weather --target dev`
[2025-06-20T09:30:45.400+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.399+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplnyy0hew --profiles-dir /tmp/tmp5_uyd6_g --profile weather --target dev`
[2025-06-20T09:30:45.401+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.400+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:45.401+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:45.400+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:45.402+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:45.400+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:53.499+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:53.499+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplnyy0hew --profiles-dir /tmp/tmp5_uyd6_g --profile weather --target dev`
[2025-06-20T09:30:53.500+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:53.499+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplnyy0hew --profiles-dir /tmp/tmp5_uyd6_g --profile weather --target dev`
[2025-06-20T09:30:53.500+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:53.499+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplnyy0hew --profiles-dir /tmp/tmp5_uyd6_g --profile weather --target dev`
[2025-06-20T09:30:53.500+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:53.500+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:53.501+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:30:53.500+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:30:53.501+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:30:53.500+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:31:00.673+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:00.672+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmplnyy0hew', '--profiles-dir', '/tmp/tmp5_uyd6_g', '--profile', 'weather', '--target', 'dev'] due to the error:
09:30:56  Running with dbt=1.7.9
09:30:57  Registered adapter: postgres=1.7.9
09:30:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:30:59  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:31:00.674+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:00.672+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmplnyy0hew', '--profiles-dir', '/tmp/tmp5_uyd6_g', '--profile', 'weather', '--target', 'dev'] due to the error:
09:30:56  Running with dbt=1.7.9
09:30:57  Registered adapter: postgres=1.7.9
09:30:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:30:59  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:31:00.674+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:31:00.689+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.913 seconds
[2025-06-20T09:31:31.136+0000] {processor.py:161} INFO - Started process (PID=610) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:31:31.136+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:31:31.139+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.139+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:31:31.210+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.208+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:31:31.575+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.575+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:31:31.575+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.575+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:31:31.576+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.575+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:31:31.576+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.576+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:31:31.577+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.576+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:31:31.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.576+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:31:31.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.577+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:31:31.578+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.577+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:31:31.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.577+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:31:31.579+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.579+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjsz6ay6a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:31:31.580+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.579+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpjsz6ay6a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:31:31.580+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.579+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpjsz6ay6a/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:31:31.581+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.580+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmae6njw9 --profiles-dir /tmp/tmpjsz6ay6a --profile weather --target dev`
[2025-06-20T09:31:31.581+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.580+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmae6njw9 --profiles-dir /tmp/tmpjsz6ay6a --profile weather --target dev`
[2025-06-20T09:31:31.581+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.580+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmae6njw9 --profiles-dir /tmp/tmpjsz6ay6a --profile weather --target dev`
[2025-06-20T09:31:31.582+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.581+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:31:31.582+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:31.581+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:31:31.582+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:31.581+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:31:35.853+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:35.852+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmae6njw9 --profiles-dir /tmp/tmpjsz6ay6a --profile weather --target dev`
[2025-06-20T09:31:35.853+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:35.852+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmae6njw9 --profiles-dir /tmp/tmpjsz6ay6a --profile weather --target dev`
[2025-06-20T09:31:35.854+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:35.852+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmae6njw9 --profiles-dir /tmp/tmpjsz6ay6a --profile weather --target dev`
[2025-06-20T09:31:35.854+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:35.854+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:31:35.854+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:35.854+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:31:35.855+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:35.854+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:31:43.240+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:31:43.238+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmae6njw9', '--profiles-dir', '/tmp/tmpjsz6ay6a', '--profile', 'weather', '--target', 'dev'] due to the error:
09:31:39  Running with dbt=1.7.9
09:31:40  Registered adapter: postgres=1.7.9
09:31:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:31:42  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:31:43.240+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:31:43.238+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmae6njw9', '--profiles-dir', '/tmp/tmpjsz6ay6a', '--profile', 'weather', '--target', 'dev'] due to the error:
09:31:39  Running with dbt=1.7.9
09:31:40  Registered adapter: postgres=1.7.9
09:31:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:31:42  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:31:43.241+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:31:43.256+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.123 seconds
[2025-06-20T09:32:13.534+0000] {processor.py:161} INFO - Started process (PID=650) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:32:13.535+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:32:13.537+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.536+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:32:13.579+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.578+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:32:13.915+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.915+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:32:13.916+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.915+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:32:13.916+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.915+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:32:13.917+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.916+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:32:13.917+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.916+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:32:13.917+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.916+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:32:13.918+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.918+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:32:13.918+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.918+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:32:13.918+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.918+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:32:13.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.920+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpddl_2slp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:32:13.920+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.920+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpddl_2slp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:32:13.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.920+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpddl_2slp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:32:13.921+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.921+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3gprc3x1 --profiles-dir /tmp/tmpddl_2slp --profile weather --target dev`
[2025-06-20T09:32:13.921+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.921+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3gprc3x1 --profiles-dir /tmp/tmpddl_2slp --profile weather --target dev`
[2025-06-20T09:32:13.921+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.921+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3gprc3x1 --profiles-dir /tmp/tmpddl_2slp --profile weather --target dev`
[2025-06-20T09:32:13.922+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.921+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:13.922+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:13.921+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:13.922+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:13.921+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:18.848+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:18.847+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3gprc3x1 --profiles-dir /tmp/tmpddl_2slp --profile weather --target dev`
[2025-06-20T09:32:18.849+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:18.847+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3gprc3x1 --profiles-dir /tmp/tmpddl_2slp --profile weather --target dev`
[2025-06-20T09:32:18.849+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:18.847+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3gprc3x1 --profiles-dir /tmp/tmpddl_2slp --profile weather --target dev`
[2025-06-20T09:32:18.850+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:18.850+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:18.850+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:18.850+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:18.851+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:18.850+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:25.066+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:25.064+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3gprc3x1', '--profiles-dir', '/tmp/tmpddl_2slp', '--profile', 'weather', '--target', 'dev'] due to the error:
09:32:22  Running with dbt=1.7.9
09:32:22  Registered adapter: postgres=1.7.9
09:32:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:32:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:32:25.066+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:25.064+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3gprc3x1', '--profiles-dir', '/tmp/tmpddl_2slp', '--profile', 'weather', '--target', 'dev'] due to the error:
09:32:22  Running with dbt=1.7.9
09:32:22  Registered adapter: postgres=1.7.9
09:32:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:32:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:32:25.066+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:32:25.081+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.549 seconds
[2025-06-20T09:32:55.598+0000] {processor.py:161} INFO - Started process (PID=695) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:32:55.598+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:32:55.600+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:55.600+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:32:55.648+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:55.647+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:32:56.005+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.005+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:32:56.006+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:56.005+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:32:56.006+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.005+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:32:56.007+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.007+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:32:56.007+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:56.007+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:32:56.007+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.007+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:32:56.008+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.008+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:32:56.008+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:56.008+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:32:56.009+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.008+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:32:56.010+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.010+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfk722oqx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:32:56.010+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:56.010+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpfk722oqx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:32:56.010+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.010+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfk722oqx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:32:56.011+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.011+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy4_tr5rm --profiles-dir /tmp/tmpfk722oqx --profile weather --target dev`
[2025-06-20T09:32:56.011+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:56.011+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy4_tr5rm --profiles-dir /tmp/tmpfk722oqx --profile weather --target dev`
[2025-06-20T09:32:56.011+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.011+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy4_tr5rm --profiles-dir /tmp/tmpfk722oqx --profile weather --target dev`
[2025-06-20T09:32:56.012+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.011+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:56.012+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:32:56.011+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:32:56.012+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:32:56.011+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:03.850+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:03.849+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy4_tr5rm --profiles-dir /tmp/tmpfk722oqx --profile weather --target dev`
[2025-06-20T09:33:03.850+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:03.849+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy4_tr5rm --profiles-dir /tmp/tmpfk722oqx --profile weather --target dev`
[2025-06-20T09:33:03.851+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:03.849+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy4_tr5rm --profiles-dir /tmp/tmpfk722oqx --profile weather --target dev`
[2025-06-20T09:33:03.851+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:03.851+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:03.851+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:03.851+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:03.852+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:03.851+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:11.278+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:11.276+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpy4_tr5rm', '--profiles-dir', '/tmp/tmpfk722oqx', '--profile', 'weather', '--target', 'dev'] due to the error:
09:33:07  Running with dbt=1.7.9
09:33:08  Registered adapter: postgres=1.7.9
09:33:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:33:10  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:33:11.279+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:11.276+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpy4_tr5rm', '--profiles-dir', '/tmp/tmpfk722oqx', '--profile', 'weather', '--target', 'dev'] due to the error:
09:33:07  Running with dbt=1.7.9
09:33:08  Registered adapter: postgres=1.7.9
09:33:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:33:10  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:33:11.279+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:33:11.301+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.706 seconds
[2025-06-20T09:33:41.707+0000] {processor.py:161} INFO - Started process (PID=746) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:33:41.707+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:33:41.710+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:41.710+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:33:41.770+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:41.770+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:33:42.256+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.256+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:33:42.257+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:42.256+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:33:42.257+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.256+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:33:42.259+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.258+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:33:42.259+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:42.258+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:33:42.260+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.258+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:33:42.261+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.260+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:33:42.261+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:42.260+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:33:42.262+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.260+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:33:42.264+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.264+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmphijbpoao/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:33:42.264+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:42.264+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmphijbpoao/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:33:42.265+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.264+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmphijbpoao/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:33:42.266+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.266+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpv9xohnqb --profiles-dir /tmp/tmphijbpoao --profile weather --target dev`
[2025-06-20T09:33:42.266+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:42.266+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpv9xohnqb --profiles-dir /tmp/tmphijbpoao --profile weather --target dev`
[2025-06-20T09:33:42.267+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.266+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpv9xohnqb --profiles-dir /tmp/tmphijbpoao --profile weather --target dev`
[2025-06-20T09:33:42.268+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.267+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:42.268+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:42.267+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:42.269+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:42.267+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:47.577+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:47.576+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpv9xohnqb --profiles-dir /tmp/tmphijbpoao --profile weather --target dev`
[2025-06-20T09:33:47.577+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:47.576+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpv9xohnqb --profiles-dir /tmp/tmphijbpoao --profile weather --target dev`
[2025-06-20T09:33:47.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:47.576+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpv9xohnqb --profiles-dir /tmp/tmphijbpoao --profile weather --target dev`
[2025-06-20T09:33:47.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:47.578+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:47.578+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:47.578+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:47.579+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:47.578+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:33:54.742+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:33:54.740+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpv9xohnqb', '--profiles-dir', '/tmp/tmphijbpoao', '--profile', 'weather', '--target', 'dev'] due to the error:
09:33:50  Running with dbt=1.7.9
09:33:51  Registered adapter: postgres=1.7.9
09:33:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:33:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:33:54.743+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:33:54.740+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpv9xohnqb', '--profiles-dir', '/tmp/tmphijbpoao', '--profile', 'weather', '--target', 'dev'] due to the error:
09:33:50  Running with dbt=1.7.9
09:33:51  Registered adapter: postgres=1.7.9
09:33:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:33:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:33:54.744+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:33:54.764+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.061 seconds
[2025-06-20T09:34:25.365+0000] {processor.py:161} INFO - Started process (PID=791) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:34:25.366+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:34:25.368+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.368+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:34:25.408+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.408+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:34:25.732+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.731+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:34:25.732+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.731+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:34:25.732+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.731+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:34:25.733+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.733+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:34:25.733+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.733+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:34:25.734+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.733+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:34:25.734+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.734+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:34:25.735+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.734+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:34:25.735+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.734+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:34:25.736+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.736+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp65xvxkyu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:34:25.736+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.736+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp65xvxkyu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:34:25.737+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.736+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp65xvxkyu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:34:25.737+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.737+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoo8ejp2m --profiles-dir /tmp/tmp65xvxkyu --profile weather --target dev`
[2025-06-20T09:34:25.737+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.737+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoo8ejp2m --profiles-dir /tmp/tmp65xvxkyu --profile weather --target dev`
[2025-06-20T09:34:25.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.737+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoo8ejp2m --profiles-dir /tmp/tmp65xvxkyu --profile weather --target dev`
[2025-06-20T09:34:25.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.738+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:34:25.738+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:25.738+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:34:25.739+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:25.738+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:34:29.854+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:29.853+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoo8ejp2m --profiles-dir /tmp/tmp65xvxkyu --profile weather --target dev`
[2025-06-20T09:34:29.854+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:29.853+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoo8ejp2m --profiles-dir /tmp/tmp65xvxkyu --profile weather --target dev`
[2025-06-20T09:34:29.855+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:29.853+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoo8ejp2m --profiles-dir /tmp/tmp65xvxkyu --profile weather --target dev`
[2025-06-20T09:34:29.855+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:29.855+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:34:29.855+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:29.855+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:34:29.856+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:29.855+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:34:37.231+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:34:37.230+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpoo8ejp2m', '--profiles-dir', '/tmp/tmp65xvxkyu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:34:33  Running with dbt=1.7.9
09:34:33  Registered adapter: postgres=1.7.9
09:34:33  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:34:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:34:37.232+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:34:37.230+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpoo8ejp2m', '--profiles-dir', '/tmp/tmp65xvxkyu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:34:33  Running with dbt=1.7.9
09:34:33  Registered adapter: postgres=1.7.9
09:34:33  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:34:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:34:37.232+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:34:37.247+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.885 seconds
[2025-06-20T09:35:08.087+0000] {processor.py:161} INFO - Started process (PID=832) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:35:08.088+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:35:08.090+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.090+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:35:08.136+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.136+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:35:08.715+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.715+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:35:08.715+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.715+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:35:08.716+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.715+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:35:08.716+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.716+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:35:08.717+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.716+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:35:08.717+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.716+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:35:08.718+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.717+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:35:08.718+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.717+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:35:08.718+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.717+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:35:08.719+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.719+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpv9v2ytop/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:35:08.720+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.719+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpv9v2ytop/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:35:08.720+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.719+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpv9v2ytop/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:35:08.721+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.720+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgxeef9os --profiles-dir /tmp/tmpv9v2ytop --profile weather --target dev`
[2025-06-20T09:35:08.721+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.720+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgxeef9os --profiles-dir /tmp/tmpv9v2ytop --profile weather --target dev`
[2025-06-20T09:35:08.721+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.720+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgxeef9os --profiles-dir /tmp/tmpv9v2ytop --profile weather --target dev`
[2025-06-20T09:35:08.722+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.721+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:08.722+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:08.721+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:08.722+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:08.721+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:14.279+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:14.278+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgxeef9os --profiles-dir /tmp/tmpv9v2ytop --profile weather --target dev`
[2025-06-20T09:35:14.282+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:14.278+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgxeef9os --profiles-dir /tmp/tmpv9v2ytop --profile weather --target dev`
[2025-06-20T09:35:14.282+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:14.278+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgxeef9os --profiles-dir /tmp/tmpv9v2ytop --profile weather --target dev`
[2025-06-20T09:35:14.283+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:14.282+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:14.284+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:14.282+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:14.285+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:14.282+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:21.420+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:21.418+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgxeef9os', '--profiles-dir', '/tmp/tmpv9v2ytop', '--profile', 'weather', '--target', 'dev'] due to the error:
09:35:18  Running with dbt=1.7.9
09:35:18  Registered adapter: postgres=1.7.9
09:35:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:35:20  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:35:21.421+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:21.418+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgxeef9os', '--profiles-dir', '/tmp/tmpv9v2ytop', '--profile', 'weather', '--target', 'dev'] due to the error:
09:35:18  Running with dbt=1.7.9
09:35:18  Registered adapter: postgres=1.7.9
09:35:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:35:20  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:35:21.422+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:35:21.442+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.358 seconds
[2025-06-20T09:35:51.609+0000] {processor.py:161} INFO - Started process (PID=875) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:35:51.610+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:35:51.613+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:51.612+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:35:51.720+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:51.720+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:35:52.141+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.141+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:35:52.142+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:52.141+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:35:52.142+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.141+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:35:52.144+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.143+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:35:52.144+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:52.143+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:35:52.145+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.143+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:35:52.146+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.145+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:35:52.146+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:52.145+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:35:52.147+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.145+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:35:52.149+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.148+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6nw26ohr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:35:52.149+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:52.148+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp6nw26ohr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:35:52.150+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.148+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6nw26ohr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:35:52.151+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.150+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9sj3g0gh --profiles-dir /tmp/tmp6nw26ohr --profile weather --target dev`
[2025-06-20T09:35:52.151+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:52.150+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9sj3g0gh --profiles-dir /tmp/tmp6nw26ohr --profile weather --target dev`
[2025-06-20T09:35:52.152+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.150+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9sj3g0gh --profiles-dir /tmp/tmp6nw26ohr --profile weather --target dev`
[2025-06-20T09:35:52.152+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.152+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:52.153+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:52.152+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:52.153+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:52.152+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:59.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:59.577+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9sj3g0gh --profiles-dir /tmp/tmp6nw26ohr --profile weather --target dev`
[2025-06-20T09:35:59.578+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:59.577+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9sj3g0gh --profiles-dir /tmp/tmp6nw26ohr --profile weather --target dev`
[2025-06-20T09:35:59.579+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:59.577+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9sj3g0gh --profiles-dir /tmp/tmp6nw26ohr --profile weather --target dev`
[2025-06-20T09:35:59.580+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:59.579+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:59.582+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:35:59.579+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:35:59.582+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:35:59.579+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:36:05.553+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:05.551+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9sj3g0gh', '--profiles-dir', '/tmp/tmp6nw26ohr', '--profile', 'weather', '--target', 'dev'] due to the error:
09:36:02  Running with dbt=1.7.9
09:36:02  Registered adapter: postgres=1.7.9
09:36:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:36:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:36:05.553+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:05.551+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9sj3g0gh', '--profiles-dir', '/tmp/tmp6nw26ohr', '--profile', 'weather', '--target', 'dev'] due to the error:
09:36:02  Running with dbt=1.7.9
09:36:02  Registered adapter: postgres=1.7.9
09:36:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:36:04  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:36:05.554+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:36:05.568+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.962 seconds
[2025-06-20T09:36:36.345+0000] {processor.py:161} INFO - Started process (PID=928) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:36:36.349+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:36:36.355+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.355+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:36:36.455+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.455+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:36:36.813+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.813+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:36:36.814+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.813+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:36:36.814+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.813+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:36:36.815+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.815+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:36:36.816+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.815+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:36:36.816+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.815+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:36:36.817+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.817+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:36:36.818+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.817+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:36:36.818+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.817+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:36:36.820+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.820+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp05p3okse/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:36:36.821+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.820+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp05p3okse/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:36:36.821+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.820+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp05p3okse/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:36:36.822+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.822+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpumlnsa1t --profiles-dir /tmp/tmp05p3okse --profile weather --target dev`
[2025-06-20T09:36:36.823+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.822+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpumlnsa1t --profiles-dir /tmp/tmp05p3okse --profile weather --target dev`
[2025-06-20T09:36:36.823+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.822+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpumlnsa1t --profiles-dir /tmp/tmp05p3okse --profile weather --target dev`
[2025-06-20T09:36:36.824+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.824+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:36:36.825+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:36.824+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:36:36.825+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:36.824+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:36:40.954+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:40.954+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpumlnsa1t --profiles-dir /tmp/tmp05p3okse --profile weather --target dev`
[2025-06-20T09:36:40.955+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:40.954+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpumlnsa1t --profiles-dir /tmp/tmp05p3okse --profile weather --target dev`
[2025-06-20T09:36:40.955+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:40.954+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpumlnsa1t --profiles-dir /tmp/tmp05p3okse --profile weather --target dev`
[2025-06-20T09:36:40.955+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:40.955+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:36:40.956+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:40.955+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:36:40.956+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:40.955+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:36:46.635+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:36:46.633+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpumlnsa1t', '--profiles-dir', '/tmp/tmp05p3okse', '--profile', 'weather', '--target', 'dev'] due to the error:
09:36:43  Running with dbt=1.7.9
09:36:44  Registered adapter: postgres=1.7.9
09:36:44  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:36:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:36:46.636+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:36:46.633+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpumlnsa1t', '--profiles-dir', '/tmp/tmp05p3okse', '--profile', 'weather', '--target', 'dev'] due to the error:
09:36:43  Running with dbt=1.7.9
09:36:44  Registered adapter: postgres=1.7.9
09:36:44  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:36:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:36:46.637+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:36:46.661+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.331 seconds
[2025-06-20T09:37:16.901+0000] {processor.py:161} INFO - Started process (PID=970) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:37:16.902+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:37:16.904+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:16.903+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:37:16.943+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:16.943+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:37:17.341+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.340+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:37:17.341+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:17.340+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:37:17.342+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.340+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:37:17.343+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.343+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:37:17.344+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:17.343+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:37:17.344+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.343+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:37:17.345+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.345+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:37:17.346+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:17.345+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:37:17.346+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.345+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:37:17.348+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.348+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpf_7qbqj1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:37:17.349+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:17.348+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpf_7qbqj1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:37:17.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.348+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpf_7qbqj1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:37:17.350+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.350+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6cnox09g --profiles-dir /tmp/tmpf_7qbqj1 --profile weather --target dev`
[2025-06-20T09:37:17.351+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:17.350+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6cnox09g --profiles-dir /tmp/tmpf_7qbqj1 --profile weather --target dev`
[2025-06-20T09:37:17.351+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.350+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6cnox09g --profiles-dir /tmp/tmpf_7qbqj1 --profile weather --target dev`
[2025-06-20T09:37:17.352+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.351+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:37:17.352+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:17.351+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:37:17.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:17.351+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:37:21.404+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:21.404+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6cnox09g --profiles-dir /tmp/tmpf_7qbqj1 --profile weather --target dev`
[2025-06-20T09:37:21.405+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:21.404+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6cnox09g --profiles-dir /tmp/tmpf_7qbqj1 --profile weather --target dev`
[2025-06-20T09:37:21.405+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:21.404+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6cnox09g --profiles-dir /tmp/tmpf_7qbqj1 --profile weather --target dev`
[2025-06-20T09:37:21.405+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:21.405+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:37:21.406+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:21.405+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:37:21.406+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:21.405+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:37:31.132+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:37:31.130+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6cnox09g', '--profiles-dir', '/tmp/tmpf_7qbqj1', '--profile', 'weather', '--target', 'dev'] due to the error:
09:37:27  Running with dbt=1.7.9
09:37:28  Registered adapter: postgres=1.7.9
09:37:28  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:37:29  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:37:31.133+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:37:31.130+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6cnox09g', '--profiles-dir', '/tmp/tmpf_7qbqj1', '--profile', 'weather', '--target', 'dev'] due to the error:
09:37:27  Running with dbt=1.7.9
09:37:28  Registered adapter: postgres=1.7.9
09:37:28  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:37:29  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:37:31.134+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:37:31.156+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.258 seconds
[2025-06-20T09:38:01.655+0000] {processor.py:161} INFO - Started process (PID=1014) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:38:01.655+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:38:01.657+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:01.657+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:38:01.697+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:01.697+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:38:02.032+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.032+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:38:02.032+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:02.032+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:38:02.033+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.032+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:38:02.033+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.033+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:38:02.034+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:02.033+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:38:02.034+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.033+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:38:02.035+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.034+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:38:02.035+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:02.034+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:38:02.035+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.034+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:38:02.036+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.036+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpa2qmqwa6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:38:02.037+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:02.036+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpa2qmqwa6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:38:02.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.036+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpa2qmqwa6/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:38:02.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.037+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwv5wdoje --profiles-dir /tmp/tmpa2qmqwa6 --profile weather --target dev`
[2025-06-20T09:38:02.038+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:02.037+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwv5wdoje --profiles-dir /tmp/tmpa2qmqwa6 --profile weather --target dev`
[2025-06-20T09:38:02.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.037+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwv5wdoje --profiles-dir /tmp/tmpa2qmqwa6 --profile weather --target dev`
[2025-06-20T09:38:02.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.038+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:02.039+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:02.038+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:02.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:02.038+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:06.959+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:06.958+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwv5wdoje --profiles-dir /tmp/tmpa2qmqwa6 --profile weather --target dev`
[2025-06-20T09:38:06.960+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:06.958+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwv5wdoje --profiles-dir /tmp/tmpa2qmqwa6 --profile weather --target dev`
[2025-06-20T09:38:06.960+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:06.958+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwv5wdoje --profiles-dir /tmp/tmpa2qmqwa6 --profile weather --target dev`
[2025-06-20T09:38:06.961+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:06.960+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:06.961+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:06.960+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:06.962+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:06.960+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:14.257+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:14.255+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwv5wdoje', '--profiles-dir', '/tmp/tmpa2qmqwa6', '--profile', 'weather', '--target', 'dev'] due to the error:
09:38:10  Running with dbt=1.7.9
09:38:10  Registered adapter: postgres=1.7.9
09:38:10  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:38:12  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:38:14.258+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:14.255+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwv5wdoje', '--profiles-dir', '/tmp/tmpa2qmqwa6', '--profile', 'weather', '--target', 'dev'] due to the error:
09:38:10  Running with dbt=1.7.9
09:38:10  Registered adapter: postgres=1.7.9
09:38:10  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:38:12  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:38:14.259+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:38:14.296+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.644 seconds
[2025-06-20T09:38:44.848+0000] {processor.py:161} INFO - Started process (PID=1062) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:38:44.851+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:38:44.855+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:44.855+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:38:44.980+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:44.980+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:38:45.618+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.617+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:38:45.618+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:45.617+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:38:45.619+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.617+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:38:45.620+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.620+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:38:45.620+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:45.620+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:38:45.621+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.620+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:38:45.622+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.621+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:38:45.622+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:45.621+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:38:45.624+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.621+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:38:45.628+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.628+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzun7ha8w/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:38:45.628+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:45.628+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpzun7ha8w/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:38:45.629+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.628+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzun7ha8w/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:38:45.630+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.630+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmfxps4ce --profiles-dir /tmp/tmpzun7ha8w --profile weather --target dev`
[2025-06-20T09:38:45.630+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:45.630+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmfxps4ce --profiles-dir /tmp/tmpzun7ha8w --profile weather --target dev`
[2025-06-20T09:38:45.631+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.630+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmfxps4ce --profiles-dir /tmp/tmpzun7ha8w --profile weather --target dev`
[2025-06-20T09:38:45.632+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.631+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:45.632+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:45.631+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:45.633+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:45.631+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:52.885+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:52.884+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmfxps4ce --profiles-dir /tmp/tmpzun7ha8w --profile weather --target dev`
[2025-06-20T09:38:52.886+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:52.884+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmfxps4ce --profiles-dir /tmp/tmpzun7ha8w --profile weather --target dev`
[2025-06-20T09:38:52.886+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:52.884+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmfxps4ce --profiles-dir /tmp/tmpzun7ha8w --profile weather --target dev`
[2025-06-20T09:38:52.887+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:52.886+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:52.887+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:52.886+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:52.887+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:52.886+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:38:58.860+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:38:58.858+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmfxps4ce', '--profiles-dir', '/tmp/tmpzun7ha8w', '--profile', 'weather', '--target', 'dev'] due to the error:
09:38:56  Running with dbt=1.7.9
09:38:56  Registered adapter: postgres=1.7.9
09:38:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:38:57  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:38:58.861+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:38:58.858+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmfxps4ce', '--profiles-dir', '/tmp/tmpzun7ha8w', '--profile', 'weather', '--target', 'dev'] due to the error:
09:38:56  Running with dbt=1.7.9
09:38:56  Registered adapter: postgres=1.7.9
09:38:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:38:57  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:38:58.862+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:38:58.881+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.040 seconds
[2025-06-20T09:39:29.166+0000] {processor.py:161} INFO - Started process (PID=1109) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:39:29.167+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:39:29.169+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.169+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:39:29.209+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.208+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:39:29.586+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.585+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:39:29.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.585+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:39:29.586+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.585+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:39:29.587+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.587+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:39:29.588+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.587+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:39:29.589+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.587+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:39:29.590+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.589+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:39:29.590+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.589+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:39:29.591+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.589+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:39:29.593+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.593+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7exxcabu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:39:29.593+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.593+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp7exxcabu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:39:29.594+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.593+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7exxcabu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:39:29.595+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.594+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqvqczqi6 --profiles-dir /tmp/tmp7exxcabu --profile weather --target dev`
[2025-06-20T09:39:29.595+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.594+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqvqczqi6 --profiles-dir /tmp/tmp7exxcabu --profile weather --target dev`
[2025-06-20T09:39:29.596+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.594+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqvqczqi6 --profiles-dir /tmp/tmp7exxcabu --profile weather --target dev`
[2025-06-20T09:39:29.596+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.596+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:39:29.597+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:29.596+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:39:29.597+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:29.596+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:39:33.709+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:33.709+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqvqczqi6 --profiles-dir /tmp/tmp7exxcabu --profile weather --target dev`
[2025-06-20T09:39:33.710+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:33.709+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqvqczqi6 --profiles-dir /tmp/tmp7exxcabu --profile weather --target dev`
[2025-06-20T09:39:33.710+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:33.709+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqvqczqi6 --profiles-dir /tmp/tmp7exxcabu --profile weather --target dev`
[2025-06-20T09:39:33.710+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:33.710+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:39:33.711+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:33.710+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:39:33.711+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:33.710+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:39:42.601+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:39:42.600+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqvqczqi6', '--profiles-dir', '/tmp/tmp7exxcabu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:39:37  Running with dbt=1.7.9
09:39:38  Registered adapter: postgres=1.7.9
09:39:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:39:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:39:42.602+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:39:42.600+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqvqczqi6', '--profiles-dir', '/tmp/tmp7exxcabu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:39:37  Running with dbt=1.7.9
09:39:38  Registered adapter: postgres=1.7.9
09:39:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:39:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:39:42.603+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:39:42.617+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.453 seconds
[2025-06-20T09:40:12.997+0000] {processor.py:161} INFO - Started process (PID=1150) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:40:12.997+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:40:12.999+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:12.999+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:40:13.038+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:13.038+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:40:13.366+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.365+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:40:13.366+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:13.365+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:40:13.366+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.365+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:40:13.367+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.367+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:40:13.367+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:13.367+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:40:13.367+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.367+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:40:13.368+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.368+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:40:13.368+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:13.368+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:40:13.369+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.368+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:40:13.370+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.370+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4_qmtjue/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:40:13.370+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:13.370+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp4_qmtjue/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:40:13.371+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.370+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4_qmtjue/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:40:13.371+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.371+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe_zuanqe --profiles-dir /tmp/tmp4_qmtjue --profile weather --target dev`
[2025-06-20T09:40:13.371+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:13.371+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe_zuanqe --profiles-dir /tmp/tmp4_qmtjue --profile weather --target dev`
[2025-06-20T09:40:13.372+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.371+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe_zuanqe --profiles-dir /tmp/tmp4_qmtjue --profile weather --target dev`
[2025-06-20T09:40:13.372+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.372+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:13.372+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:13.372+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:13.373+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:13.372+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:17.496+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:17.495+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe_zuanqe --profiles-dir /tmp/tmp4_qmtjue --profile weather --target dev`
[2025-06-20T09:40:17.497+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:17.495+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe_zuanqe --profiles-dir /tmp/tmp4_qmtjue --profile weather --target dev`
[2025-06-20T09:40:17.498+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:17.495+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe_zuanqe --profiles-dir /tmp/tmp4_qmtjue --profile weather --target dev`
[2025-06-20T09:40:17.498+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:17.498+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:17.499+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:17.498+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:17.499+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:17.498+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:24.848+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:24.846+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe_zuanqe', '--profiles-dir', '/tmp/tmp4_qmtjue', '--profile', 'weather', '--target', 'dev'] due to the error:
09:40:21  Running with dbt=1.7.9
09:40:22  Registered adapter: postgres=1.7.9
09:40:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:40:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:40:24.849+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:24.846+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe_zuanqe', '--profiles-dir', '/tmp/tmp4_qmtjue', '--profile', 'weather', '--target', 'dev'] due to the error:
09:40:21  Running with dbt=1.7.9
09:40:22  Registered adapter: postgres=1.7.9
09:40:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:40:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:40:24.849+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:40:24.871+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.877 seconds
[2025-06-20T09:40:55.770+0000] {processor.py:161} INFO - Started process (PID=1191) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:40:55.771+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:40:55.773+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:55.773+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:40:55.817+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:55.817+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:40:56.179+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.178+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:40:56.179+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:56.178+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:40:56.179+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.178+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:40:56.180+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.180+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:40:56.180+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:56.180+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:40:56.181+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.180+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:40:56.181+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.181+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:40:56.182+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:56.181+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:40:56.182+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.181+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:40:56.184+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.184+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1i9bdlcy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:40:56.184+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:56.184+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp1i9bdlcy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:40:56.185+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.184+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1i9bdlcy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:40:56.186+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.186+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr72bhwc_ --profiles-dir /tmp/tmp1i9bdlcy --profile weather --target dev`
[2025-06-20T09:40:56.186+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:56.186+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr72bhwc_ --profiles-dir /tmp/tmp1i9bdlcy --profile weather --target dev`
[2025-06-20T09:40:56.187+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.186+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr72bhwc_ --profiles-dir /tmp/tmp1i9bdlcy --profile weather --target dev`
[2025-06-20T09:40:56.187+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.187+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:56.188+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:40:56.187+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:40:56.188+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:40:56.187+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:01.832+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:01.831+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr72bhwc_ --profiles-dir /tmp/tmp1i9bdlcy --profile weather --target dev`
[2025-06-20T09:41:01.832+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:01.831+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr72bhwc_ --profiles-dir /tmp/tmp1i9bdlcy --profile weather --target dev`
[2025-06-20T09:41:01.833+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:01.831+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr72bhwc_ --profiles-dir /tmp/tmp1i9bdlcy --profile weather --target dev`
[2025-06-20T09:41:01.833+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:01.833+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:01.833+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:01.833+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:01.834+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:01.833+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:09.521+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:09.520+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpr72bhwc_', '--profiles-dir', '/tmp/tmp1i9bdlcy', '--profile', 'weather', '--target', 'dev'] due to the error:
09:41:05  Running with dbt=1.7.9
09:41:05  Registered adapter: postgres=1.7.9
09:41:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:41:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:41:09.522+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:09.520+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpr72bhwc_', '--profiles-dir', '/tmp/tmp1i9bdlcy', '--profile', 'weather', '--target', 'dev'] due to the error:
09:41:05  Running with dbt=1.7.9
09:41:05  Registered adapter: postgres=1.7.9
09:41:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:41:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:41:09.522+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:41:09.536+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.770 seconds
[2025-06-20T09:41:39.733+0000] {processor.py:161} INFO - Started process (PID=1244) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:41:39.736+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:41:39.738+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:39.738+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:41:39.895+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:39.895+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:41:40.454+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.454+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:41:40.455+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:40.454+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:41:40.455+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.454+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:41:40.456+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.456+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:41:40.457+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:40.456+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:41:40.457+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.456+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:41:40.458+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.458+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:41:40.459+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:40.458+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:41:40.459+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.458+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:41:40.461+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.461+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdx7zp7dv/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:41:40.461+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:40.461+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpdx7zp7dv/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:41:40.462+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.461+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdx7zp7dv/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:41:40.463+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.462+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe134jyqu --profiles-dir /tmp/tmpdx7zp7dv --profile weather --target dev`
[2025-06-20T09:41:40.463+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:40.462+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe134jyqu --profiles-dir /tmp/tmpdx7zp7dv --profile weather --target dev`
[2025-06-20T09:41:40.464+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.462+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe134jyqu --profiles-dir /tmp/tmpdx7zp7dv --profile weather --target dev`
[2025-06-20T09:41:40.464+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.464+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:40.465+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:40.464+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:40.465+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:40.464+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:46.102+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:46.102+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe134jyqu --profiles-dir /tmp/tmpdx7zp7dv --profile weather --target dev`
[2025-06-20T09:41:46.103+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:46.102+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe134jyqu --profiles-dir /tmp/tmpdx7zp7dv --profile weather --target dev`
[2025-06-20T09:41:46.103+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:46.102+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe134jyqu --profiles-dir /tmp/tmpdx7zp7dv --profile weather --target dev`
[2025-06-20T09:41:46.103+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:46.103+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:46.104+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:46.103+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:46.104+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:46.103+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:41:55.270+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:41:55.269+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe134jyqu', '--profiles-dir', '/tmp/tmpdx7zp7dv', '--profile', 'weather', '--target', 'dev'] due to the error:
09:41:51  Running with dbt=1.7.9
09:41:51  Registered adapter: postgres=1.7.9
09:41:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:41:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:41:55.271+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:41:55.269+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe134jyqu', '--profiles-dir', '/tmp/tmpdx7zp7dv', '--profile', 'weather', '--target', 'dev'] due to the error:
09:41:51  Running with dbt=1.7.9
09:41:51  Registered adapter: postgres=1.7.9
09:41:51  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:41:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:41:55.271+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:41:55.285+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.559 seconds
[2025-06-20T09:42:26.261+0000] {processor.py:161} INFO - Started process (PID=1289) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:42:26.261+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:42:26.263+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.263+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:42:26.303+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.303+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:42:26.659+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.659+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:42:26.660+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.659+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:42:26.660+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.659+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:42:26.661+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.661+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:42:26.661+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.661+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:42:26.662+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.661+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:42:26.663+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.662+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:42:26.663+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.662+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:42:26.663+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.662+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:42:26.665+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.665+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1zvetofi/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:42:26.665+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.665+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp1zvetofi/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:42:26.666+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.665+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1zvetofi/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:42:26.667+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.666+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp03ltg1ry --profiles-dir /tmp/tmp1zvetofi --profile weather --target dev`
[2025-06-20T09:42:26.667+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.666+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp03ltg1ry --profiles-dir /tmp/tmp1zvetofi --profile weather --target dev`
[2025-06-20T09:42:26.667+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.666+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp03ltg1ry --profiles-dir /tmp/tmp1zvetofi --profile weather --target dev`
[2025-06-20T09:42:26.668+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.667+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:42:26.668+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:26.667+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:42:26.669+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:26.667+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:42:31.029+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:31.029+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp03ltg1ry --profiles-dir /tmp/tmp1zvetofi --profile weather --target dev`
[2025-06-20T09:42:31.030+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:31.029+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp03ltg1ry --profiles-dir /tmp/tmp1zvetofi --profile weather --target dev`
[2025-06-20T09:42:31.031+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:31.029+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp03ltg1ry --profiles-dir /tmp/tmp1zvetofi --profile weather --target dev`
[2025-06-20T09:42:31.031+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:31.031+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:42:31.032+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:31.031+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:42:31.032+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:31.031+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:42:37.900+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:42:37.898+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp03ltg1ry', '--profiles-dir', '/tmp/tmp1zvetofi', '--profile', 'weather', '--target', 'dev'] due to the error:
09:42:35  Running with dbt=1.7.9
09:42:35  Registered adapter: postgres=1.7.9
09:42:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:42:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:42:37.900+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:42:37.898+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp03ltg1ry', '--profiles-dir', '/tmp/tmp1zvetofi', '--profile', 'weather', '--target', 'dev'] due to the error:
09:42:35  Running with dbt=1.7.9
09:42:35  Registered adapter: postgres=1.7.9
09:42:35  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:42:36  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:42:37.901+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:42:37.921+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.663 seconds
[2025-06-20T09:43:08.218+0000] {processor.py:161} INFO - Started process (PID=1332) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:43:08.219+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:43:08.221+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.220+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:43:08.260+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.260+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:43:08.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.613+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:43:08.614+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.613+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:43:08.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.613+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:43:08.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.615+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:43:08.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.615+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:43:08.616+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.615+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:43:08.616+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.616+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:43:08.617+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.616+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:43:08.617+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.616+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:43:08.618+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.618+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpyu82rckw/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:43:08.618+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.618+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpyu82rckw/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:43:08.619+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.618+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpyu82rckw/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:43:08.619+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.619+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpn5q05y_t --profiles-dir /tmp/tmpyu82rckw --profile weather --target dev`
[2025-06-20T09:43:08.619+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.619+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpn5q05y_t --profiles-dir /tmp/tmpyu82rckw --profile weather --target dev`
[2025-06-20T09:43:08.620+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.619+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpn5q05y_t --profiles-dir /tmp/tmpyu82rckw --profile weather --target dev`
[2025-06-20T09:43:08.620+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.620+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:08.620+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:08.620+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:08.621+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:08.620+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:14.263+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:14.262+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpn5q05y_t --profiles-dir /tmp/tmpyu82rckw --profile weather --target dev`
[2025-06-20T09:43:14.263+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:14.262+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpn5q05y_t --profiles-dir /tmp/tmpyu82rckw --profile weather --target dev`
[2025-06-20T09:43:14.264+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:14.262+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpn5q05y_t --profiles-dir /tmp/tmpyu82rckw --profile weather --target dev`
[2025-06-20T09:43:14.264+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:14.264+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:14.264+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:14.264+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:14.265+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:14.264+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:20.027+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:20.026+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpn5q05y_t', '--profiles-dir', '/tmp/tmpyu82rckw', '--profile', 'weather', '--target', 'dev'] due to the error:
09:43:17  Running with dbt=1.7.9
09:43:17  Registered adapter: postgres=1.7.9
09:43:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:43:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:43:20.028+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:20.026+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpn5q05y_t', '--profiles-dir', '/tmp/tmpyu82rckw', '--profile', 'weather', '--target', 'dev'] due to the error:
09:43:17  Running with dbt=1.7.9
09:43:17  Registered adapter: postgres=1.7.9
09:43:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:43:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:43:20.028+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:43:20.044+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.829 seconds
[2025-06-20T09:43:50.089+0000] {processor.py:161} INFO - Started process (PID=1373) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:43:50.090+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:43:50.092+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.092+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:43:50.134+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.134+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:43:50.449+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.449+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:43:50.449+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.449+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:43:50.450+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.449+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:43:50.450+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.450+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:43:50.451+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.450+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:43:50.451+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.450+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:43:50.452+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.451+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:43:50.452+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.451+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:43:50.452+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.451+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:43:50.453+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.453+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp8mp1juge/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:43:50.454+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.453+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp8mp1juge/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:43:50.454+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.453+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp8mp1juge/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:43:50.454+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.454+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2d7k0jnw --profiles-dir /tmp/tmp8mp1juge --profile weather --target dev`
[2025-06-20T09:43:50.455+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.454+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2d7k0jnw --profiles-dir /tmp/tmp8mp1juge --profile weather --target dev`
[2025-06-20T09:43:50.455+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.454+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2d7k0jnw --profiles-dir /tmp/tmp8mp1juge --profile weather --target dev`
[2025-06-20T09:43:50.455+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.455+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:50.456+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:50.455+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:50.456+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:50.455+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:56.435+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:56.434+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2d7k0jnw --profiles-dir /tmp/tmp8mp1juge --profile weather --target dev`
[2025-06-20T09:43:56.436+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:56.434+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2d7k0jnw --profiles-dir /tmp/tmp8mp1juge --profile weather --target dev`
[2025-06-20T09:43:56.436+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:56.434+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2d7k0jnw --profiles-dir /tmp/tmp8mp1juge --profile weather --target dev`
[2025-06-20T09:43:56.437+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:56.436+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:56.437+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:43:56.436+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:43:56.437+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:43:56.436+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:44:06.776+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:06.773+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2d7k0jnw', '--profiles-dir', '/tmp/tmp8mp1juge', '--profile', 'weather', '--target', 'dev'] due to the error:
09:44:03  Running with dbt=1.7.9
09:44:04  Registered adapter: postgres=1.7.9
09:44:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:44:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:44:06.777+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:06.773+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2d7k0jnw', '--profiles-dir', '/tmp/tmp8mp1juge', '--profile', 'weather', '--target', 'dev'] due to the error:
09:44:03  Running with dbt=1.7.9
09:44:04  Registered adapter: postgres=1.7.9
09:44:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:44:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:44:06.779+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:44:06.827+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 16.741 seconds
[2025-06-20T09:44:36.916+0000] {processor.py:161} INFO - Started process (PID=1428) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:44:36.919+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:44:36.924+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:36.924+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:44:37.052+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:37.052+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:44:37.907+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.907+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:44:37.908+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:37.907+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:44:37.908+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.907+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:44:37.909+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.909+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:44:37.910+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:37.909+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:44:37.910+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.909+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:44:37.912+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.911+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:44:37.913+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:37.911+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:44:37.914+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.911+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:44:37.917+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.917+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxhppf0yh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:44:37.917+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:37.917+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpxhppf0yh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:44:37.918+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.917+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxhppf0yh/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:44:37.918+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.918+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyuu9ajsv --profiles-dir /tmp/tmpxhppf0yh --profile weather --target dev`
[2025-06-20T09:44:37.919+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:37.918+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyuu9ajsv --profiles-dir /tmp/tmpxhppf0yh --profile weather --target dev`
[2025-06-20T09:44:37.919+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.918+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyuu9ajsv --profiles-dir /tmp/tmpxhppf0yh --profile weather --target dev`
[2025-06-20T09:44:37.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.920+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:44:37.921+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:37.920+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:44:37.921+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:37.920+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:44:42.341+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:42.340+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyuu9ajsv --profiles-dir /tmp/tmpxhppf0yh --profile weather --target dev`
[2025-06-20T09:44:42.341+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:42.340+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyuu9ajsv --profiles-dir /tmp/tmpxhppf0yh --profile weather --target dev`
[2025-06-20T09:44:42.342+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:42.340+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyuu9ajsv --profiles-dir /tmp/tmpxhppf0yh --profile weather --target dev`
[2025-06-20T09:44:42.342+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:42.342+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:44:42.342+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:42.342+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:44:42.343+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:42.342+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:44:49.831+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:44:49.830+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyuu9ajsv', '--profiles-dir', '/tmp/tmpxhppf0yh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:44:46  Running with dbt=1.7.9
09:44:47  Registered adapter: postgres=1.7.9
09:44:47  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:44:48  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:44:49.832+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:44:49.830+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyuu9ajsv', '--profiles-dir', '/tmp/tmpxhppf0yh', '--profile', 'weather', '--target', 'dev'] due to the error:
09:44:46  Running with dbt=1.7.9
09:44:47  Registered adapter: postgres=1.7.9
09:44:47  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:44:48  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:44:49.832+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:44:49.847+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.939 seconds
[2025-06-20T09:45:19.874+0000] {processor.py:161} INFO - Started process (PID=1467) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:45:19.875+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:45:19.877+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:19.877+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:45:19.918+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:19.917+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:45:20.369+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.368+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:45:20.369+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:20.368+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:45:20.369+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.368+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:45:20.370+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.370+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:45:20.370+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:20.370+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:45:20.370+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.370+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:45:20.371+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.371+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:45:20.371+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:20.371+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:45:20.372+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.371+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:45:20.373+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.373+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpug6lx5gc/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:45:20.373+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:20.373+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpug6lx5gc/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:45:20.373+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.373+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpug6lx5gc/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:45:20.374+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.374+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0mehsrmw --profiles-dir /tmp/tmpug6lx5gc --profile weather --target dev`
[2025-06-20T09:45:20.374+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:20.374+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0mehsrmw --profiles-dir /tmp/tmpug6lx5gc --profile weather --target dev`
[2025-06-20T09:45:20.375+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.374+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0mehsrmw --profiles-dir /tmp/tmpug6lx5gc --profile weather --target dev`
[2025-06-20T09:45:20.375+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.375+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:45:20.375+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:20.375+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:45:20.376+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:20.375+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:45:24.293+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:24.293+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0mehsrmw --profiles-dir /tmp/tmpug6lx5gc --profile weather --target dev`
[2025-06-20T09:45:24.294+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:24.293+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0mehsrmw --profiles-dir /tmp/tmpug6lx5gc --profile weather --target dev`
[2025-06-20T09:45:24.294+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:24.293+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0mehsrmw --profiles-dir /tmp/tmpug6lx5gc --profile weather --target dev`
[2025-06-20T09:45:24.294+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:24.294+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:45:24.295+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:24.294+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:45:24.295+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:24.294+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:45:32.242+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:45:32.241+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0mehsrmw', '--profiles-dir', '/tmp/tmpug6lx5gc', '--profile', 'weather', '--target', 'dev'] due to the error:
09:45:29  Running with dbt=1.7.9
09:45:29  Registered adapter: postgres=1.7.9
09:45:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:45:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:45:32.243+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:45:32.241+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0mehsrmw', '--profiles-dir', '/tmp/tmpug6lx5gc', '--profile', 'weather', '--target', 'dev'] due to the error:
09:45:29  Running with dbt=1.7.9
09:45:29  Registered adapter: postgres=1.7.9
09:45:29  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:45:31  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:45:32.243+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:45:32.257+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.385 seconds
[2025-06-20T09:46:02.309+0000] {processor.py:161} INFO - Started process (PID=1507) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:46:02.310+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:46:02.312+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.312+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:46:02.352+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.352+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:46:02.691+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.690+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:46:02.691+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.690+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:46:02.691+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.690+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:46:02.692+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.692+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:46:02.692+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.692+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:46:02.693+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.692+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:46:02.693+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.693+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:46:02.694+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.693+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:46:02.694+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.693+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:46:02.695+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.695+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxvd7cowj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:46:02.695+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.695+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpxvd7cowj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:46:02.696+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.695+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxvd7cowj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:46:02.696+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.696+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2yuj3fpj --profiles-dir /tmp/tmpxvd7cowj --profile weather --target dev`
[2025-06-20T09:46:02.696+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.696+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2yuj3fpj --profiles-dir /tmp/tmpxvd7cowj --profile weather --target dev`
[2025-06-20T09:46:02.697+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.696+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2yuj3fpj --profiles-dir /tmp/tmpxvd7cowj --profile weather --target dev`
[2025-06-20T09:46:02.697+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.697+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:02.698+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:02.697+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:02.698+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:02.697+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:08.456+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:08.455+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2yuj3fpj --profiles-dir /tmp/tmpxvd7cowj --profile weather --target dev`
[2025-06-20T09:46:08.459+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:08.455+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2yuj3fpj --profiles-dir /tmp/tmpxvd7cowj --profile weather --target dev`
[2025-06-20T09:46:08.460+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:08.455+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2yuj3fpj --profiles-dir /tmp/tmpxvd7cowj --profile weather --target dev`
[2025-06-20T09:46:08.460+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:08.460+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:08.463+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:08.460+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:08.464+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:08.460+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:14.469+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:14.467+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2yuj3fpj', '--profiles-dir', '/tmp/tmpxvd7cowj', '--profile', 'weather', '--target', 'dev'] due to the error:
09:46:11  Running with dbt=1.7.9
09:46:11  Registered adapter: postgres=1.7.9
09:46:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:46:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:46:14.470+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:14.467+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2yuj3fpj', '--profiles-dir', '/tmp/tmpxvd7cowj', '--profile', 'weather', '--target', 'dev'] due to the error:
09:46:11  Running with dbt=1.7.9
09:46:11  Registered adapter: postgres=1.7.9
09:46:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:46:13  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:46:14.470+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:46:14.491+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.184 seconds
[2025-06-20T09:46:45.395+0000] {processor.py:161} INFO - Started process (PID=1558) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:46:45.398+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:46:45.400+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.400+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:46:45.458+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.458+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:46:45.942+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.941+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:46:45.942+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.941+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:46:45.943+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.941+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:46:45.944+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.944+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:46:45.945+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.944+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:46:45.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.944+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:46:45.946+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.946+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:46:45.947+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.946+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:46:45.947+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.946+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:46:45.949+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.949+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6fo71s1w/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:46:45.951+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.949+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp6fo71s1w/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:46:45.952+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.949+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6fo71s1w/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:46:45.953+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.952+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp392r50k8 --profiles-dir /tmp/tmp6fo71s1w --profile weather --target dev`
[2025-06-20T09:46:45.953+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.952+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp392r50k8 --profiles-dir /tmp/tmp6fo71s1w --profile weather --target dev`
[2025-06-20T09:46:45.954+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.952+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp392r50k8 --profiles-dir /tmp/tmp6fo71s1w --profile weather --target dev`
[2025-06-20T09:46:45.955+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.954+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:45.956+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:45.954+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:45.957+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:45.954+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:53.925+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:53.924+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp392r50k8 --profiles-dir /tmp/tmp6fo71s1w --profile weather --target dev`
[2025-06-20T09:46:53.926+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:53.924+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp392r50k8 --profiles-dir /tmp/tmp6fo71s1w --profile weather --target dev`
[2025-06-20T09:46:53.926+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:53.924+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp392r50k8 --profiles-dir /tmp/tmp6fo71s1w --profile weather --target dev`
[2025-06-20T09:46:53.927+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:53.927+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:53.927+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:46:53.927+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:46:53.928+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:46:53.927+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:47:00.262+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:00.260+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp392r50k8', '--profiles-dir', '/tmp/tmp6fo71s1w', '--profile', 'weather', '--target', 'dev'] due to the error:
09:46:57  Running with dbt=1.7.9
09:46:57  Registered adapter: postgres=1.7.9
09:46:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:46:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:47:00.263+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:00.260+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp392r50k8', '--profiles-dir', '/tmp/tmp6fo71s1w', '--profile', 'weather', '--target', 'dev'] due to the error:
09:46:57  Running with dbt=1.7.9
09:46:57  Registered adapter: postgres=1.7.9
09:46:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:46:58  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:47:00.263+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:47:00.283+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.894 seconds
[2025-06-20T09:47:30.707+0000] {processor.py:161} INFO - Started process (PID=1602) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:47:30.708+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:47:30.710+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:30.709+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:47:30.750+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:30.750+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:47:31.074+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.074+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:47:31.075+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:31.074+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:47:31.075+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.074+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:47:31.076+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.076+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:47:31.076+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:31.076+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:47:31.076+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.076+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:47:31.077+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.077+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:47:31.077+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:31.077+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:47:31.077+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.077+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:47:31.079+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.079+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpb3pr5zyd/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:47:31.079+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:31.079+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpb3pr5zyd/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:47:31.079+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.079+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpb3pr5zyd/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:47:31.080+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.080+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph7azlbqt --profiles-dir /tmp/tmpb3pr5zyd --profile weather --target dev`
[2025-06-20T09:47:31.080+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:31.080+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph7azlbqt --profiles-dir /tmp/tmpb3pr5zyd --profile weather --target dev`
[2025-06-20T09:47:31.081+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.080+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph7azlbqt --profiles-dir /tmp/tmpb3pr5zyd --profile weather --target dev`
[2025-06-20T09:47:31.081+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.081+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:47:31.082+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:31.081+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:47:31.082+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:31.081+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:47:35.204+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:35.203+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph7azlbqt --profiles-dir /tmp/tmpb3pr5zyd --profile weather --target dev`
[2025-06-20T09:47:35.204+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:35.203+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph7azlbqt --profiles-dir /tmp/tmpb3pr5zyd --profile weather --target dev`
[2025-06-20T09:47:35.204+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:35.203+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph7azlbqt --profiles-dir /tmp/tmpb3pr5zyd --profile weather --target dev`
[2025-06-20T09:47:35.205+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:35.204+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:47:35.205+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:35.204+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:47:35.205+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:35.204+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:47:42.021+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:47:42.019+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph7azlbqt', '--profiles-dir', '/tmp/tmpb3pr5zyd', '--profile', 'weather', '--target', 'dev'] due to the error:
09:47:38  Running with dbt=1.7.9
09:47:38  Registered adapter: postgres=1.7.9
09:47:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:47:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:47:42.023+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:47:42.019+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph7azlbqt', '--profiles-dir', '/tmp/tmpb3pr5zyd', '--profile', 'weather', '--target', 'dev'] due to the error:
09:47:38  Running with dbt=1.7.9
09:47:38  Registered adapter: postgres=1.7.9
09:47:38  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:47:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:47:42.023+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:47:42.051+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.347 seconds
[2025-06-20T09:48:12.395+0000] {processor.py:161} INFO - Started process (PID=1647) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:48:12.396+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:48:12.398+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.398+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:48:12.437+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.437+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:48:12.768+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.768+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:48:12.769+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.768+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:48:12.769+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.768+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:48:12.770+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.770+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:48:12.770+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.770+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:48:12.771+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.770+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:48:12.772+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.771+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:48:12.772+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.771+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:48:12.773+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.771+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:48:12.776+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.775+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2188g5v7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:48:12.776+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.775+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp2188g5v7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:48:12.777+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.775+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2188g5v7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:48:12.777+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.777+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxpc6kjeh --profiles-dir /tmp/tmp2188g5v7 --profile weather --target dev`
[2025-06-20T09:48:12.778+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.777+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxpc6kjeh --profiles-dir /tmp/tmp2188g5v7 --profile weather --target dev`
[2025-06-20T09:48:12.778+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.777+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxpc6kjeh --profiles-dir /tmp/tmp2188g5v7 --profile weather --target dev`
[2025-06-20T09:48:12.779+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.778+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:12.779+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:12.778+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:12.780+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:12.778+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:16.736+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:16.735+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxpc6kjeh --profiles-dir /tmp/tmp2188g5v7 --profile weather --target dev`
[2025-06-20T09:48:16.737+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:16.735+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxpc6kjeh --profiles-dir /tmp/tmp2188g5v7 --profile weather --target dev`
[2025-06-20T09:48:16.737+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:16.735+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxpc6kjeh --profiles-dir /tmp/tmp2188g5v7 --profile weather --target dev`
[2025-06-20T09:48:16.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:16.737+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:16.738+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:16.737+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:16.738+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:16.737+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:24.388+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:24.387+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxpc6kjeh', '--profiles-dir', '/tmp/tmp2188g5v7', '--profile', 'weather', '--target', 'dev'] due to the error:
09:48:20  Running with dbt=1.7.9
09:48:21  Registered adapter: postgres=1.7.9
09:48:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:48:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:48:24.388+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:24.387+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxpc6kjeh', '--profiles-dir', '/tmp/tmp2188g5v7', '--profile', 'weather', '--target', 'dev'] due to the error:
09:48:20  Running with dbt=1.7.9
09:48:21  Registered adapter: postgres=1.7.9
09:48:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:48:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:48:24.389+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:48:24.403+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.010 seconds
[2025-06-20T09:48:54.668+0000] {processor.py:161} INFO - Started process (PID=1688) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:48:54.669+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:48:54.671+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:54.671+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:48:54.715+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:54.715+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:48:55.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.037+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:48:55.037+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:55.037+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:48:55.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.037+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:48:55.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.038+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:48:55.039+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:55.038+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:48:55.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.038+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:48:55.040+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.039+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:48:55.040+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:55.039+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:48:55.040+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.039+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:48:55.042+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.041+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp5_64_0j1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:48:55.042+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:55.041+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp5_64_0j1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:48:55.042+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.041+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp5_64_0j1/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:48:55.043+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.042+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpghx7q6w1 --profiles-dir /tmp/tmp5_64_0j1 --profile weather --target dev`
[2025-06-20T09:48:55.043+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:55.042+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpghx7q6w1 --profiles-dir /tmp/tmp5_64_0j1 --profile weather --target dev`
[2025-06-20T09:48:55.043+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.042+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpghx7q6w1 --profiles-dir /tmp/tmp5_64_0j1 --profile weather --target dev`
[2025-06-20T09:48:55.044+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.043+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:55.044+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:55.043+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:55.044+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:55.043+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:59.051+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:59.050+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpghx7q6w1 --profiles-dir /tmp/tmp5_64_0j1 --profile weather --target dev`
[2025-06-20T09:48:59.052+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:59.050+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpghx7q6w1 --profiles-dir /tmp/tmp5_64_0j1 --profile weather --target dev`
[2025-06-20T09:48:59.052+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:59.050+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpghx7q6w1 --profiles-dir /tmp/tmp5_64_0j1 --profile weather --target dev`
[2025-06-20T09:48:59.053+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:59.053+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:59.054+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:48:59.053+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:48:59.054+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:48:59.053+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:49:08.540+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:08.538+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpghx7q6w1', '--profiles-dir', '/tmp/tmp5_64_0j1', '--profile', 'weather', '--target', 'dev'] due to the error:
09:49:05  Running with dbt=1.7.9
09:49:05  Registered adapter: postgres=1.7.9
09:49:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:49:07  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:49:08.541+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:08.538+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpghx7q6w1', '--profiles-dir', '/tmp/tmp5_64_0j1', '--profile', 'weather', '--target', 'dev'] due to the error:
09:49:05  Running with dbt=1.7.9
09:49:05  Registered adapter: postgres=1.7.9
09:49:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:49:07  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:49:08.542+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:49:08.572+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.907 seconds
[2025-06-20T09:49:39.393+0000] {processor.py:161} INFO - Started process (PID=1733) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:49:39.394+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:49:39.396+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.396+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:49:39.457+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.456+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:49:39.783+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.783+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:49:39.783+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.783+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:49:39.784+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.783+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:49:39.784+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.784+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:49:39.784+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.784+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:49:39.785+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.784+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:49:39.786+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.785+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:49:39.786+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.785+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:49:39.786+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.785+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:49:39.788+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.788+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6dzzg55p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:49:39.788+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.788+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp6dzzg55p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:49:39.788+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.788+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6dzzg55p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:49:39.789+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.789+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuunwrr9w --profiles-dir /tmp/tmp6dzzg55p --profile weather --target dev`
[2025-06-20T09:49:39.789+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.789+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuunwrr9w --profiles-dir /tmp/tmp6dzzg55p --profile weather --target dev`
[2025-06-20T09:49:39.790+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.789+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuunwrr9w --profiles-dir /tmp/tmp6dzzg55p --profile weather --target dev`
[2025-06-20T09:49:39.790+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.790+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:49:39.790+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:39.790+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:49:39.791+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:39.790+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:49:47.673+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:47.673+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuunwrr9w --profiles-dir /tmp/tmp6dzzg55p --profile weather --target dev`
[2025-06-20T09:49:47.674+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:47.673+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuunwrr9w --profiles-dir /tmp/tmp6dzzg55p --profile weather --target dev`
[2025-06-20T09:49:47.674+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:47.673+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuunwrr9w --profiles-dir /tmp/tmp6dzzg55p --profile weather --target dev`
[2025-06-20T09:49:47.675+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:47.674+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:49:47.675+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:47.674+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:49:47.675+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:47.674+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:49:53.538+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:49:53.537+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuunwrr9w', '--profiles-dir', '/tmp/tmp6dzzg55p', '--profile', 'weather', '--target', 'dev'] due to the error:
09:49:50  Running with dbt=1.7.9
09:49:50  Registered adapter: postgres=1.7.9
09:49:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:49:52  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:49:53.538+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:49:53.537+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuunwrr9w', '--profiles-dir', '/tmp/tmp6dzzg55p', '--profile', 'weather', '--target', 'dev'] due to the error:
09:49:50  Running with dbt=1.7.9
09:49:50  Registered adapter: postgres=1.7.9
09:49:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:49:52  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:49:53.539+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:49:53.554+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.164 seconds
[2025-06-20T09:50:23.884+0000] {processor.py:161} INFO - Started process (PID=1784) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:50:23.884+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:50:23.886+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:23.886+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:50:23.927+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:23.927+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:50:24.307+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.307+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:50:24.308+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:24.307+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:50:24.308+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.307+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:50:24.309+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.309+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:50:24.309+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:24.309+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:50:24.310+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.309+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:50:24.311+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.310+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:50:24.311+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:24.310+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:50:24.312+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.310+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:50:24.314+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.314+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp8kfho90b/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:50:24.314+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:24.314+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp8kfho90b/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:50:24.315+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.314+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp8kfho90b/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:50:24.315+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.315+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfgqhfgxy --profiles-dir /tmp/tmp8kfho90b --profile weather --target dev`
[2025-06-20T09:50:24.316+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:24.315+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfgqhfgxy --profiles-dir /tmp/tmp8kfho90b --profile weather --target dev`
[2025-06-20T09:50:24.316+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.315+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfgqhfgxy --profiles-dir /tmp/tmp8kfho90b --profile weather --target dev`
[2025-06-20T09:50:24.317+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.316+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:50:24.317+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:24.316+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:50:24.317+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:24.316+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:50:28.313+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:28.312+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfgqhfgxy --profiles-dir /tmp/tmp8kfho90b --profile weather --target dev`
[2025-06-20T09:50:28.313+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:28.312+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfgqhfgxy --profiles-dir /tmp/tmp8kfho90b --profile weather --target dev`
[2025-06-20T09:50:28.313+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:28.312+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfgqhfgxy --profiles-dir /tmp/tmp8kfho90b --profile weather --target dev`
[2025-06-20T09:50:28.314+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:28.313+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:50:28.314+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:28.313+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:50:28.314+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:28.313+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:50:34.083+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:50:34.081+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfgqhfgxy', '--profiles-dir', '/tmp/tmp8kfho90b', '--profile', 'weather', '--target', 'dev'] due to the error:
09:50:31  Running with dbt=1.7.9
09:50:31  Registered adapter: postgres=1.7.9
09:50:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:50:32  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:50:34.084+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:50:34.081+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfgqhfgxy', '--profiles-dir', '/tmp/tmp8kfho90b', '--profile', 'weather', '--target', 'dev'] due to the error:
09:50:31  Running with dbt=1.7.9
09:50:31  Registered adapter: postgres=1.7.9
09:50:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:50:32  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:50:34.085+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:50:34.105+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 10.224 seconds
[2025-06-20T09:51:04.671+0000] {processor.py:161} INFO - Started process (PID=1825) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:51:04.672+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:51:04.673+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:04.673+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:51:04.714+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:04.714+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:51:05.044+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.044+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:51:05.044+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:05.044+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:51:05.045+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.044+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:51:05.046+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.045+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:51:05.046+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:05.045+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:51:05.046+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.045+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:51:05.047+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.047+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:51:05.047+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:05.047+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:51:05.048+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.047+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:51:05.049+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.049+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpqwe5dwif/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:51:05.049+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:05.049+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpqwe5dwif/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:51:05.050+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.049+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpqwe5dwif/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:51:05.050+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.050+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0mv2p0yn --profiles-dir /tmp/tmpqwe5dwif --profile weather --target dev`
[2025-06-20T09:51:05.051+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:05.050+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0mv2p0yn --profiles-dir /tmp/tmpqwe5dwif --profile weather --target dev`
[2025-06-20T09:51:05.051+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.050+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0mv2p0yn --profiles-dir /tmp/tmpqwe5dwif --profile weather --target dev`
[2025-06-20T09:51:05.051+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.051+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:05.052+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:05.051+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:05.052+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:05.051+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:09.136+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:09.136+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0mv2p0yn --profiles-dir /tmp/tmpqwe5dwif --profile weather --target dev`
[2025-06-20T09:51:09.137+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:09.136+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0mv2p0yn --profiles-dir /tmp/tmpqwe5dwif --profile weather --target dev`
[2025-06-20T09:51:09.137+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:09.136+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0mv2p0yn --profiles-dir /tmp/tmpqwe5dwif --profile weather --target dev`
[2025-06-20T09:51:09.137+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:09.137+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:09.137+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:09.137+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:09.138+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:09.137+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:18.898+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:18.897+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0mv2p0yn', '--profiles-dir', '/tmp/tmpqwe5dwif', '--profile', 'weather', '--target', 'dev'] due to the error:
09:51:14  Running with dbt=1.7.9
09:51:15  Registered adapter: postgres=1.7.9
09:51:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:51:17  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:51:18.899+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:18.897+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0mv2p0yn', '--profiles-dir', '/tmp/tmpqwe5dwif', '--profile', 'weather', '--target', 'dev'] due to the error:
09:51:14  Running with dbt=1.7.9
09:51:15  Registered adapter: postgres=1.7.9
09:51:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:51:17  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:51:18.899+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:51:18.914+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.246 seconds
[2025-06-20T09:51:49.526+0000] {processor.py:161} INFO - Started process (PID=1870) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:51:49.526+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:51:49.528+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.528+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:51:49.567+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.567+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:51:49.942+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.941+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:51:49.942+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.941+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:51:49.942+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.941+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:51:49.943+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.943+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:51:49.943+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.943+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:51:49.944+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.943+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:51:49.944+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.944+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:51:49.945+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.944+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:51:49.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.944+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:51:49.946+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.946+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmprkczc1vx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:51:49.946+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.946+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmprkczc1vx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:51:49.947+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.946+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmprkczc1vx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:51:49.947+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.947+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj3r36mv9 --profiles-dir /tmp/tmprkczc1vx --profile weather --target dev`
[2025-06-20T09:51:49.947+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.947+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj3r36mv9 --profiles-dir /tmp/tmprkczc1vx --profile weather --target dev`
[2025-06-20T09:51:49.948+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.947+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj3r36mv9 --profiles-dir /tmp/tmprkczc1vx --profile weather --target dev`
[2025-06-20T09:51:49.948+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.948+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:49.949+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:49.948+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:49.949+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:49.948+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:54.312+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:54.311+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj3r36mv9 --profiles-dir /tmp/tmprkczc1vx --profile weather --target dev`
[2025-06-20T09:51:54.313+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:54.311+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj3r36mv9 --profiles-dir /tmp/tmprkczc1vx --profile weather --target dev`
[2025-06-20T09:51:54.313+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:54.311+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj3r36mv9 --profiles-dir /tmp/tmprkczc1vx --profile weather --target dev`
[2025-06-20T09:51:54.314+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:54.314+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:54.314+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:51:54.314+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:51:54.315+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:51:54.314+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:52:01.688+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:01.686+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpj3r36mv9', '--profiles-dir', '/tmp/tmprkczc1vx', '--profile', 'weather', '--target', 'dev'] due to the error:
09:51:58  Running with dbt=1.7.9
09:51:58  Registered adapter: postgres=1.7.9
09:51:58  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:52:00  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:52:01.689+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:01.686+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpj3r36mv9', '--profiles-dir', '/tmp/tmprkczc1vx', '--profile', 'weather', '--target', 'dev'] due to the error:
09:51:58  Running with dbt=1.7.9
09:51:58  Registered adapter: postgres=1.7.9
09:51:58  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:52:00  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:52:01.690+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:52:01.745+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.222 seconds
[2025-06-20T09:52:31.822+0000] {processor.py:161} INFO - Started process (PID=1910) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:52:31.823+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:52:31.824+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:31.824+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:52:31.864+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:31.863+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:52:32.239+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.238+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:52:32.239+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:32.238+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:52:32.240+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.238+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:52:32.241+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.240+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:52:32.241+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:32.240+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:52:32.242+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.240+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:52:32.243+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.242+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:52:32.243+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:32.242+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:52:32.244+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.242+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:52:32.246+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.245+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpbx3_0__0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:52:32.246+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:32.245+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpbx3_0__0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:52:32.247+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.245+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpbx3_0__0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:52:32.248+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.247+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8w79o5rd --profiles-dir /tmp/tmpbx3_0__0 --profile weather --target dev`
[2025-06-20T09:52:32.248+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:32.247+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8w79o5rd --profiles-dir /tmp/tmpbx3_0__0 --profile weather --target dev`
[2025-06-20T09:52:32.248+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.247+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8w79o5rd --profiles-dir /tmp/tmpbx3_0__0 --profile weather --target dev`
[2025-06-20T09:52:32.249+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.249+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:52:32.250+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:32.249+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:52:32.250+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:32.249+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:52:40.465+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:40.465+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8w79o5rd --profiles-dir /tmp/tmpbx3_0__0 --profile weather --target dev`
[2025-06-20T09:52:40.466+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:40.465+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8w79o5rd --profiles-dir /tmp/tmpbx3_0__0 --profile weather --target dev`
[2025-06-20T09:52:40.466+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:40.465+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8w79o5rd --profiles-dir /tmp/tmpbx3_0__0 --profile weather --target dev`
[2025-06-20T09:52:40.466+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:40.466+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:52:40.467+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:40.466+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:52:40.467+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:40.466+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:52:46.337+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:52:46.335+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8w79o5rd', '--profiles-dir', '/tmp/tmpbx3_0__0', '--profile', 'weather', '--target', 'dev'] due to the error:
09:52:43  Running with dbt=1.7.9
09:52:43  Registered adapter: postgres=1.7.9
09:52:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:52:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:52:46.337+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:52:46.335+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8w79o5rd', '--profiles-dir', '/tmp/tmpbx3_0__0', '--profile', 'weather', '--target', 'dev'] due to the error:
09:52:43  Running with dbt=1.7.9
09:52:43  Registered adapter: postgres=1.7.9
09:52:43  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:52:45  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:52:46.338+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:52:46.352+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.533 seconds
[2025-06-20T09:53:16.609+0000] {processor.py:161} INFO - Started process (PID=1965) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:53:16.610+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:53:16.613+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:16.613+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:53:16.674+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:16.673+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:53:17.199+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.199+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:53:17.200+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:17.199+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:53:17.200+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.199+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:53:17.201+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.201+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:53:17.201+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:17.201+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:53:17.202+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.201+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:53:17.203+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.202+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:53:17.203+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:17.202+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:53:17.204+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.202+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:53:17.205+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.205+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpd5w2dyea/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:53:17.206+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:17.205+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpd5w2dyea/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:53:17.206+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.205+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpd5w2dyea/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:53:17.207+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.207+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpc854twm5 --profiles-dir /tmp/tmpd5w2dyea --profile weather --target dev`
[2025-06-20T09:53:17.207+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:17.207+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpc854twm5 --profiles-dir /tmp/tmpd5w2dyea --profile weather --target dev`
[2025-06-20T09:53:17.208+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.207+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpc854twm5 --profiles-dir /tmp/tmpd5w2dyea --profile weather --target dev`
[2025-06-20T09:53:17.209+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.208+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:53:17.209+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:17.208+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:53:17.209+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:17.208+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:53:21.295+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:21.294+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpc854twm5 --profiles-dir /tmp/tmpd5w2dyea --profile weather --target dev`
[2025-06-20T09:53:21.295+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:21.294+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpc854twm5 --profiles-dir /tmp/tmpd5w2dyea --profile weather --target dev`
[2025-06-20T09:53:21.295+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:21.294+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpc854twm5 --profiles-dir /tmp/tmpd5w2dyea --profile weather --target dev`
[2025-06-20T09:53:21.296+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:21.295+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:53:21.296+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:21.295+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:53:21.296+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:21.295+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:53:29.497+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:53:29.496+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpc854twm5', '--profiles-dir', '/tmp/tmpd5w2dyea', '--profile', 'weather', '--target', 'dev'] due to the error:
09:53:24  Running with dbt=1.7.9
09:53:25  Registered adapter: postgres=1.7.9
09:53:25  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:53:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:53:29.498+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:53:29.496+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpc854twm5', '--profiles-dir', '/tmp/tmpd5w2dyea', '--profile', 'weather', '--target', 'dev'] due to the error:
09:53:24  Running with dbt=1.7.9
09:53:25  Registered adapter: postgres=1.7.9
09:53:25  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:53:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:53:29.499+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:53:29.519+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.914 seconds
[2025-06-20T09:54:00.311+0000] {processor.py:161} INFO - Started process (PID=2006) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:54:00.312+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:54:00.316+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.315+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:54:00.361+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.360+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:54:00.701+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.701+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:54:00.701+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.701+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:54:00.702+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.701+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:54:00.702+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.702+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:54:00.703+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.702+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:54:00.703+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.702+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:54:00.704+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.703+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:54:00.704+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.703+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:54:00.704+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.703+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:54:00.706+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.705+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpiyr29vxc/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:54:00.706+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.705+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpiyr29vxc/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:54:00.706+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.705+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpiyr29vxc/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:54:00.707+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.706+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1micsl5d --profiles-dir /tmp/tmpiyr29vxc --profile weather --target dev`
[2025-06-20T09:54:00.707+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.706+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1micsl5d --profiles-dir /tmp/tmpiyr29vxc --profile weather --target dev`
[2025-06-20T09:54:00.707+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.706+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1micsl5d --profiles-dir /tmp/tmpiyr29vxc --profile weather --target dev`
[2025-06-20T09:54:00.708+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.707+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:00.708+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:00.707+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:00.708+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:00.707+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:04.791+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:04.790+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1micsl5d --profiles-dir /tmp/tmpiyr29vxc --profile weather --target dev`
[2025-06-20T09:54:04.791+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:04.790+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1micsl5d --profiles-dir /tmp/tmpiyr29vxc --profile weather --target dev`
[2025-06-20T09:54:04.792+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:04.790+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1micsl5d --profiles-dir /tmp/tmpiyr29vxc --profile weather --target dev`
[2025-06-20T09:54:04.792+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:04.792+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:04.792+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:04.792+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:04.793+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:04.792+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:12.344+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:12.343+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1micsl5d', '--profiles-dir', '/tmp/tmpiyr29vxc', '--profile', 'weather', '--target', 'dev'] due to the error:
09:54:09  Running with dbt=1.7.9
09:54:09  Registered adapter: postgres=1.7.9
09:54:09  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:54:11  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:54:12.345+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:12.343+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1micsl5d', '--profiles-dir', '/tmp/tmpiyr29vxc', '--profile', 'weather', '--target', 'dev'] due to the error:
09:54:09  Running with dbt=1.7.9
09:54:09  Registered adapter: postgres=1.7.9
09:54:09  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:54:11  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:54:12.345+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:54:12.359+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.052 seconds
[2025-06-20T09:54:42.857+0000] {processor.py:161} INFO - Started process (PID=2048) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:54:42.858+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:54:42.860+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:42.859+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:54:42.906+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:42.906+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:54:43.227+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.226+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:54:43.227+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:43.226+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:54:43.227+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.226+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:54:43.228+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.228+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:54:43.228+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:43.228+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:54:43.229+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.228+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:54:43.229+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.229+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:54:43.229+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:43.229+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:54:43.230+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.229+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:54:43.231+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.231+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpn4bu6jab/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:54:43.231+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:43.231+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpn4bu6jab/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:54:43.231+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.231+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpn4bu6jab/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:54:43.232+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.232+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpszcij5ms --profiles-dir /tmp/tmpn4bu6jab --profile weather --target dev`
[2025-06-20T09:54:43.232+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:43.232+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpszcij5ms --profiles-dir /tmp/tmpn4bu6jab --profile weather --target dev`
[2025-06-20T09:54:43.233+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.232+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpszcij5ms --profiles-dir /tmp/tmpn4bu6jab --profile weather --target dev`
[2025-06-20T09:54:43.233+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.233+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:43.233+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:43.233+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:43.234+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:43.233+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:48.705+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:48.704+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpszcij5ms --profiles-dir /tmp/tmpn4bu6jab --profile weather --target dev`
[2025-06-20T09:54:48.705+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:48.704+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpszcij5ms --profiles-dir /tmp/tmpn4bu6jab --profile weather --target dev`
[2025-06-20T09:54:48.706+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:48.704+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpszcij5ms --profiles-dir /tmp/tmpn4bu6jab --profile weather --target dev`
[2025-06-20T09:54:48.706+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:48.706+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:48.706+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:48.706+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:48.707+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:48.706+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:54:56.367+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:54:56.366+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpszcij5ms', '--profiles-dir', '/tmp/tmpn4bu6jab', '--profile', 'weather', '--target', 'dev'] due to the error:
09:54:52  Running with dbt=1.7.9
09:54:52  Registered adapter: postgres=1.7.9
09:54:52  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:54:55  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:54:56.368+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:54:56.366+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpszcij5ms', '--profiles-dir', '/tmp/tmpn4bu6jab', '--profile', 'weather', '--target', 'dev'] due to the error:
09:54:52  Running with dbt=1.7.9
09:54:52  Registered adapter: postgres=1.7.9
09:54:52  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:54:55  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:54:56.368+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:54:56.383+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.528 seconds
[2025-06-20T09:55:26.492+0000] {processor.py:161} INFO - Started process (PID=2100) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:55:26.495+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:55:26.500+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:26.499+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:55:26.614+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:26.614+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:55:27.334+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.333+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:55:27.334+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:27.333+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:55:27.335+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.333+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:55:27.336+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.336+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:55:27.337+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:27.336+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:55:27.339+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.336+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:55:27.342+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.341+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:55:27.344+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:27.341+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:55:27.345+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.341+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:55:27.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.348+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfb3du6qn/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:55:27.349+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:27.348+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpfb3du6qn/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:55:27.350+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.348+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfb3du6qn/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:55:27.351+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.350+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzlpm9sis --profiles-dir /tmp/tmpfb3du6qn --profile weather --target dev`
[2025-06-20T09:55:27.351+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:27.350+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzlpm9sis --profiles-dir /tmp/tmpfb3du6qn --profile weather --target dev`
[2025-06-20T09:55:27.352+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.350+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzlpm9sis --profiles-dir /tmp/tmpfb3du6qn --profile weather --target dev`
[2025-06-20T09:55:27.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.352+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:55:27.353+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:27.352+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:55:27.354+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:27.352+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:55:33.274+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:33.273+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzlpm9sis --profiles-dir /tmp/tmpfb3du6qn --profile weather --target dev`
[2025-06-20T09:55:33.274+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:33.273+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzlpm9sis --profiles-dir /tmp/tmpfb3du6qn --profile weather --target dev`
[2025-06-20T09:55:33.275+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:33.273+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzlpm9sis --profiles-dir /tmp/tmpfb3du6qn --profile weather --target dev`
[2025-06-20T09:55:33.275+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:33.275+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:55:33.275+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:33.275+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:55:33.276+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:33.275+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:55:41.996+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:55:41.994+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzlpm9sis', '--profiles-dir', '/tmp/tmpfb3du6qn', '--profile', 'weather', '--target', 'dev'] due to the error:
09:55:36  Running with dbt=1.7.9
09:55:37  Registered adapter: postgres=1.7.9
09:55:37  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:55:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:55:41.997+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:55:41.994+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzlpm9sis', '--profiles-dir', '/tmp/tmpfb3du6qn', '--profile', 'weather', '--target', 'dev'] due to the error:
09:55:36  Running with dbt=1.7.9
09:55:37  Registered adapter: postgres=1.7.9
09:55:37  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:55:40  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:55:41.997+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:55:42.019+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.534 seconds
[2025-06-20T09:56:12.523+0000] {processor.py:161} INFO - Started process (PID=2141) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:56:12.524+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:56:12.525+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.525+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:56:12.565+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.564+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:56:12.978+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.978+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:56:12.979+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.978+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:56:12.979+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.978+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:56:12.980+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.980+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:56:12.980+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.980+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:56:12.980+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.980+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:56:12.981+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.981+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:56:12.981+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.981+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:56:12.982+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.981+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:56:12.983+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.983+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7_3fnltu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:56:12.983+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.983+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp7_3fnltu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:56:12.983+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.983+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7_3fnltu/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:56:12.984+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.984+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg88e7cmm --profiles-dir /tmp/tmp7_3fnltu --profile weather --target dev`
[2025-06-20T09:56:12.984+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.984+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg88e7cmm --profiles-dir /tmp/tmp7_3fnltu --profile weather --target dev`
[2025-06-20T09:56:12.985+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.984+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg88e7cmm --profiles-dir /tmp/tmp7_3fnltu --profile weather --target dev`
[2025-06-20T09:56:12.985+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.985+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:12.985+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:12.985+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:12.986+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:12.985+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:17.544+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:17.544+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg88e7cmm --profiles-dir /tmp/tmp7_3fnltu --profile weather --target dev`
[2025-06-20T09:56:17.545+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:17.544+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg88e7cmm --profiles-dir /tmp/tmp7_3fnltu --profile weather --target dev`
[2025-06-20T09:56:17.545+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:17.544+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg88e7cmm --profiles-dir /tmp/tmp7_3fnltu --profile weather --target dev`
[2025-06-20T09:56:17.545+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:17.545+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:17.546+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:17.545+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:17.546+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:17.545+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:25.230+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:25.228+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpg88e7cmm', '--profiles-dir', '/tmp/tmp7_3fnltu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:56:22  Running with dbt=1.7.9
09:56:22  Registered adapter: postgres=1.7.9
09:56:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:56:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:56:25.230+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:25.228+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpg88e7cmm', '--profiles-dir', '/tmp/tmp7_3fnltu', '--profile', 'weather', '--target', 'dev'] due to the error:
09:56:22  Running with dbt=1.7.9
09:56:22  Registered adapter: postgres=1.7.9
09:56:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:56:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:56:25.231+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:56:25.245+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.726 seconds
[2025-06-20T09:56:55.526+0000] {processor.py:161} INFO - Started process (PID=2185) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:56:55.527+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:56:55.528+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.528+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:56:55.567+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.567+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:56:55.907+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.907+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:56:55.908+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.907+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:56:55.908+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.907+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:56:55.909+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.908+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:56:55.909+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.908+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:56:55.909+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.908+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:56:55.910+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.910+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:56:55.910+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.910+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:56:55.910+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.910+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:56:55.912+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.912+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3veea8y7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:56:55.912+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.912+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp3veea8y7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:56:55.912+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.912+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp3veea8y7/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:56:55.913+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.913+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp22gbfg2k --profiles-dir /tmp/tmp3veea8y7 --profile weather --target dev`
[2025-06-20T09:56:55.913+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.913+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp22gbfg2k --profiles-dir /tmp/tmp3veea8y7 --profile weather --target dev`
[2025-06-20T09:56:55.913+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.913+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp22gbfg2k --profiles-dir /tmp/tmp3veea8y7 --profile weather --target dev`
[2025-06-20T09:56:55.914+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.913+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:55.914+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:56:55.913+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:56:55.914+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:56:55.913+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:03.871+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:03.870+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp22gbfg2k --profiles-dir /tmp/tmp3veea8y7 --profile weather --target dev`
[2025-06-20T09:57:03.872+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:03.870+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp22gbfg2k --profiles-dir /tmp/tmp3veea8y7 --profile weather --target dev`
[2025-06-20T09:57:03.872+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:03.870+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp22gbfg2k --profiles-dir /tmp/tmp3veea8y7 --profile weather --target dev`
[2025-06-20T09:57:03.873+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:03.872+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:03.873+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:03.872+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:03.874+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:03.872+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:10.484+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:10.482+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp22gbfg2k', '--profiles-dir', '/tmp/tmp3veea8y7', '--profile', 'weather', '--target', 'dev'] due to the error:
09:57:06  Running with dbt=1.7.9
09:57:07  Registered adapter: postgres=1.7.9
09:57:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:57:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:57:10.485+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:10.482+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp22gbfg2k', '--profiles-dir', '/tmp/tmp3veea8y7', '--profile', 'weather', '--target', 'dev'] due to the error:
09:57:06  Running with dbt=1.7.9
09:57:07  Registered adapter: postgres=1.7.9
09:57:07  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:57:08  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:57:10.486+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:57:10.507+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.984 seconds
[2025-06-20T09:57:41.161+0000] {processor.py:161} INFO - Started process (PID=2241) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:57:41.163+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:57:41.168+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:41.167+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:57:41.301+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:41.301+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:57:42.178+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.177+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:57:42.184+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:42.177+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:57:42.185+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.177+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:57:42.190+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.190+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:57:42.191+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:42.190+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:57:42.191+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.190+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:57:42.195+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.192+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:57:42.196+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:42.192+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:57:42.197+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.192+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:57:42.204+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.203+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdv_y9tx9/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:57:42.205+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:42.203+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpdv_y9tx9/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:57:42.207+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.203+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpdv_y9tx9/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:57:42.208+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.208+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpndun4s2w --profiles-dir /tmp/tmpdv_y9tx9 --profile weather --target dev`
[2025-06-20T09:57:42.209+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:42.208+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpndun4s2w --profiles-dir /tmp/tmpdv_y9tx9 --profile weather --target dev`
[2025-06-20T09:57:42.210+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.208+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpndun4s2w --profiles-dir /tmp/tmpdv_y9tx9 --profile weather --target dev`
[2025-06-20T09:57:42.211+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.210+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:42.212+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:42.210+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:42.214+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:42.210+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:51.818+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:51.817+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpndun4s2w --profiles-dir /tmp/tmpdv_y9tx9 --profile weather --target dev`
[2025-06-20T09:57:51.819+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:51.817+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpndun4s2w --profiles-dir /tmp/tmpdv_y9tx9 --profile weather --target dev`
[2025-06-20T09:57:51.819+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:51.817+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpndun4s2w --profiles-dir /tmp/tmpdv_y9tx9 --profile weather --target dev`
[2025-06-20T09:57:51.821+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:51.821+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:51.822+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:57:51.821+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:57:51.822+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:57:51.821+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:58:03.553+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:03.551+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpndun4s2w', '--profiles-dir', '/tmp/tmpdv_y9tx9', '--profile', 'weather', '--target', 'dev'] due to the error:
09:57:57  Running with dbt=1.7.9
09:57:58  Registered adapter: postgres=1.7.9
09:57:58  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:58:02  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:58:03.554+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:03.551+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpndun4s2w', '--profiles-dir', '/tmp/tmpdv_y9tx9', '--profile', 'weather', '--target', 'dev'] due to the error:
09:57:57  Running with dbt=1.7.9
09:57:58  Registered adapter: postgres=1.7.9
09:57:58  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:58:02  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:58:03.555+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:58:03.575+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 22.422 seconds
[2025-06-20T09:58:33.878+0000] {processor.py:161} INFO - Started process (PID=2305) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:58:33.880+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:58:33.882+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:33.882+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:58:33.953+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:33.952+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:58:34.602+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.602+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:58:34.603+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:34.602+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:58:34.604+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.602+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:58:34.605+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.604+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:58:34.605+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:34.604+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:58:34.606+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.604+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:58:34.607+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.606+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:58:34.607+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:34.606+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:58:34.608+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.606+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:58:34.610+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.609+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwhbt_z5k/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:58:34.610+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:34.609+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpwhbt_z5k/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:58:34.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.609+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpwhbt_z5k/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:58:34.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.611+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx14bj7o5 --profiles-dir /tmp/tmpwhbt_z5k --profile weather --target dev`
[2025-06-20T09:58:34.612+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:34.611+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx14bj7o5 --profiles-dir /tmp/tmpwhbt_z5k --profile weather --target dev`
[2025-06-20T09:58:34.612+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.611+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx14bj7o5 --profiles-dir /tmp/tmpwhbt_z5k --profile weather --target dev`
[2025-06-20T09:58:34.613+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.613+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:58:34.614+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:34.613+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:58:34.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:34.613+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:58:40.733+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:40.732+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx14bj7o5 --profiles-dir /tmp/tmpwhbt_z5k --profile weather --target dev`
[2025-06-20T09:58:40.733+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:40.732+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx14bj7o5 --profiles-dir /tmp/tmpwhbt_z5k --profile weather --target dev`
[2025-06-20T09:58:40.733+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:40.732+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx14bj7o5 --profiles-dir /tmp/tmpwhbt_z5k --profile weather --target dev`
[2025-06-20T09:58:40.734+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:40.733+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:58:40.734+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:40.733+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:58:40.734+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:40.733+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:58:50.920+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:58:50.918+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpx14bj7o5', '--profiles-dir', '/tmp/tmpwhbt_z5k', '--profile', 'weather', '--target', 'dev'] due to the error:
09:58:48  Running with dbt=1.7.9
09:58:48  Registered adapter: postgres=1.7.9
09:58:48  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:58:49  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:58:50.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:58:50.918+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpx14bj7o5', '--profiles-dir', '/tmp/tmpwhbt_z5k', '--profile', 'weather', '--target', 'dev'] due to the error:
09:58:48  Running with dbt=1.7.9
09:58:48  Registered adapter: postgres=1.7.9
09:58:48  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:58:49  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:58:50.921+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:58:50.935+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 17.061 seconds
[2025-06-20T09:59:21.219+0000] {processor.py:161} INFO - Started process (PID=2353) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:59:21.220+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T09:59:21.221+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.221+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:59:21.261+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.261+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T09:59:21.583+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.583+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:59:21.583+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.583+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:59:21.584+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.583+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T09:59:21.584+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.584+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:59:21.585+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.584+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:59:21.585+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.584+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T09:59:21.586+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.585+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:59:21.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.585+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T09:59:21.586+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.585+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T09:59:21.587+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.587+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpiuoojjaj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:59:21.588+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.587+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpiuoojjaj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T09:59:21.588+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.587+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpiuoojjaj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T09:59:21.588+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.588+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplvaandc7 --profiles-dir /tmp/tmpiuoojjaj --profile weather --target dev`
[2025-06-20T09:59:21.589+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.588+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplvaandc7 --profiles-dir /tmp/tmpiuoojjaj --profile weather --target dev`
[2025-06-20T09:59:21.589+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.588+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplvaandc7 --profiles-dir /tmp/tmpiuoojjaj --profile weather --target dev`
[2025-06-20T09:59:21.589+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.589+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:59:21.590+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:21.589+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:59:21.590+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:21.589+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:59:25.839+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:25.839+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplvaandc7 --profiles-dir /tmp/tmpiuoojjaj --profile weather --target dev`
[2025-06-20T09:59:25.840+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:25.839+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplvaandc7 --profiles-dir /tmp/tmpiuoojjaj --profile weather --target dev`
[2025-06-20T09:59:25.840+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:25.839+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplvaandc7 --profiles-dir /tmp/tmpiuoojjaj --profile weather --target dev`
[2025-06-20T09:59:25.840+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:25.840+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:59:25.841+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:25.840+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:59:25.841+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:25.840+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T09:59:33.608+0000] {logging_mixin.py:188} INFO - [2025-06-20T09:59:33.606+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmplvaandc7', '--profiles-dir', '/tmp/tmpiuoojjaj', '--profile', 'weather', '--target', 'dev'] due to the error:
09:59:30  Running with dbt=1.7.9
09:59:30  Registered adapter: postgres=1.7.9
09:59:30  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:59:32  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:59:33.609+0000] {logging_mixin.py:188} WARNING - [2025-06-20T09:59:33.606+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmplvaandc7', '--profiles-dir', '/tmp/tmpiuoojjaj', '--profile', 'weather', '--target', 'dev'] due to the error:
09:59:30  Running with dbt=1.7.9
09:59:30  Registered adapter: postgres=1.7.9
09:59:30  Unable to do partial parsing because saved manifest not found. Starting full parse.
09:59:32  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T09:59:33.609+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T09:59:33.630+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.413 seconds
[2025-06-20T10:00:04.085+0000] {processor.py:161} INFO - Started process (PID=2401) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:00:04.086+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:00:04.088+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.088+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:00:04.129+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.129+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:00:04.486+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.486+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:00:04.486+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.486+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:00:04.487+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.486+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:00:04.488+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.487+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:00:04.488+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.487+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:00:04.488+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.487+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:00:04.489+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.488+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:00:04.489+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.488+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:00:04.490+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.488+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:00:04.491+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.491+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkx3cozum/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:00:04.491+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.491+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpkx3cozum/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:00:04.491+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.491+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpkx3cozum/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:00:04.492+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.492+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpslfo46ve --profiles-dir /tmp/tmpkx3cozum --profile weather --target dev`
[2025-06-20T10:00:04.492+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.492+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpslfo46ve --profiles-dir /tmp/tmpkx3cozum --profile weather --target dev`
[2025-06-20T10:00:04.493+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.492+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpslfo46ve --profiles-dir /tmp/tmpkx3cozum --profile weather --target dev`
[2025-06-20T10:00:04.493+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.493+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:04.493+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:04.493+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:04.494+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:04.493+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:13.414+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:13.413+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpslfo46ve --profiles-dir /tmp/tmpkx3cozum --profile weather --target dev`
[2025-06-20T10:00:13.415+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:13.413+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpslfo46ve --profiles-dir /tmp/tmpkx3cozum --profile weather --target dev`
[2025-06-20T10:00:13.416+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:13.413+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpslfo46ve --profiles-dir /tmp/tmpkx3cozum --profile weather --target dev`
[2025-06-20T10:00:13.417+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:13.416+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:13.418+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:13.416+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:13.419+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:13.416+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:19.955+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:19.954+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpslfo46ve', '--profiles-dir', '/tmp/tmpkx3cozum', '--profile', 'weather', '--target', 'dev'] due to the error:
10:00:16  Running with dbt=1.7.9
10:00:17  Registered adapter: postgres=1.7.9
10:00:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:00:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:00:19.956+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:19.954+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpslfo46ve', '--profiles-dir', '/tmp/tmpkx3cozum', '--profile', 'weather', '--target', 'dev'] due to the error:
10:00:16  Running with dbt=1.7.9
10:00:17  Registered adapter: postgres=1.7.9
10:00:17  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:00:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:00:19.957+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:00:19.977+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.894 seconds
[2025-06-20T10:00:50.810+0000] {processor.py:161} INFO - Started process (PID=2455) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:00:50.811+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:00:50.814+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:50.813+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:00:50.875+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:50.875+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:00:51.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.353+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:00:51.354+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:51.353+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:00:51.354+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.353+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:00:51.356+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.355+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:00:51.356+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:51.355+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:00:51.356+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.355+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:00:51.358+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.357+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:00:51.358+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:51.357+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:00:51.358+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.357+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:00:51.360+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.360+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpcfglz945/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:00:51.361+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:51.360+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpcfglz945/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:00:51.361+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.360+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpcfglz945/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:00:51.362+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.362+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5u9o4_wl --profiles-dir /tmp/tmpcfglz945 --profile weather --target dev`
[2025-06-20T10:00:51.362+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:51.362+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5u9o4_wl --profiles-dir /tmp/tmpcfglz945 --profile weather --target dev`
[2025-06-20T10:00:51.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.362+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5u9o4_wl --profiles-dir /tmp/tmpcfglz945 --profile weather --target dev`
[2025-06-20T10:00:51.364+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.363+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:51.364+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:51.363+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:51.365+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:51.363+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:57.952+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:57.951+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5u9o4_wl --profiles-dir /tmp/tmpcfglz945 --profile weather --target dev`
[2025-06-20T10:00:57.953+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:57.951+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5u9o4_wl --profiles-dir /tmp/tmpcfglz945 --profile weather --target dev`
[2025-06-20T10:00:57.953+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:57.951+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5u9o4_wl --profiles-dir /tmp/tmpcfglz945 --profile weather --target dev`
[2025-06-20T10:00:57.954+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:57.953+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:57.954+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:00:57.953+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:00:57.955+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:00:57.953+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:01:05.247+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:01:05.245+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5u9o4_wl', '--profiles-dir', '/tmp/tmpcfglz945', '--profile', 'weather', '--target', 'dev'] due to the error:
10:01:01  Running with dbt=1.7.9
10:01:02  Registered adapter: postgres=1.7.9
10:01:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:01:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:01:05.248+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:01:05.245+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5u9o4_wl', '--profiles-dir', '/tmp/tmpcfglz945', '--profile', 'weather', '--target', 'dev'] due to the error:
10:01:01  Running with dbt=1.7.9
10:01:02  Registered adapter: postgres=1.7.9
10:01:02  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:01:03  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:01:05.249+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:01:05.269+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.462 seconds
[2025-06-20T10:03:05.464+0000] {processor.py:161} INFO - Started process (PID=62) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:03:05.467+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:03:05.473+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:05.471+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:03:05.695+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:05.694+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:03:06.438+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.437+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:03:06.438+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:06.437+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:03:06.438+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.437+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:03:06.441+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.441+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:03:06.441+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:06.441+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:03:06.442+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.441+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:03:06.442+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.442+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:03:06.443+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:06.442+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:03:06.443+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.442+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:03:06.445+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.444+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4hu65od0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:03:06.445+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:06.444+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp4hu65od0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:03:06.445+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.444+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4hu65od0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:03:06.446+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.446+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2itxpg1x --profiles-dir /tmp/tmp4hu65od0 --profile weather --target dev`
[2025-06-20T10:03:06.446+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:06.446+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2itxpg1x --profiles-dir /tmp/tmp4hu65od0 --profile weather --target dev`
[2025-06-20T10:03:06.447+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.446+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2itxpg1x --profiles-dir /tmp/tmp4hu65od0 --profile weather --target dev`
[2025-06-20T10:03:06.447+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.447+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:06.448+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:06.447+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:06.448+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:06.447+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:11.034+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:11.034+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2itxpg1x --profiles-dir /tmp/tmp4hu65od0 --profile weather --target dev`
[2025-06-20T10:03:11.035+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:11.034+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2itxpg1x --profiles-dir /tmp/tmp4hu65od0 --profile weather --target dev`
[2025-06-20T10:03:11.035+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:11.034+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2itxpg1x --profiles-dir /tmp/tmp4hu65od0 --profile weather --target dev`
[2025-06-20T10:03:11.036+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:11.035+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:11.036+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:11.035+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:11.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:11.035+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:18.306+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:18.304+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2itxpg1x', '--profiles-dir', '/tmp/tmp4hu65od0', '--profile', 'weather', '--target', 'dev'] due to the error:
10:03:15  Running with dbt=1.7.9
10:03:15  Registered adapter: postgres=1.7.9
10:03:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:03:16  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:03:18.307+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:18.304+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2itxpg1x', '--profiles-dir', '/tmp/tmp4hu65od0', '--profile', 'weather', '--target', 'dev'] due to the error:
10:03:15  Running with dbt=1.7.9
10:03:15  Registered adapter: postgres=1.7.9
10:03:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:03:16  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:03:18.308+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:03:18.341+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.885 seconds
[2025-06-20T10:03:48.670+0000] {processor.py:161} INFO - Started process (PID=106) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:03:48.671+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:03:48.672+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:48.672+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:03:48.714+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:48.714+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:03:49.123+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.123+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:03:49.124+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:49.123+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:03:49.124+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.123+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:03:49.125+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.125+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:03:49.125+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:49.125+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:03:49.125+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.125+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:03:49.126+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.126+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:03:49.126+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:49.126+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:03:49.127+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.126+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:03:49.128+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.128+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1edx0j7e/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:03:49.128+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:49.128+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp1edx0j7e/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:03:49.128+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.128+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1edx0j7e/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:03:49.129+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.129+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpp7tr2a_5 --profiles-dir /tmp/tmp1edx0j7e --profile weather --target dev`
[2025-06-20T10:03:49.129+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:49.129+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpp7tr2a_5 --profiles-dir /tmp/tmp1edx0j7e --profile weather --target dev`
[2025-06-20T10:03:49.129+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.129+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpp7tr2a_5 --profiles-dir /tmp/tmp1edx0j7e --profile weather --target dev`
[2025-06-20T10:03:49.130+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.129+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:49.130+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:49.129+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:49.130+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:49.129+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:53.504+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:53.503+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpp7tr2a_5 --profiles-dir /tmp/tmp1edx0j7e --profile weather --target dev`
[2025-06-20T10:03:53.504+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:53.503+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpp7tr2a_5 --profiles-dir /tmp/tmp1edx0j7e --profile weather --target dev`
[2025-06-20T10:03:53.504+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:53.503+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpp7tr2a_5 --profiles-dir /tmp/tmp1edx0j7e --profile weather --target dev`
[2025-06-20T10:03:53.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:53.504+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:53.505+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:03:53.504+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:03:53.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:03:53.504+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:04:00.486+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:00.485+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpp7tr2a_5', '--profiles-dir', '/tmp/tmp1edx0j7e', '--profile', 'weather', '--target', 'dev'] due to the error:
10:03:56  Running with dbt=1.7.9
10:03:57  Registered adapter: postgres=1.7.9
10:03:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:03:59  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:04:00.487+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:00.485+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpp7tr2a_5', '--profiles-dir', '/tmp/tmp1edx0j7e', '--profile', 'weather', '--target', 'dev'] due to the error:
10:03:56  Running with dbt=1.7.9
10:03:57  Registered adapter: postgres=1.7.9
10:03:57  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:03:59  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:04:00.488+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:04:00.510+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.843 seconds
[2025-06-20T10:04:30.631+0000] {processor.py:161} INFO - Started process (PID=153) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:04:30.633+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:04:30.638+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:30.637+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:04:30.751+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:30.751+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:04:31.696+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.696+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:04:31.697+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:31.696+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:04:31.697+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.696+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:04:31.699+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.698+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:04:31.699+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:31.698+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:04:31.699+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.698+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:04:31.701+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.700+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:04:31.701+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:31.700+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:04:31.701+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.700+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:04:31.703+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.703+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxnd84bpg/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:04:31.704+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:31.703+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpxnd84bpg/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:04:31.704+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.703+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpxnd84bpg/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:04:31.705+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.705+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7eydiu60 --profiles-dir /tmp/tmpxnd84bpg --profile weather --target dev`
[2025-06-20T10:04:31.706+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:31.705+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7eydiu60 --profiles-dir /tmp/tmpxnd84bpg --profile weather --target dev`
[2025-06-20T10:04:31.706+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.705+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7eydiu60 --profiles-dir /tmp/tmpxnd84bpg --profile weather --target dev`
[2025-06-20T10:04:31.707+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.706+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:04:31.707+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:31.706+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:04:31.708+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:31.706+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:04:36.937+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:36.936+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7eydiu60 --profiles-dir /tmp/tmpxnd84bpg --profile weather --target dev`
[2025-06-20T10:04:36.937+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:36.936+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7eydiu60 --profiles-dir /tmp/tmpxnd84bpg --profile weather --target dev`
[2025-06-20T10:04:36.938+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:36.936+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7eydiu60 --profiles-dir /tmp/tmpxnd84bpg --profile weather --target dev`
[2025-06-20T10:04:36.938+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:36.938+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:04:36.939+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:36.938+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:04:36.939+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:36.938+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:04:46.321+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:04:46.319+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7eydiu60', '--profiles-dir', '/tmp/tmpxnd84bpg', '--profile', 'weather', '--target', 'dev'] due to the error:
10:04:40  Running with dbt=1.7.9
10:04:41  Registered adapter: postgres=1.7.9
10:04:41  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:04:44  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:04:46.322+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:04:46.319+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7eydiu60', '--profiles-dir', '/tmp/tmpxnd84bpg', '--profile', 'weather', '--target', 'dev'] due to the error:
10:04:40  Running with dbt=1.7.9
10:04:41  Registered adapter: postgres=1.7.9
10:04:41  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:04:44  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:04:46.323+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:04:46.403+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.779 seconds
[2025-06-20T10:05:16.760+0000] {processor.py:161} INFO - Started process (PID=200) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:05:16.761+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:05:16.766+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:16.765+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:05:16.821+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:16.821+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:05:17.373+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.372+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:05:17.373+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:17.372+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:05:17.374+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.372+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:05:17.375+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.375+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:05:17.375+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:17.375+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:05:17.376+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.375+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:05:17.377+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.376+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:05:17.377+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:17.376+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:05:17.378+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.376+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:05:17.380+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.379+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpna7h1mp3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:05:17.380+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:17.379+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpna7h1mp3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:05:17.380+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.379+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpna7h1mp3/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:05:17.381+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.381+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjx2mafoz --profiles-dir /tmp/tmpna7h1mp3 --profile weather --target dev`
[2025-06-20T10:05:17.381+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:17.381+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjx2mafoz --profiles-dir /tmp/tmpna7h1mp3 --profile weather --target dev`
[2025-06-20T10:05:17.382+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.381+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjx2mafoz --profiles-dir /tmp/tmpna7h1mp3 --profile weather --target dev`
[2025-06-20T10:05:17.383+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.382+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:05:17.383+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:17.382+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:05:17.384+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:17.382+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:05:33.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:33.350+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjx2mafoz --profiles-dir /tmp/tmpna7h1mp3 --profile weather --target dev`
[2025-06-20T10:05:33.360+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:33.350+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjx2mafoz --profiles-dir /tmp/tmpna7h1mp3 --profile weather --target dev`
[2025-06-20T10:05:33.361+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:33.350+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjx2mafoz --profiles-dir /tmp/tmpna7h1mp3 --profile weather --target dev`
[2025-06-20T10:05:33.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:33.363+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:05:33.365+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:33.363+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:05:33.369+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:33.363+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:05:46.772+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:46.769+0000] {timeout.py:68} ERROR - Process timed out, PID: 200
[2025-06-20T10:05:46.773+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:46.769+0000] {timeout.py:68} ERROR - (astronomer-cosmos) - Process timed out, PID: 200
[2025-06-20T10:05:46.787+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:05:46.775+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 84, in run_command
    stdout, stderr = process.communicate()
  File "/usr/local/lib/python3.8/subprocess.py", line 1028, in communicate
    stdout, stderr = self._communicate(input, endtime, timeout)
  File "/usr/local/lib/python3.8/subprocess.py", line 1884, in _communicate
    ready = selector.select(timeout)
  File "/usr/local/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/weather_dbt_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.8.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.8.0/best-practices.html#reducing-dag-complexity, PID: 200
[2025-06-20T10:05:46.788+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:05:46.775+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 84, in run_command
    stdout, stderr = process.communicate()
  File "/usr/local/lib/python3.8/subprocess.py", line 1028, in communicate
    stdout, stderr = self._communicate(input, endtime, timeout)
  File "/usr/local/lib/python3.8/subprocess.py", line 1884, in _communicate
    ready = selector.select(timeout)
  File "/usr/local/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/weather_dbt_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.8.0/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.8.0/best-practices.html#reducing-dag-complexity, PID: 200
[2025-06-20T10:05:46.791+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:05:46.881+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 30.125 seconds
[2025-06-20T10:06:17.457+0000] {processor.py:161} INFO - Started process (PID=262) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:06:17.462+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:06:17.467+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:17.466+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:06:17.700+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:17.700+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:06:18.497+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.496+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:06:18.497+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:18.496+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:06:18.497+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.496+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:06:18.498+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.498+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:06:18.499+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:18.498+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:06:18.499+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.498+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:06:18.500+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.499+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:06:18.500+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:18.499+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:06:18.501+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.499+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:06:18.503+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.502+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2uhrtc8n/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:06:18.503+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:18.502+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp2uhrtc8n/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:06:18.503+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.502+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2uhrtc8n/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:06:18.504+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.504+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph3b7rajf --profiles-dir /tmp/tmp2uhrtc8n --profile weather --target dev`
[2025-06-20T10:06:18.504+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:18.504+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph3b7rajf --profiles-dir /tmp/tmp2uhrtc8n --profile weather --target dev`
[2025-06-20T10:06:18.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.504+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph3b7rajf --profiles-dir /tmp/tmp2uhrtc8n --profile weather --target dev`
[2025-06-20T10:06:18.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.505+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:06:18.506+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:18.505+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:06:18.506+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:18.505+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:06:23.765+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:23.765+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph3b7rajf --profiles-dir /tmp/tmp2uhrtc8n --profile weather --target dev`
[2025-06-20T10:06:23.765+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:23.765+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph3b7rajf --profiles-dir /tmp/tmp2uhrtc8n --profile weather --target dev`
[2025-06-20T10:06:23.766+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:23.765+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph3b7rajf --profiles-dir /tmp/tmp2uhrtc8n --profile weather --target dev`
[2025-06-20T10:06:23.766+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:23.766+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:06:23.766+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:23.766+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:06:23.767+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:23.766+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:06:29.573+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:06:29.572+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph3b7rajf', '--profiles-dir', '/tmp/tmp2uhrtc8n', '--profile', 'weather', '--target', 'dev'] due to the error:
10:06:26  Running with dbt=1.7.9
10:06:26  Registered adapter: postgres=1.7.9
10:06:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:06:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:06:29.574+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:06:29.572+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph3b7rajf', '--profiles-dir', '/tmp/tmp2uhrtc8n', '--profile', 'weather', '--target', 'dev'] due to the error:
10:06:26  Running with dbt=1.7.9
10:06:26  Registered adapter: postgres=1.7.9
10:06:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:06:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:06:29.575+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:06:29.598+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.147 seconds
[2025-06-20T10:07:00.050+0000] {processor.py:161} INFO - Started process (PID=306) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:07:00.051+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:07:00.052+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.052+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:07:00.095+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.095+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:07:00.427+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.427+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:07:00.427+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.427+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:07:00.428+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.427+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:07:00.429+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.428+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:07:00.429+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.428+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:07:00.429+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.428+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:07:00.430+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.429+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:07:00.430+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.429+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:07:00.430+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.429+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:07:00.432+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.432+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzrmn1cbk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:07:00.432+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.432+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpzrmn1cbk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:07:00.432+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.432+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzrmn1cbk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:07:00.433+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.433+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq1u64jrf --profiles-dir /tmp/tmpzrmn1cbk --profile weather --target dev`
[2025-06-20T10:07:00.433+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.433+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq1u64jrf --profiles-dir /tmp/tmpzrmn1cbk --profile weather --target dev`
[2025-06-20T10:07:00.433+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.433+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq1u64jrf --profiles-dir /tmp/tmpzrmn1cbk --profile weather --target dev`
[2025-06-20T10:07:00.434+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.434+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:00.434+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:00.434+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:00.435+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:00.434+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:04.776+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:04.775+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq1u64jrf --profiles-dir /tmp/tmpzrmn1cbk --profile weather --target dev`
[2025-06-20T10:07:04.776+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:04.775+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq1u64jrf --profiles-dir /tmp/tmpzrmn1cbk --profile weather --target dev`
[2025-06-20T10:07:04.777+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:04.775+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq1u64jrf --profiles-dir /tmp/tmpzrmn1cbk --profile weather --target dev`
[2025-06-20T10:07:04.777+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:04.777+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:04.777+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:04.777+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:04.778+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:04.777+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:12.915+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:12.908+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq1u64jrf', '--profiles-dir', '/tmp/tmpzrmn1cbk', '--profile', 'weather', '--target', 'dev'] due to the error:
10:07:07  Running with dbt=1.7.9
10:07:08  Registered adapter: postgres=1.7.9
10:07:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:07:10  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:07:12.916+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:12.908+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq1u64jrf', '--profiles-dir', '/tmp/tmpzrmn1cbk', '--profile', 'weather', '--target', 'dev'] due to the error:
10:07:07  Running with dbt=1.7.9
10:07:08  Registered adapter: postgres=1.7.9
10:07:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:07:10  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:07:12.918+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:07:12.990+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.943 seconds
[2025-06-20T10:07:43.296+0000] {processor.py:161} INFO - Started process (PID=355) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:07:43.297+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:07:43.299+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.299+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:07:43.338+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.338+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:07:43.705+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.704+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:07:43.705+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.704+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:07:43.705+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.704+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:07:43.706+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.706+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:07:43.706+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.706+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:07:43.706+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.706+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:07:43.707+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.707+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:07:43.707+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.707+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:07:43.708+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.707+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:07:43.709+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.709+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpn5ifn9we/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:07:43.709+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.709+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpn5ifn9we/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:07:43.709+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.709+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpn5ifn9we/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:07:43.710+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.710+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4bd_zeru --profiles-dir /tmp/tmpn5ifn9we --profile weather --target dev`
[2025-06-20T10:07:43.710+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.710+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4bd_zeru --profiles-dir /tmp/tmpn5ifn9we --profile weather --target dev`
[2025-06-20T10:07:43.710+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.710+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4bd_zeru --profiles-dir /tmp/tmpn5ifn9we --profile weather --target dev`
[2025-06-20T10:07:43.711+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.711+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:43.711+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:43.711+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:43.711+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:43.711+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:51.345+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:51.344+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4bd_zeru --profiles-dir /tmp/tmpn5ifn9we --profile weather --target dev`
[2025-06-20T10:07:51.348+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:51.344+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4bd_zeru --profiles-dir /tmp/tmpn5ifn9we --profile weather --target dev`
[2025-06-20T10:07:51.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:51.344+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4bd_zeru --profiles-dir /tmp/tmpn5ifn9we --profile weather --target dev`
[2025-06-20T10:07:51.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:51.349+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:51.350+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:51.349+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:51.352+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:51.349+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:07:58.652+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:07:58.650+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4bd_zeru', '--profiles-dir', '/tmp/tmpn5ifn9we', '--profile', 'weather', '--target', 'dev'] due to the error:
10:07:55  Running with dbt=1.7.9
10:07:56  Registered adapter: postgres=1.7.9
10:07:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:07:57  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:07:58.653+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:07:58.650+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4bd_zeru', '--profiles-dir', '/tmp/tmpn5ifn9we', '--profile', 'weather', '--target', 'dev'] due to the error:
10:07:55  Running with dbt=1.7.9
10:07:56  Registered adapter: postgres=1.7.9
10:07:56  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:07:57  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:07:58.653+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:07:58.693+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.400 seconds
[2025-06-20T10:08:28.780+0000] {processor.py:161} INFO - Started process (PID=401) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:08:28.781+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:08:28.782+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:28.782+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:08:28.823+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:28.822+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:08:29.155+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.155+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:08:29.156+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:29.155+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:08:29.156+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.155+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:08:29.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.156+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:08:29.157+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:29.156+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:08:29.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.156+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:08:29.158+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.157+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:08:29.158+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:29.157+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:08:29.158+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.157+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:08:29.160+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.159+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvmlr_t22/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:08:29.160+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:29.159+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpvmlr_t22/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:08:29.160+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.159+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpvmlr_t22/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:08:29.161+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.160+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa4kdvmfw --profiles-dir /tmp/tmpvmlr_t22 --profile weather --target dev`
[2025-06-20T10:08:29.161+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:29.160+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa4kdvmfw --profiles-dir /tmp/tmpvmlr_t22 --profile weather --target dev`
[2025-06-20T10:08:29.161+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.160+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa4kdvmfw --profiles-dir /tmp/tmpvmlr_t22 --profile weather --target dev`
[2025-06-20T10:08:29.162+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.161+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:08:29.162+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:29.161+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:08:29.162+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:29.161+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:08:35.786+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:35.785+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa4kdvmfw --profiles-dir /tmp/tmpvmlr_t22 --profile weather --target dev`
[2025-06-20T10:08:35.787+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:35.785+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa4kdvmfw --profiles-dir /tmp/tmpvmlr_t22 --profile weather --target dev`
[2025-06-20T10:08:35.787+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:35.785+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa4kdvmfw --profiles-dir /tmp/tmpvmlr_t22 --profile weather --target dev`
[2025-06-20T10:08:35.788+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:35.788+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:08:35.788+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:35.788+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:08:35.789+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:35.788+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:08:42.500+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:08:42.498+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa4kdvmfw', '--profiles-dir', '/tmp/tmpvmlr_t22', '--profile', 'weather', '--target', 'dev'] due to the error:
10:08:39  Running with dbt=1.7.9
10:08:40  Registered adapter: postgres=1.7.9
10:08:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:08:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:08:42.500+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:08:42.498+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa4kdvmfw', '--profiles-dir', '/tmp/tmpvmlr_t22', '--profile', 'weather', '--target', 'dev'] due to the error:
10:08:39  Running with dbt=1.7.9
10:08:40  Registered adapter: postgres=1.7.9
10:08:40  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:08:41  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:08:42.501+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:08:42.515+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.738 seconds
[2025-06-20T10:09:12.719+0000] {processor.py:161} INFO - Started process (PID=459) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:09:12.720+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:09:12.724+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:12.724+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:09:12.821+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:12.821+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:09:13.515+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.515+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:09:13.516+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:13.515+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:09:13.517+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.515+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:09:13.518+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.517+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:09:13.518+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:13.517+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:09:13.519+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.517+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:09:13.520+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.519+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:09:13.520+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:13.519+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:09:13.521+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.519+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:09:13.522+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.522+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg18c0beq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:09:13.523+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:13.522+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpg18c0beq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:09:13.523+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.522+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg18c0beq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:09:13.524+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.524+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpciils6p_ --profiles-dir /tmp/tmpg18c0beq --profile weather --target dev`
[2025-06-20T10:09:13.525+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:13.524+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpciils6p_ --profiles-dir /tmp/tmpg18c0beq --profile weather --target dev`
[2025-06-20T10:09:13.525+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.524+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpciils6p_ --profiles-dir /tmp/tmpg18c0beq --profile weather --target dev`
[2025-06-20T10:09:13.526+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.525+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:13.526+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:13.525+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:13.527+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:13.525+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:18.963+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:18.963+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpciils6p_ --profiles-dir /tmp/tmpg18c0beq --profile weather --target dev`
[2025-06-20T10:09:18.963+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:18.963+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpciils6p_ --profiles-dir /tmp/tmpg18c0beq --profile weather --target dev`
[2025-06-20T10:09:18.964+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:18.963+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpciils6p_ --profiles-dir /tmp/tmpg18c0beq --profile weather --target dev`
[2025-06-20T10:09:18.964+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:18.964+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:18.964+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:18.964+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:18.965+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:18.964+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:24.825+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:24.823+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpciils6p_', '--profiles-dir', '/tmp/tmpg18c0beq', '--profile', 'weather', '--target', 'dev'] due to the error:
10:09:21  Running with dbt=1.7.9
10:09:22  Registered adapter: postgres=1.7.9
10:09:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:09:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:09:24.826+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:24.823+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpciils6p_', '--profiles-dir', '/tmp/tmpg18c0beq', '--profile', 'weather', '--target', 'dev'] due to the error:
10:09:21  Running with dbt=1.7.9
10:09:22  Registered adapter: postgres=1.7.9
10:09:22  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:09:23  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:09:24.827+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:09:24.848+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.132 seconds
[2025-06-20T10:09:55.269+0000] {processor.py:161} INFO - Started process (PID=503) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:09:55.270+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:09:55.272+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.272+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:09:55.316+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.315+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:09:55.669+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.669+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:09:55.670+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.669+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:09:55.670+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.669+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:09:55.671+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.670+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:09:55.671+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.670+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:09:55.671+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.670+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:09:55.672+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.672+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:09:55.672+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.672+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:09:55.673+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.672+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:09:55.674+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.674+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpb5eghuqp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:09:55.674+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.674+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpb5eghuqp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:09:55.674+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.674+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpb5eghuqp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:09:55.675+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.675+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmps10uitrb --profiles-dir /tmp/tmpb5eghuqp --profile weather --target dev`
[2025-06-20T10:09:55.675+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.675+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmps10uitrb --profiles-dir /tmp/tmpb5eghuqp --profile weather --target dev`
[2025-06-20T10:09:55.675+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.675+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmps10uitrb --profiles-dir /tmp/tmpb5eghuqp --profile weather --target dev`
[2025-06-20T10:09:55.676+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.676+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:55.676+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:09:55.676+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:09:55.676+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:09:55.676+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:01.059+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:01.059+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmps10uitrb --profiles-dir /tmp/tmpb5eghuqp --profile weather --target dev`
[2025-06-20T10:10:01.060+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:01.059+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmps10uitrb --profiles-dir /tmp/tmpb5eghuqp --profile weather --target dev`
[2025-06-20T10:10:01.060+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:01.059+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmps10uitrb --profiles-dir /tmp/tmpb5eghuqp --profile weather --target dev`
[2025-06-20T10:10:01.060+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:01.060+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:01.061+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:01.060+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:01.061+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:01.060+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:08.841+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:08.836+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmps10uitrb', '--profiles-dir', '/tmp/tmpb5eghuqp', '--profile', 'weather', '--target', 'dev'] due to the error:
10:10:04  Running with dbt=1.7.9
10:10:04  Registered adapter: postgres=1.7.9
10:10:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:10:07  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:10:08.842+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:08.836+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmps10uitrb', '--profiles-dir', '/tmp/tmpb5eghuqp', '--profile', 'weather', '--target', 'dev'] due to the error:
10:10:04  Running with dbt=1.7.9
10:10:04  Registered adapter: postgres=1.7.9
10:10:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:10:07  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:10:08.843+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:10:08.865+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.600 seconds
[2025-06-20T10:10:39.539+0000] {processor.py:161} INFO - Started process (PID=545) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:10:39.539+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:10:39.541+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.541+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:10:39.580+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.580+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:10:39.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.944+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:10:39.945+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.944+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:10:39.946+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.944+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:10:39.947+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.947+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:10:39.947+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.947+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:10:39.948+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.947+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:10:39.949+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.948+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:10:39.949+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.948+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:10:39.950+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.948+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:10:39.952+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.952+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp86ixf6e_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:10:39.952+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.952+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp86ixf6e_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:10:39.953+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.952+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp86ixf6e_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:10:39.954+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.953+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr1mbelc0 --profiles-dir /tmp/tmp86ixf6e_ --profile weather --target dev`
[2025-06-20T10:10:39.954+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.953+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr1mbelc0 --profiles-dir /tmp/tmp86ixf6e_ --profile weather --target dev`
[2025-06-20T10:10:39.955+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.953+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr1mbelc0 --profiles-dir /tmp/tmp86ixf6e_ --profile weather --target dev`
[2025-06-20T10:10:39.956+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.955+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:39.956+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:39.955+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:39.957+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:39.955+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:45.578+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:45.576+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr1mbelc0 --profiles-dir /tmp/tmp86ixf6e_ --profile weather --target dev`
[2025-06-20T10:10:45.580+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:45.576+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr1mbelc0 --profiles-dir /tmp/tmp86ixf6e_ --profile weather --target dev`
[2025-06-20T10:10:45.580+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:45.576+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr1mbelc0 --profiles-dir /tmp/tmp86ixf6e_ --profile weather --target dev`
[2025-06-20T10:10:45.581+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:45.581+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:45.582+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:45.581+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:45.582+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:45.581+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:10:55.145+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:10:55.144+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpr1mbelc0', '--profiles-dir', '/tmp/tmp86ixf6e_', '--profile', 'weather', '--target', 'dev'] due to the error:
10:10:51  Running with dbt=1.7.9
10:10:52  Registered adapter: postgres=1.7.9
10:10:52  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:10:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:10:55.146+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:10:55.144+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpr1mbelc0', '--profiles-dir', '/tmp/tmp86ixf6e_', '--profile', 'weather', '--target', 'dev'] due to the error:
10:10:51  Running with dbt=1.7.9
10:10:52  Registered adapter: postgres=1.7.9
10:10:52  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:10:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:10:55.146+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:10:55.161+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.625 seconds
[2025-06-20T10:11:25.568+0000] {processor.py:161} INFO - Started process (PID=601) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:11:25.570+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:11:25.575+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:25.574+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:11:25.662+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:25.661+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:11:26.137+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.136+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:11:26.137+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:26.136+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:11:26.138+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.136+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:11:26.140+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.139+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:11:26.141+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:26.139+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:11:26.141+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.139+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:11:26.144+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.143+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:11:26.145+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:26.143+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:11:26.147+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.143+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:11:26.150+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.149+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfbnys1mq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:11:26.150+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:26.149+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpfbnys1mq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:11:26.151+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.149+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpfbnys1mq/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:11:26.152+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.151+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpb_fbsz1w --profiles-dir /tmp/tmpfbnys1mq --profile weather --target dev`
[2025-06-20T10:11:26.152+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:26.151+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpb_fbsz1w --profiles-dir /tmp/tmpfbnys1mq --profile weather --target dev`
[2025-06-20T10:11:26.153+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.151+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpb_fbsz1w --profiles-dir /tmp/tmpfbnys1mq --profile weather --target dev`
[2025-06-20T10:11:26.155+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.153+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:11:26.155+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:26.153+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:11:26.156+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:26.153+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:11:32.884+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:32.883+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpb_fbsz1w --profiles-dir /tmp/tmpfbnys1mq --profile weather --target dev`
[2025-06-20T10:11:32.884+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:32.883+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpb_fbsz1w --profiles-dir /tmp/tmpfbnys1mq --profile weather --target dev`
[2025-06-20T10:11:32.885+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:32.883+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpb_fbsz1w --profiles-dir /tmp/tmpfbnys1mq --profile weather --target dev`
[2025-06-20T10:11:32.885+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:32.885+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:11:32.885+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:32.885+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:11:32.885+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:32.885+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:11:39.830+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:11:39.829+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpb_fbsz1w', '--profiles-dir', '/tmp/tmpfbnys1mq', '--profile', 'weather', '--target', 'dev'] due to the error:
10:11:35  Running with dbt=1.7.9
10:11:36  Registered adapter: postgres=1.7.9
10:11:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:11:38  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:11:39.831+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:11:39.829+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpb_fbsz1w', '--profiles-dir', '/tmp/tmpfbnys1mq', '--profile', 'weather', '--target', 'dev'] due to the error:
10:11:35  Running with dbt=1.7.9
10:11:36  Registered adapter: postgres=1.7.9
10:11:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:11:38  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:11:39.831+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:11:39.847+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.285 seconds
[2025-06-20T10:12:09.929+0000] {processor.py:161} INFO - Started process (PID=653) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:12:09.930+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:12:09.933+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:09.932+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:12:10.037+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:10.037+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:12:10.600+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.600+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:12:10.601+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:10.600+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:12:10.601+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.600+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:12:10.602+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.602+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:12:10.603+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:10.602+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:12:10.603+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.602+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:12:10.604+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.604+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:12:10.605+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:10.604+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:12:10.605+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.604+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:12:10.608+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.608+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2m5nebpl/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:12:10.610+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:10.608+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp2m5nebpl/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:12:10.611+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.608+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2m5nebpl/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:12:10.612+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.611+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjkco7szk --profiles-dir /tmp/tmp2m5nebpl --profile weather --target dev`
[2025-06-20T10:12:10.613+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:10.611+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjkco7szk --profiles-dir /tmp/tmp2m5nebpl --profile weather --target dev`
[2025-06-20T10:12:10.613+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.611+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjkco7szk --profiles-dir /tmp/tmp2m5nebpl --profile weather --target dev`
[2025-06-20T10:12:10.614+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.614+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:10.615+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:10.614+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:10.615+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:10.614+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:16.046+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:16.046+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjkco7szk --profiles-dir /tmp/tmp2m5nebpl --profile weather --target dev`
[2025-06-20T10:12:16.047+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:16.046+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjkco7szk --profiles-dir /tmp/tmp2m5nebpl --profile weather --target dev`
[2025-06-20T10:12:16.047+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:16.046+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjkco7szk --profiles-dir /tmp/tmp2m5nebpl --profile weather --target dev`
[2025-06-20T10:12:16.047+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:16.047+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:16.048+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:16.047+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:16.048+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:16.047+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:23.370+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:23.369+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjkco7szk', '--profiles-dir', '/tmp/tmp2m5nebpl', '--profile', 'weather', '--target', 'dev'] due to the error:
10:12:19  Running with dbt=1.7.9
10:12:19  Registered adapter: postgres=1.7.9
10:12:19  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:12:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:12:23.371+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:23.369+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjkco7szk', '--profiles-dir', '/tmp/tmp2m5nebpl', '--profile', 'weather', '--target', 'dev'] due to the error:
10:12:19  Running with dbt=1.7.9
10:12:19  Registered adapter: postgres=1.7.9
10:12:19  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:12:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:12:23.371+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:12:23.385+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.461 seconds
[2025-06-20T10:12:53.634+0000] {processor.py:161} INFO - Started process (PID=702) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:12:53.635+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:12:53.636+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:53.636+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:12:53.675+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:53.675+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:12:54.003+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.002+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:12:54.003+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:54.002+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:12:54.003+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.002+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:12:54.004+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.004+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:12:54.004+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:54.004+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:12:54.004+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.004+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:12:54.005+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.005+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:12:54.005+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:54.005+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:12:54.006+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.005+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:12:54.007+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.007+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmppx_np_6r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:12:54.007+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:54.007+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmppx_np_6r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:12:54.007+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.007+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmppx_np_6r/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:12:54.008+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.008+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph5zage8a --profiles-dir /tmp/tmppx_np_6r --profile weather --target dev`
[2025-06-20T10:12:54.008+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:54.008+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph5zage8a --profiles-dir /tmp/tmppx_np_6r --profile weather --target dev`
[2025-06-20T10:12:54.009+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.008+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph5zage8a --profiles-dir /tmp/tmppx_np_6r --profile weather --target dev`
[2025-06-20T10:12:54.009+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.009+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:54.009+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:54.009+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:54.010+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:54.009+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:58.349+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:58.348+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph5zage8a --profiles-dir /tmp/tmppx_np_6r --profile weather --target dev`
[2025-06-20T10:12:58.350+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:58.348+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph5zage8a --profiles-dir /tmp/tmppx_np_6r --profile weather --target dev`
[2025-06-20T10:12:58.350+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:58.348+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph5zage8a --profiles-dir /tmp/tmppx_np_6r --profile weather --target dev`
[2025-06-20T10:12:58.351+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:58.351+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:58.351+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:12:58.351+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:12:58.352+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:12:58.351+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:13:06.919+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:06.913+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph5zage8a', '--profiles-dir', '/tmp/tmppx_np_6r', '--profile', 'weather', '--target', 'dev'] due to the error:
10:13:04  Running with dbt=1.7.9
10:13:04  Registered adapter: postgres=1.7.9
10:13:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:13:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:13:06.919+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:06.913+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph5zage8a', '--profiles-dir', '/tmp/tmppx_np_6r', '--profile', 'weather', '--target', 'dev'] due to the error:
10:13:04  Running with dbt=1.7.9
10:13:04  Registered adapter: postgres=1.7.9
10:13:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:13:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:13:06.922+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:13:06.953+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.322 seconds
[2025-06-20T10:13:37.762+0000] {processor.py:161} INFO - Started process (PID=748) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:13:37.763+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:13:37.768+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:37.768+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:13:37.839+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:37.839+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:13:38.250+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.249+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:13:38.250+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:38.249+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:13:38.250+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.249+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:13:38.251+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.251+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:13:38.252+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:38.251+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:13:38.252+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.251+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:13:38.255+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.252+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:13:38.255+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:38.252+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:13:38.256+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.252+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:13:38.258+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.257+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptao0a92k/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:13:38.258+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:38.257+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmptao0a92k/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:13:38.258+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.257+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptao0a92k/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:13:38.261+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.259+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcb2vdyj7 --profiles-dir /tmp/tmptao0a92k --profile weather --target dev`
[2025-06-20T10:13:38.261+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:38.259+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcb2vdyj7 --profiles-dir /tmp/tmptao0a92k --profile weather --target dev`
[2025-06-20T10:13:38.262+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.259+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcb2vdyj7 --profiles-dir /tmp/tmptao0a92k --profile weather --target dev`
[2025-06-20T10:13:38.263+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.262+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:13:38.263+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:38.262+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:13:38.265+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:38.262+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:13:44.594+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:44.593+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcb2vdyj7 --profiles-dir /tmp/tmptao0a92k --profile weather --target dev`
[2025-06-20T10:13:44.599+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:44.593+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcb2vdyj7 --profiles-dir /tmp/tmptao0a92k --profile weather --target dev`
[2025-06-20T10:13:44.600+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:44.593+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcb2vdyj7 --profiles-dir /tmp/tmptao0a92k --profile weather --target dev`
[2025-06-20T10:13:44.603+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:44.603+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:13:44.606+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:44.603+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:13:44.608+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:44.603+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:13:52.923+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:13:52.922+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpcb2vdyj7', '--profiles-dir', '/tmp/tmptao0a92k', '--profile', 'weather', '--target', 'dev'] due to the error:
10:13:48  Running with dbt=1.7.9
10:13:49  Registered adapter: postgres=1.7.9
10:13:49  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:13:51  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:13:52.924+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:13:52.922+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpcb2vdyj7', '--profiles-dir', '/tmp/tmptao0a92k', '--profile', 'weather', '--target', 'dev'] due to the error:
10:13:48  Running with dbt=1.7.9
10:13:49  Registered adapter: postgres=1.7.9
10:13:49  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:13:51  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:13:52.924+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:13:52.939+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.180 seconds
[2025-06-20T10:14:23.194+0000] {processor.py:161} INFO - Started process (PID=808) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:14:23.201+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:14:23.208+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:23.208+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:14:23.402+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:23.402+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:14:24.650+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.649+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:14:24.651+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:24.649+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:14:24.652+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.649+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:14:24.654+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.654+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:14:24.655+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:24.654+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:14:24.656+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.654+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:14:24.658+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.657+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:14:24.659+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:24.657+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:14:24.660+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.657+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:14:24.664+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.663+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpobao4sab/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:14:24.666+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:24.663+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpobao4sab/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:14:24.667+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.663+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpobao4sab/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:14:24.668+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.667+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpu0yxgbw7 --profiles-dir /tmp/tmpobao4sab --profile weather --target dev`
[2025-06-20T10:14:24.668+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:24.667+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpu0yxgbw7 --profiles-dir /tmp/tmpobao4sab --profile weather --target dev`
[2025-06-20T10:14:24.670+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.667+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpu0yxgbw7 --profiles-dir /tmp/tmpobao4sab --profile weather --target dev`
[2025-06-20T10:14:24.671+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.671+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:14:24.672+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:24.671+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:14:24.674+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:24.671+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:14:30.086+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:30.086+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpu0yxgbw7 --profiles-dir /tmp/tmpobao4sab --profile weather --target dev`
[2025-06-20T10:14:30.087+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:30.086+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpu0yxgbw7 --profiles-dir /tmp/tmpobao4sab --profile weather --target dev`
[2025-06-20T10:14:30.087+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:30.086+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpu0yxgbw7 --profiles-dir /tmp/tmpobao4sab --profile weather --target dev`
[2025-06-20T10:14:30.087+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:30.087+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:14:30.087+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:30.087+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:14:30.088+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:30.087+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:14:35.891+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:14:35.890+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpu0yxgbw7', '--profiles-dir', '/tmp/tmpobao4sab', '--profile', 'weather', '--target', 'dev'] due to the error:
10:14:32  Running with dbt=1.7.9
10:14:33  Registered adapter: postgres=1.7.9
10:14:33  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:14:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:14:35.892+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:14:35.890+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpu0yxgbw7', '--profiles-dir', '/tmp/tmpobao4sab', '--profile', 'weather', '--target', 'dev'] due to the error:
10:14:32  Running with dbt=1.7.9
10:14:33  Registered adapter: postgres=1.7.9
10:14:33  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:14:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:14:35.892+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:14:35.907+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.725 seconds
[2025-06-20T10:15:06.387+0000] {processor.py:161} INFO - Started process (PID=851) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:15:06.388+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:15:06.390+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.390+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:15:06.443+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.443+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:15:06.802+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.802+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:15:06.802+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.802+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:15:06.803+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.802+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:15:06.804+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.803+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:15:06.804+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.803+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:15:06.804+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.803+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:15:06.805+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.804+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:15:06.805+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.804+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:15:06.805+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.804+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:15:06.807+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.806+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpc_w0rxzr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:15:06.807+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.806+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpc_w0rxzr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:15:06.807+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.806+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpc_w0rxzr/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:15:06.808+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.808+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7v9362ri --profiles-dir /tmp/tmpc_w0rxzr --profile weather --target dev`
[2025-06-20T10:15:06.808+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.808+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7v9362ri --profiles-dir /tmp/tmpc_w0rxzr --profile weather --target dev`
[2025-06-20T10:15:06.808+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.808+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7v9362ri --profiles-dir /tmp/tmpc_w0rxzr --profile weather --target dev`
[2025-06-20T10:15:06.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.808+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:06.809+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:06.808+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:06.809+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:06.808+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:11.087+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:11.086+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7v9362ri --profiles-dir /tmp/tmpc_w0rxzr --profile weather --target dev`
[2025-06-20T10:15:11.087+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:11.086+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7v9362ri --profiles-dir /tmp/tmpc_w0rxzr --profile weather --target dev`
[2025-06-20T10:15:11.088+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:11.086+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7v9362ri --profiles-dir /tmp/tmpc_w0rxzr --profile weather --target dev`
[2025-06-20T10:15:11.088+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:11.088+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:11.088+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:11.088+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:11.089+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:11.088+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:19.486+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:19.484+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7v9362ri', '--profiles-dir', '/tmp/tmpc_w0rxzr', '--profile', 'weather', '--target', 'dev'] due to the error:
10:15:14  Running with dbt=1.7.9
10:15:15  Registered adapter: postgres=1.7.9
10:15:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:15:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:15:19.487+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:19.484+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7v9362ri', '--profiles-dir', '/tmp/tmpc_w0rxzr', '--profile', 'weather', '--target', 'dev'] due to the error:
10:15:14  Running with dbt=1.7.9
10:15:15  Registered adapter: postgres=1.7.9
10:15:15  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:15:18  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:15:19.487+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:15:19.507+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.124 seconds
[2025-06-20T10:15:50.375+0000] {processor.py:161} INFO - Started process (PID=903) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:15:50.376+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:15:50.378+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:50.378+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:15:50.438+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:50.438+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:15:51.012+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.011+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:15:51.012+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:51.011+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:15:51.013+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.011+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:15:51.014+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.014+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:15:51.014+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:51.014+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:15:51.015+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.014+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:15:51.016+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.015+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:15:51.016+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:51.015+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:15:51.017+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.015+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:15:51.019+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.018+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4wwao16p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:15:51.019+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:51.018+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp4wwao16p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:15:51.019+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.018+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp4wwao16p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:15:51.020+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.020+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi1vqdof_ --profiles-dir /tmp/tmp4wwao16p --profile weather --target dev`
[2025-06-20T10:15:51.021+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:51.020+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi1vqdof_ --profiles-dir /tmp/tmp4wwao16p --profile weather --target dev`
[2025-06-20T10:15:51.021+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.020+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi1vqdof_ --profiles-dir /tmp/tmp4wwao16p --profile weather --target dev`
[2025-06-20T10:15:51.022+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.021+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:51.022+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:51.021+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:51.023+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:51.021+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:55.361+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:55.360+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi1vqdof_ --profiles-dir /tmp/tmp4wwao16p --profile weather --target dev`
[2025-06-20T10:15:55.361+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:55.360+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi1vqdof_ --profiles-dir /tmp/tmp4wwao16p --profile weather --target dev`
[2025-06-20T10:15:55.362+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:55.360+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi1vqdof_ --profiles-dir /tmp/tmp4wwao16p --profile weather --target dev`
[2025-06-20T10:15:55.362+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:55.362+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:55.362+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:15:55.362+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:15:55.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:15:55.362+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:16:07.040+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:07.039+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpi1vqdof_', '--profiles-dir', '/tmp/tmp4wwao16p', '--profile', 'weather', '--target', 'dev'] due to the error:
10:16:00  Running with dbt=1.7.9
10:16:01  Registered adapter: postgres=1.7.9
10:16:01  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:16:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:16:07.040+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:07.039+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpi1vqdof_', '--profiles-dir', '/tmp/tmp4wwao16p', '--profile', 'weather', '--target', 'dev'] due to the error:
10:16:00  Running with dbt=1.7.9
10:16:01  Registered adapter: postgres=1.7.9
10:16:01  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:16:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:16:07.041+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:16:07.055+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 16.684 seconds
[2025-06-20T10:16:37.534+0000] {processor.py:161} INFO - Started process (PID=948) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:16:37.545+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:16:37.556+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:37.556+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:16:37.774+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:37.773+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:16:38.683+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.682+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:16:38.683+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:38.682+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:16:38.684+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.682+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:16:38.685+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.685+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:16:38.685+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:38.685+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:16:38.686+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.685+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:16:38.687+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.686+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:16:38.687+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:38.686+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:16:38.688+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.686+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:16:38.690+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.689+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpz8w8nuso/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:16:38.690+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:38.689+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpz8w8nuso/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:16:38.691+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.689+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpz8w8nuso/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:16:38.691+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.691+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1cy210hl --profiles-dir /tmp/tmpz8w8nuso --profile weather --target dev`
[2025-06-20T10:16:38.692+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:38.691+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1cy210hl --profiles-dir /tmp/tmpz8w8nuso --profile weather --target dev`
[2025-06-20T10:16:38.692+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.691+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1cy210hl --profiles-dir /tmp/tmpz8w8nuso --profile weather --target dev`
[2025-06-20T10:16:38.693+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.693+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:16:38.694+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:38.693+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:16:38.694+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:38.693+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:16:46.325+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:46.324+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1cy210hl --profiles-dir /tmp/tmpz8w8nuso --profile weather --target dev`
[2025-06-20T10:16:46.325+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:46.324+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1cy210hl --profiles-dir /tmp/tmpz8w8nuso --profile weather --target dev`
[2025-06-20T10:16:46.326+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:46.324+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1cy210hl --profiles-dir /tmp/tmpz8w8nuso --profile weather --target dev`
[2025-06-20T10:16:46.326+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:46.326+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:16:46.326+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:46.326+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:16:46.326+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:46.326+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:16:52.319+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:16:52.317+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1cy210hl', '--profiles-dir', '/tmp/tmpz8w8nuso', '--profile', 'weather', '--target', 'dev'] due to the error:
10:16:49  Running with dbt=1.7.9
10:16:49  Registered adapter: postgres=1.7.9
10:16:49  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:16:51  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:16:52.319+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:16:52.317+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1cy210hl', '--profiles-dir', '/tmp/tmpz8w8nuso', '--profile', 'weather', '--target', 'dev'] due to the error:
10:16:49  Running with dbt=1.7.9
10:16:49  Registered adapter: postgres=1.7.9
10:16:49  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:16:51  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:16:52.320+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:16:52.335+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.828 seconds
[2025-06-20T10:17:22.577+0000] {processor.py:161} INFO - Started process (PID=1006) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:17:22.578+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:17:22.580+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:22.580+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:17:22.646+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:22.646+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:17:23.113+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.112+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:17:23.113+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:23.112+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:17:23.114+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.112+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:17:23.115+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.115+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:17:23.115+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:23.115+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:17:23.116+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.115+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:17:23.117+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.116+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:17:23.117+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:23.116+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:17:23.118+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.116+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:17:23.120+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.119+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp_dtec92m/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:17:23.120+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:23.119+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp_dtec92m/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:17:23.121+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.119+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp_dtec92m/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:17:23.122+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.121+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuky7pk_1 --profiles-dir /tmp/tmp_dtec92m --profile weather --target dev`
[2025-06-20T10:17:23.122+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:23.121+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuky7pk_1 --profiles-dir /tmp/tmp_dtec92m --profile weather --target dev`
[2025-06-20T10:17:23.122+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.121+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuky7pk_1 --profiles-dir /tmp/tmp_dtec92m --profile weather --target dev`
[2025-06-20T10:17:23.124+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.123+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:17:23.124+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:23.123+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:17:23.125+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:23.123+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:17:27.853+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:27.852+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuky7pk_1 --profiles-dir /tmp/tmp_dtec92m --profile weather --target dev`
[2025-06-20T10:17:27.854+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:27.852+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuky7pk_1 --profiles-dir /tmp/tmp_dtec92m --profile weather --target dev`
[2025-06-20T10:17:27.854+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:27.852+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuky7pk_1 --profiles-dir /tmp/tmp_dtec92m --profile weather --target dev`
[2025-06-20T10:17:27.854+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:27.854+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:17:27.855+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:27.854+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:17:27.855+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:27.854+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:17:35.517+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:17:35.515+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuky7pk_1', '--profiles-dir', '/tmp/tmp_dtec92m', '--profile', 'weather', '--target', 'dev'] due to the error:
10:17:31  Running with dbt=1.7.9
10:17:31  Registered adapter: postgres=1.7.9
10:17:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:17:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:17:35.518+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:17:35.515+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuky7pk_1', '--profiles-dir', '/tmp/tmp_dtec92m', '--profile', 'weather', '--target', 'dev'] due to the error:
10:17:31  Running with dbt=1.7.9
10:17:31  Registered adapter: postgres=1.7.9
10:17:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:17:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:17:35.519+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:17:35.539+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.966 seconds
[2025-06-20T10:18:06.194+0000] {processor.py:161} INFO - Started process (PID=1050) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:18:06.196+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:18:06.198+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:06.197+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:18:06.265+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:06.264+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:18:07.003+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.002+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:18:07.003+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:07.002+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:18:07.004+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.002+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:18:07.005+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.005+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:18:07.005+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:07.005+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:18:07.006+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.005+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:18:07.007+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.006+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:18:07.007+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:07.006+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:18:07.008+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.006+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:18:07.010+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.009+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpf3j1mtwp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:18:07.010+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:07.009+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpf3j1mtwp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:18:07.011+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.009+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpf3j1mtwp/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:18:07.012+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.011+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt_1o7rc9 --profiles-dir /tmp/tmpf3j1mtwp --profile weather --target dev`
[2025-06-20T10:18:07.012+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:07.011+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt_1o7rc9 --profiles-dir /tmp/tmpf3j1mtwp --profile weather --target dev`
[2025-06-20T10:18:07.012+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.011+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt_1o7rc9 --profiles-dir /tmp/tmpf3j1mtwp --profile weather --target dev`
[2025-06-20T10:18:07.013+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.013+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:07.014+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:07.013+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:07.014+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:07.013+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:11.983+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:11.983+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt_1o7rc9 --profiles-dir /tmp/tmpf3j1mtwp --profile weather --target dev`
[2025-06-20T10:18:11.984+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:11.983+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt_1o7rc9 --profiles-dir /tmp/tmpf3j1mtwp --profile weather --target dev`
[2025-06-20T10:18:11.985+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:11.983+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt_1o7rc9 --profiles-dir /tmp/tmpf3j1mtwp --profile weather --target dev`
[2025-06-20T10:18:11.986+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:11.985+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:11.987+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:11.985+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:11.988+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:11.985+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:21.026+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:21.024+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpt_1o7rc9', '--profiles-dir', '/tmp/tmpf3j1mtwp', '--profile', 'weather', '--target', 'dev'] due to the error:
10:18:15  Running with dbt=1.7.9
10:18:16  Registered adapter: postgres=1.7.9
10:18:16  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:18:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:18:21.027+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:21.024+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpt_1o7rc9', '--profiles-dir', '/tmp/tmpf3j1mtwp', '--profile', 'weather', '--target', 'dev'] due to the error:
10:18:15  Running with dbt=1.7.9
10:18:16  Registered adapter: postgres=1.7.9
10:18:16  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:18:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:18:21.027+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:18:21.048+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.860 seconds
[2025-06-20T10:18:52.080+0000] {processor.py:161} INFO - Started process (PID=1097) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:18:52.084+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:18:52.087+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:52.087+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:18:52.209+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:52.207+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:18:53.007+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.006+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:18:53.007+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:53.006+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:18:53.007+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.006+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:18:53.008+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.008+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:18:53.009+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:53.008+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:18:53.009+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.008+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:18:53.010+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.009+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:18:53.011+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:53.009+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:18:53.012+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.009+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:18:53.015+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.014+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpb8q271mk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:18:53.016+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:53.014+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpb8q271mk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:18:53.017+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.014+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpb8q271mk/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:18:53.019+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.018+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuax8smq8 --profiles-dir /tmp/tmpb8q271mk --profile weather --target dev`
[2025-06-20T10:18:53.019+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:53.018+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuax8smq8 --profiles-dir /tmp/tmpb8q271mk --profile weather --target dev`
[2025-06-20T10:18:53.021+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.018+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuax8smq8 --profiles-dir /tmp/tmpb8q271mk --profile weather --target dev`
[2025-06-20T10:18:53.022+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.021+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:53.022+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:18:53.021+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:18:53.023+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:18:53.021+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:01.332+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:01.332+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuax8smq8 --profiles-dir /tmp/tmpb8q271mk --profile weather --target dev`
[2025-06-20T10:19:01.333+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:01.332+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuax8smq8 --profiles-dir /tmp/tmpb8q271mk --profile weather --target dev`
[2025-06-20T10:19:01.333+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:01.332+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuax8smq8 --profiles-dir /tmp/tmpb8q271mk --profile weather --target dev`
[2025-06-20T10:19:01.333+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:01.333+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:01.334+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:01.333+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:01.334+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:01.333+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:06.781+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:06.779+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuax8smq8', '--profiles-dir', '/tmp/tmpb8q271mk', '--profile', 'weather', '--target', 'dev'] due to the error:
10:19:04  Running with dbt=1.7.9
10:19:04  Registered adapter: postgres=1.7.9
10:19:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:19:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:19:06.781+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:06.779+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuax8smq8', '--profiles-dir', '/tmp/tmpb8q271mk', '--profile', 'weather', '--target', 'dev'] due to the error:
10:19:04  Running with dbt=1.7.9
10:19:04  Registered adapter: postgres=1.7.9
10:19:04  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:19:05  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:19:06.782+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:19:06.801+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.728 seconds
[2025-06-20T10:19:37.338+0000] {processor.py:161} INFO - Started process (PID=1152) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:19:37.339+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:19:37.342+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.342+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:19:37.403+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.403+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:19:37.875+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.875+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:19:37.876+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.875+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:19:37.876+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.875+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:19:37.878+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.877+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:19:37.878+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.877+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:19:37.878+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.877+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:19:37.880+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.879+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:19:37.880+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.879+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:19:37.880+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.879+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:19:37.883+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.882+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2tecpdxz/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:19:37.883+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.882+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp2tecpdxz/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:19:37.884+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.882+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp2tecpdxz/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:19:37.885+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.885+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpufjygn41 --profiles-dir /tmp/tmp2tecpdxz --profile weather --target dev`
[2025-06-20T10:19:37.885+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.885+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpufjygn41 --profiles-dir /tmp/tmp2tecpdxz --profile weather --target dev`
[2025-06-20T10:19:37.886+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.885+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpufjygn41 --profiles-dir /tmp/tmp2tecpdxz --profile weather --target dev`
[2025-06-20T10:19:37.887+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.886+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:37.887+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:37.886+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:37.890+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:37.886+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:43.448+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:43.447+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpufjygn41 --profiles-dir /tmp/tmp2tecpdxz --profile weather --target dev`
[2025-06-20T10:19:43.448+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:43.447+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpufjygn41 --profiles-dir /tmp/tmp2tecpdxz --profile weather --target dev`
[2025-06-20T10:19:43.448+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:43.447+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpufjygn41 --profiles-dir /tmp/tmp2tecpdxz --profile weather --target dev`
[2025-06-20T10:19:43.449+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:43.448+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:43.449+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:43.448+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:43.449+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:43.448+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:19:50.287+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:19:50.285+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpufjygn41', '--profiles-dir', '/tmp/tmp2tecpdxz', '--profile', 'weather', '--target', 'dev'] due to the error:
10:19:46  Running with dbt=1.7.9
10:19:46  Registered adapter: postgres=1.7.9
10:19:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:19:48  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:19:50.288+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:19:50.285+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpufjygn41', '--profiles-dir', '/tmp/tmp2tecpdxz', '--profile', 'weather', '--target', 'dev'] due to the error:
10:19:46  Running with dbt=1.7.9
10:19:46  Registered adapter: postgres=1.7.9
10:19:46  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:19:48  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:19:50.288+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:19:50.311+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.977 seconds
[2025-06-20T10:20:20.500+0000] {processor.py:161} INFO - Started process (PID=1196) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:20:20.501+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:20:20.506+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:20.505+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:20:20.628+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:20.626+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:20:21.290+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.290+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:20:21.292+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:21.290+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:20:21.293+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.290+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:20:21.295+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.294+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:20:21.295+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:21.294+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:20:21.295+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.294+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:20:21.296+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.296+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:20:21.297+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:21.296+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:20:21.297+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.296+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:20:21.299+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.299+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzutnf5us/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:20:21.299+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:21.299+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpzutnf5us/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:20:21.299+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.299+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpzutnf5us/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:20:21.300+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.300+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoex_yf5h --profiles-dir /tmp/tmpzutnf5us --profile weather --target dev`
[2025-06-20T10:20:21.301+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:21.300+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoex_yf5h --profiles-dir /tmp/tmpzutnf5us --profile weather --target dev`
[2025-06-20T10:20:21.301+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.300+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpoex_yf5h --profiles-dir /tmp/tmpzutnf5us --profile weather --target dev`
[2025-06-20T10:20:21.302+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.301+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:20:21.302+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:21.301+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:20:21.302+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:21.301+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:20:27.354+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:27.354+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoex_yf5h --profiles-dir /tmp/tmpzutnf5us --profile weather --target dev`
[2025-06-20T10:20:27.355+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:27.354+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoex_yf5h --profiles-dir /tmp/tmpzutnf5us --profile weather --target dev`
[2025-06-20T10:20:27.355+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:27.354+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpoex_yf5h --profiles-dir /tmp/tmpzutnf5us --profile weather --target dev`
[2025-06-20T10:20:27.355+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:27.355+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:20:27.356+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:27.355+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:20:27.356+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:27.355+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:20:36.032+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:20:36.031+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpoex_yf5h', '--profiles-dir', '/tmp/tmpzutnf5us', '--profile', 'weather', '--target', 'dev'] due to the error:
10:20:30  Running with dbt=1.7.9
10:20:31  Registered adapter: postgres=1.7.9
10:20:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:20:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:20:36.033+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:20:36.031+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpoex_yf5h', '--profiles-dir', '/tmp/tmpzutnf5us', '--profile', 'weather', '--target', 'dev'] due to the error:
10:20:30  Running with dbt=1.7.9
10:20:31  Registered adapter: postgres=1.7.9
10:20:31  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:20:34  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:20:36.034+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:20:36.052+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.558 seconds
[2025-06-20T10:21:06.556+0000] {processor.py:161} INFO - Started process (PID=1248) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:21:06.557+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:21:06.558+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.558+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:21:06.598+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.597+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:21:06.934+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.934+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:21:06.935+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.934+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:21:06.935+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.934+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:21:06.936+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.936+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:21:06.937+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.936+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:21:06.937+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.936+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:21:06.939+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.938+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:21:06.939+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.938+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:21:06.939+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.938+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:21:06.941+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.941+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpihswpum0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:21:06.942+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.941+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpihswpum0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:21:06.942+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.941+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpihswpum0/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:21:06.943+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.943+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm1kx7_62 --profiles-dir /tmp/tmpihswpum0 --profile weather --target dev`
[2025-06-20T10:21:06.943+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.943+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm1kx7_62 --profiles-dir /tmp/tmpihswpum0 --profile weather --target dev`
[2025-06-20T10:21:06.944+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.943+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm1kx7_62 --profiles-dir /tmp/tmpihswpum0 --profile weather --target dev`
[2025-06-20T10:21:06.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.944+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:06.945+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:06.944+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:06.946+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:06.944+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:11.101+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:11.100+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm1kx7_62 --profiles-dir /tmp/tmpihswpum0 --profile weather --target dev`
[2025-06-20T10:21:11.101+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:11.100+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm1kx7_62 --profiles-dir /tmp/tmpihswpum0 --profile weather --target dev`
[2025-06-20T10:21:11.102+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:11.100+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm1kx7_62 --profiles-dir /tmp/tmpihswpum0 --profile weather --target dev`
[2025-06-20T10:21:11.102+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:11.102+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:11.103+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:11.102+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:11.103+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:11.102+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:20.973+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:20.972+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpm1kx7_62', '--profiles-dir', '/tmp/tmpihswpum0', '--profile', 'weather', '--target', 'dev'] due to the error:
10:21:17  Running with dbt=1.7.9
10:21:18  Registered adapter: postgres=1.7.9
10:21:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:21:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:21:20.974+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:20.972+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpm1kx7_62', '--profiles-dir', '/tmp/tmpihswpum0', '--profile', 'weather', '--target', 'dev'] due to the error:
10:21:17  Running with dbt=1.7.9
10:21:18  Registered adapter: postgres=1.7.9
10:21:18  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:21:19  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:21:20.974+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:21:20.989+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.436 seconds
[2025-06-20T10:21:51.110+0000] {processor.py:161} INFO - Started process (PID=1294) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:21:51.111+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:21:51.113+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.113+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:21:51.152+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.152+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:21:51.456+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.455+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:21:51.456+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.455+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:21:51.456+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.455+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:21:51.457+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.457+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:21:51.457+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.457+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:21:51.457+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.457+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:21:51.458+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.458+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:21:51.458+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.458+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:21:51.459+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.458+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:21:51.460+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.460+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg612rrcy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:21:51.460+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.460+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpg612rrcy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:21:51.460+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.460+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg612rrcy/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:21:51.461+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.461+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxmoshhhp --profiles-dir /tmp/tmpg612rrcy --profile weather --target dev`
[2025-06-20T10:21:51.461+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.461+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxmoshhhp --profiles-dir /tmp/tmpg612rrcy --profile weather --target dev`
[2025-06-20T10:21:51.462+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.461+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxmoshhhp --profiles-dir /tmp/tmpg612rrcy --profile weather --target dev`
[2025-06-20T10:21:51.462+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.462+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:51.462+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:51.462+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:51.463+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:51.462+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:55.976+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:55.976+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxmoshhhp --profiles-dir /tmp/tmpg612rrcy --profile weather --target dev`
[2025-06-20T10:21:55.977+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:55.976+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxmoshhhp --profiles-dir /tmp/tmpg612rrcy --profile weather --target dev`
[2025-06-20T10:21:55.978+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:55.976+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxmoshhhp --profiles-dir /tmp/tmpg612rrcy --profile weather --target dev`
[2025-06-20T10:21:55.978+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:55.978+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:55.979+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:21:55.978+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:21:55.979+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:21:55.978+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:22:02.531+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:02.530+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxmoshhhp', '--profiles-dir', '/tmp/tmpg612rrcy', '--profile', 'weather', '--target', 'dev'] due to the error:
10:21:59  Running with dbt=1.7.9
10:22:00  Registered adapter: postgres=1.7.9
10:22:00  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:22:01  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:22:02.532+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:02.530+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxmoshhhp', '--profiles-dir', '/tmp/tmpg612rrcy', '--profile', 'weather', '--target', 'dev'] due to the error:
10:21:59  Running with dbt=1.7.9
10:22:00  Registered adapter: postgres=1.7.9
10:22:00  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:22:01  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:22:02.532+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:22:02.546+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.438 seconds
[2025-06-20T10:22:32.972+0000] {processor.py:161} INFO - Started process (PID=1343) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:22:32.972+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:22:32.974+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:32.974+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:22:33.013+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:33.013+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:22:33.358+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.358+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:22:33.359+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:33.358+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:22:33.359+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.358+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:22:33.360+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.359+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:22:33.360+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:33.359+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:22:33.360+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.359+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:22:33.361+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.361+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:22:33.361+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:33.361+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:22:33.361+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.361+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:22:33.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.363+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpsj9f8ock/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:22:33.363+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:33.363+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpsj9f8ock/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:22:33.363+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.363+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpsj9f8ock/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:22:33.364+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.364+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwxtweemb --profiles-dir /tmp/tmpsj9f8ock --profile weather --target dev`
[2025-06-20T10:22:33.364+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:33.364+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwxtweemb --profiles-dir /tmp/tmpsj9f8ock --profile weather --target dev`
[2025-06-20T10:22:33.364+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.364+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwxtweemb --profiles-dir /tmp/tmpsj9f8ock --profile weather --target dev`
[2025-06-20T10:22:33.365+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.364+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:22:33.365+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:33.364+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:22:33.365+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:33.364+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:22:38.532+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:38.530+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwxtweemb --profiles-dir /tmp/tmpsj9f8ock --profile weather --target dev`
[2025-06-20T10:22:38.532+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:38.530+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwxtweemb --profiles-dir /tmp/tmpsj9f8ock --profile weather --target dev`
[2025-06-20T10:22:38.533+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:38.530+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwxtweemb --profiles-dir /tmp/tmpsj9f8ock --profile weather --target dev`
[2025-06-20T10:22:38.534+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:38.533+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:22:38.536+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:38.533+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:22:38.539+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:38.533+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:22:47.846+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:22:47.844+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwxtweemb', '--profiles-dir', '/tmp/tmpsj9f8ock', '--profile', 'weather', '--target', 'dev'] due to the error:
10:22:44  Running with dbt=1.7.9
10:22:44  Registered adapter: postgres=1.7.9
10:22:44  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:22:46  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:22:47.847+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:22:47.844+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwxtweemb', '--profiles-dir', '/tmp/tmpsj9f8ock', '--profile', 'weather', '--target', 'dev'] due to the error:
10:22:44  Running with dbt=1.7.9
10:22:44  Registered adapter: postgres=1.7.9
10:22:44  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:22:46  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:22:47.848+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:22:47.869+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.899 seconds
[2025-06-20T10:23:18.408+0000] {processor.py:161} INFO - Started process (PID=1397) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:23:18.411+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:23:18.415+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:18.415+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:23:18.561+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:18.560+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:23:19.471+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.471+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:23:19.476+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:19.471+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:23:19.478+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.471+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:23:19.479+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.479+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:23:19.485+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:19.479+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:23:19.486+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.479+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:23:19.489+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.488+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:23:19.492+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:19.488+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:23:19.493+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.488+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:23:19.499+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.498+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1q39rp5z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:23:19.501+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:19.498+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp1q39rp5z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:23:19.502+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.498+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp1q39rp5z/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:23:19.505+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.504+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt8tki06a --profiles-dir /tmp/tmp1q39rp5z --profile weather --target dev`
[2025-06-20T10:23:19.505+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:19.504+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt8tki06a --profiles-dir /tmp/tmp1q39rp5z --profile weather --target dev`
[2025-06-20T10:23:19.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.504+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt8tki06a --profiles-dir /tmp/tmp1q39rp5z --profile weather --target dev`
[2025-06-20T10:23:19.510+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.507+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:23:19.511+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:19.507+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:23:19.511+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:19.507+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:23:24.423+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:24.423+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt8tki06a --profiles-dir /tmp/tmp1q39rp5z --profile weather --target dev`
[2025-06-20T10:23:24.423+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:24.423+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt8tki06a --profiles-dir /tmp/tmp1q39rp5z --profile weather --target dev`
[2025-06-20T10:23:24.424+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:24.423+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt8tki06a --profiles-dir /tmp/tmp1q39rp5z --profile weather --target dev`
[2025-06-20T10:23:24.424+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:24.424+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:23:24.424+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:24.424+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:23:24.425+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:24.424+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:23:30.298+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:23:30.296+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpt8tki06a', '--profiles-dir', '/tmp/tmp1q39rp5z', '--profile', 'weather', '--target', 'dev'] due to the error:
10:23:27  Running with dbt=1.7.9
10:23:27  Registered adapter: postgres=1.7.9
10:23:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:23:29  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:23:30.299+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:23:30.296+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpt8tki06a', '--profiles-dir', '/tmp/tmp1q39rp5z', '--profile', 'weather', '--target', 'dev'] due to the error:
10:23:27  Running with dbt=1.7.9
10:23:27  Registered adapter: postgres=1.7.9
10:23:27  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:23:29  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:23:30.299+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:23:30.317+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.915 seconds
[2025-06-20T10:24:00.990+0000] {processor.py:161} INFO - Started process (PID=1444) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:24:00.991+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:24:00.994+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:00.994+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:24:01.076+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:01.076+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:24:01.514+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.513+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:24:01.514+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:01.513+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:24:01.514+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.513+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:24:01.515+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.515+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:24:01.515+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:01.515+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:24:01.516+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.515+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:24:01.516+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.516+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:24:01.517+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:01.516+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:24:01.517+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.516+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:24:01.518+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.518+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpe86adku_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:24:01.518+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:01.518+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpe86adku_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:24:01.519+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.518+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpe86adku_/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:24:01.519+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.519+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7smdtx_y --profiles-dir /tmp/tmpe86adku_ --profile weather --target dev`
[2025-06-20T10:24:01.519+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:01.519+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7smdtx_y --profiles-dir /tmp/tmpe86adku_ --profile weather --target dev`
[2025-06-20T10:24:01.520+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.519+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7smdtx_y --profiles-dir /tmp/tmpe86adku_ --profile weather --target dev`
[2025-06-20T10:24:01.520+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.520+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:01.520+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:01.520+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:01.521+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:01.520+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:07.318+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:07.317+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7smdtx_y --profiles-dir /tmp/tmpe86adku_ --profile weather --target dev`
[2025-06-20T10:24:07.318+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:07.317+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7smdtx_y --profiles-dir /tmp/tmpe86adku_ --profile weather --target dev`
[2025-06-20T10:24:07.319+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:07.317+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7smdtx_y --profiles-dir /tmp/tmpe86adku_ --profile weather --target dev`
[2025-06-20T10:24:07.319+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:07.319+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:07.320+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:07.319+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:07.320+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:07.319+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:15.365+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:15.364+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7smdtx_y', '--profiles-dir', '/tmp/tmpe86adku_', '--profile', 'weather', '--target', 'dev'] due to the error:
10:24:11  Running with dbt=1.7.9
10:24:12  Registered adapter: postgres=1.7.9
10:24:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:24:14  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:24:15.366+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:15.364+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7smdtx_y', '--profiles-dir', '/tmp/tmpe86adku_', '--profile', 'weather', '--target', 'dev'] due to the error:
10:24:11  Running with dbt=1.7.9
10:24:12  Registered adapter: postgres=1.7.9
10:24:12  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:24:14  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:24:15.366+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:24:15.381+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 14.394 seconds
[2025-06-20T10:24:45.750+0000] {processor.py:161} INFO - Started process (PID=1492) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:24:45.750+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:24:45.752+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:45.752+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:24:45.793+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:45.793+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:24:46.155+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.155+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:24:46.156+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:46.155+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:24:46.156+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.155+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:24:46.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.156+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:24:46.157+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:46.156+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:24:46.157+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.156+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:24:46.158+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.157+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:24:46.158+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:46.157+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:24:46.158+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.157+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:24:46.160+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.159+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp8snvijdj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:24:46.160+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:46.159+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp8snvijdj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:24:46.160+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.159+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp8snvijdj/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:24:46.161+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.161+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjm2v7atr --profiles-dir /tmp/tmp8snvijdj --profile weather --target dev`
[2025-06-20T10:24:46.161+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:46.161+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjm2v7atr --profiles-dir /tmp/tmp8snvijdj --profile weather --target dev`
[2025-06-20T10:24:46.161+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.161+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjm2v7atr --profiles-dir /tmp/tmp8snvijdj --profile weather --target dev`
[2025-06-20T10:24:46.162+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.161+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:46.162+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:46.161+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:46.162+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:46.161+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:50.257+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:50.256+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjm2v7atr --profiles-dir /tmp/tmp8snvijdj --profile weather --target dev`
[2025-06-20T10:24:50.257+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:50.256+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjm2v7atr --profiles-dir /tmp/tmp8snvijdj --profile weather --target dev`
[2025-06-20T10:24:50.257+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:50.256+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjm2v7atr --profiles-dir /tmp/tmp8snvijdj --profile weather --target dev`
[2025-06-20T10:24:50.258+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:50.257+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:50.258+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:50.257+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:50.258+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:50.257+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:24:58.152+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:24:58.146+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjm2v7atr', '--profiles-dir', '/tmp/tmp8snvijdj', '--profile', 'weather', '--target', 'dev'] due to the error:
10:24:53  Running with dbt=1.7.9
10:24:54  Registered adapter: postgres=1.7.9
10:24:54  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:24:56  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:24:58.156+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:24:58.146+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjm2v7atr', '--profiles-dir', '/tmp/tmp8snvijdj', '--profile', 'weather', '--target', 'dev'] due to the error:
10:24:53  Running with dbt=1.7.9
10:24:54  Registered adapter: postgres=1.7.9
10:24:54  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:24:56  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:24:58.159+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:24:58.210+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 12.463 seconds
[2025-06-20T10:25:29.055+0000] {processor.py:161} INFO - Started process (PID=1534) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:25:29.055+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:25:29.057+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.057+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:25:29.098+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.098+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:25:29.420+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.419+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:25:29.420+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.419+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:25:29.420+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.419+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:25:29.421+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.421+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:25:29.421+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.421+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:25:29.422+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.421+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:25:29.422+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.422+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:25:29.423+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.422+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:25:29.423+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.422+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:25:29.424+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.424+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptt39t98g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:25:29.424+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.424+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmptt39t98g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:25:29.425+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.424+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmptt39t98g/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:25:29.425+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.425+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp493yypn9 --profiles-dir /tmp/tmptt39t98g --profile weather --target dev`
[2025-06-20T10:25:29.425+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.425+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp493yypn9 --profiles-dir /tmp/tmptt39t98g --profile weather --target dev`
[2025-06-20T10:25:29.426+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.425+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp493yypn9 --profiles-dir /tmp/tmptt39t98g --profile weather --target dev`
[2025-06-20T10:25:29.426+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.426+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:25:29.426+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:29.426+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:25:29.427+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:29.426+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:25:37.725+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:37.725+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp493yypn9 --profiles-dir /tmp/tmptt39t98g --profile weather --target dev`
[2025-06-20T10:25:37.726+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:37.725+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp493yypn9 --profiles-dir /tmp/tmptt39t98g --profile weather --target dev`
[2025-06-20T10:25:37.727+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:37.725+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp493yypn9 --profiles-dir /tmp/tmptt39t98g --profile weather --target dev`
[2025-06-20T10:25:37.727+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:37.727+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:25:37.728+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:37.727+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:25:37.728+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:37.727+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:25:44.842+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:25:44.840+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp493yypn9', '--profiles-dir', '/tmp/tmptt39t98g', '--profile', 'weather', '--target', 'dev'] due to the error:
10:25:42  Running with dbt=1.7.9
10:25:42  Registered adapter: postgres=1.7.9
10:25:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:25:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:25:44.843+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:25:44.840+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp493yypn9', '--profiles-dir', '/tmp/tmptt39t98g', '--profile', 'weather', '--target', 'dev'] due to the error:
10:25:42  Running with dbt=1.7.9
10:25:42  Registered adapter: postgres=1.7.9
10:25:42  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:25:43  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:25:44.844+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:25:44.861+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 15.809 seconds
[2025-06-20T10:26:15.380+0000] {processor.py:161} INFO - Started process (PID=1586) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:26:15.381+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:26:15.383+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.383+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:26:15.422+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.421+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:26:15.897+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.897+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:26:15.898+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.897+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:26:15.898+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.897+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:26:15.899+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.899+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:26:15.900+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.899+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:26:15.900+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.899+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:26:15.901+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.901+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:26:15.902+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.901+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:26:15.902+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.901+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:26:15.904+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.904+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6v54tq2u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:26:15.905+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.904+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp6v54tq2u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:26:15.905+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.904+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp6v54tq2u/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:26:15.906+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.906+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpk1y1dhzl --profiles-dir /tmp/tmp6v54tq2u --profile weather --target dev`
[2025-06-20T10:26:15.906+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.906+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpk1y1dhzl --profiles-dir /tmp/tmp6v54tq2u --profile weather --target dev`
[2025-06-20T10:26:15.907+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.906+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpk1y1dhzl --profiles-dir /tmp/tmp6v54tq2u --profile weather --target dev`
[2025-06-20T10:26:15.908+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.907+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:26:15.908+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:15.907+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:26:15.909+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:15.907+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:26:21.877+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:21.876+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpk1y1dhzl --profiles-dir /tmp/tmp6v54tq2u --profile weather --target dev`
[2025-06-20T10:26:21.877+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:21.876+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpk1y1dhzl --profiles-dir /tmp/tmp6v54tq2u --profile weather --target dev`
[2025-06-20T10:26:21.878+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:21.876+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpk1y1dhzl --profiles-dir /tmp/tmp6v54tq2u --profile weather --target dev`
[2025-06-20T10:26:21.878+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:21.878+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:26:21.879+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:21.878+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:26:21.879+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:21.878+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:26:29.332+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:29.331+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpk1y1dhzl', '--profiles-dir', '/tmp/tmp6v54tq2u', '--profile', 'weather', '--target', 'dev'] due to the error:
10:26:26  Running with dbt=1.7.9
10:26:26  Registered adapter: postgres=1.7.9
10:26:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:26:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:26:29.333+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:26:29.331+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpk1y1dhzl', '--profiles-dir', '/tmp/tmp6v54tq2u', '--profile', 'weather', '--target', 'dev'] due to the error:
10:26:26  Running with dbt=1.7.9
10:26:26  Registered adapter: postgres=1.7.9
10:26:26  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:26:28  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:26:29.333+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:26:29.371+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.994 seconds
[2025-06-20T10:26:59.854+0000] {processor.py:161} INFO - Started process (PID=1640) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:26:59.859+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:26:59.863+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:59.862+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:26:59.985+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:26:59.985+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:27:00.907+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.907+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:27:00.908+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:00.907+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:27:00.909+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.907+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:27:00.910+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.909+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:27:00.912+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:00.909+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:27:00.912+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.909+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:27:00.914+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.913+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:27:00.914+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:00.913+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:27:00.916+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.913+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:27:00.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.918+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg49k7fot/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:27:00.920+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:00.918+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpg49k7fot/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:27:00.921+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.918+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpg49k7fot/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:27:00.923+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.922+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq0h85zx0 --profiles-dir /tmp/tmpg49k7fot --profile weather --target dev`
[2025-06-20T10:27:00.923+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:00.922+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq0h85zx0 --profiles-dir /tmp/tmpg49k7fot --profile weather --target dev`
[2025-06-20T10:27:00.923+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.922+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq0h85zx0 --profiles-dir /tmp/tmpg49k7fot --profile weather --target dev`
[2025-06-20T10:27:00.927+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.926+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:00.927+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:00.926+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:00.928+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:00.926+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:05.506+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:05.505+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq0h85zx0 --profiles-dir /tmp/tmpg49k7fot --profile weather --target dev`
[2025-06-20T10:27:05.506+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:05.505+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq0h85zx0 --profiles-dir /tmp/tmpg49k7fot --profile weather --target dev`
[2025-06-20T10:27:05.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:05.505+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq0h85zx0 --profiles-dir /tmp/tmpg49k7fot --profile weather --target dev`
[2025-06-20T10:27:05.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:05.507+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:05.507+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:05.507+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:05.507+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:05.507+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:11.352+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:11.350+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq0h85zx0', '--profiles-dir', '/tmp/tmpg49k7fot', '--profile', 'weather', '--target', 'dev'] due to the error:
10:27:08  Running with dbt=1.7.9
10:27:08  Registered adapter: postgres=1.7.9
10:27:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:27:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:27:11.353+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:11.350+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq0h85zx0', '--profiles-dir', '/tmp/tmpg49k7fot', '--profile', 'weather', '--target', 'dev'] due to the error:
10:27:08  Running with dbt=1.7.9
10:27:08  Registered adapter: postgres=1.7.9
10:27:08  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:27:09  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:27:11.354+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:27:11.376+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 11.528 seconds
[2025-06-20T10:27:41.584+0000] {processor.py:161} INFO - Started process (PID=1684) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:27:41.584+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:27:41.586+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:41.586+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:27:41.632+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:41.632+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:27:42.032+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.032+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:27:42.032+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:42.032+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:27:42.033+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.032+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:27:42.033+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.033+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:27:42.034+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:42.033+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:27:42.034+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.033+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:27:42.035+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.034+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:27:42.035+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:42.034+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:27:42.035+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.034+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:27:42.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.036+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7f2uqbmx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:27:42.037+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:42.036+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp7f2uqbmx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:27:42.037+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.036+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp7f2uqbmx/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:27:42.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.037+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7i6l9f_j --profiles-dir /tmp/tmp7f2uqbmx --profile weather --target dev`
[2025-06-20T10:27:42.038+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:42.037+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7i6l9f_j --profiles-dir /tmp/tmp7f2uqbmx --profile weather --target dev`
[2025-06-20T10:27:42.038+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.037+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7i6l9f_j --profiles-dir /tmp/tmp7f2uqbmx --profile weather --target dev`
[2025-06-20T10:27:42.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.038+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:42.039+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:42.038+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:42.039+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:42.038+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:46.795+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:46.794+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7i6l9f_j --profiles-dir /tmp/tmp7f2uqbmx --profile weather --target dev`
[2025-06-20T10:27:46.796+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:46.794+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7i6l9f_j --profiles-dir /tmp/tmp7f2uqbmx --profile weather --target dev`
[2025-06-20T10:27:46.796+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:46.794+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7i6l9f_j --profiles-dir /tmp/tmp7f2uqbmx --profile weather --target dev`
[2025-06-20T10:27:46.797+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:46.797+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:46.797+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:46.797+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:46.798+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:46.797+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:27:55.320+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:27:55.315+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7i6l9f_j', '--profiles-dir', '/tmp/tmp7f2uqbmx', '--profile', 'weather', '--target', 'dev'] due to the error:
10:27:49  Running with dbt=1.7.9
10:27:50  Registered adapter: postgres=1.7.9
10:27:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:27:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:27:55.323+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:27:55.315+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7i6l9f_j', '--profiles-dir', '/tmp/tmp7f2uqbmx', '--profile', 'weather', '--target', 'dev'] due to the error:
10:27:49  Running with dbt=1.7.9
10:27:50  Registered adapter: postgres=1.7.9
10:27:50  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:27:53  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:27:55.328+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:27:55.384+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.803 seconds
[2025-06-20T10:28:25.586+0000] {processor.py:161} INFO - Started process (PID=1731) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:28:25.587+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:28:25.589+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:25.588+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:28:25.628+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:25.628+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:28:25.997+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:25.997+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:28:25.998+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:25.997+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:28:25.998+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:25.997+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:28:25.999+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:25.998+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:28:25.999+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:25.998+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:28:25.999+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:25.998+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:28:26.000+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:25.999+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:28:26.000+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:25.999+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:28:26.000+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:25.999+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:28:26.002+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:26.002+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmprwgm8p2p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:28:26.002+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:26.002+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmprwgm8p2p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:28:26.002+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:26.002+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmprwgm8p2p/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:28:26.003+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:26.003+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp22_eisuo --profiles-dir /tmp/tmprwgm8p2p --profile weather --target dev`
[2025-06-20T10:28:26.003+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:26.003+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp22_eisuo --profiles-dir /tmp/tmprwgm8p2p --profile weather --target dev`
[2025-06-20T10:28:26.003+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:26.003+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp22_eisuo --profiles-dir /tmp/tmprwgm8p2p --profile weather --target dev`
[2025-06-20T10:28:26.004+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:26.003+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:28:26.004+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:26.003+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:28:26.005+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:26.003+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:28:31.698+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:31.697+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp22_eisuo --profiles-dir /tmp/tmprwgm8p2p --profile weather --target dev`
[2025-06-20T10:28:31.698+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:31.697+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp22_eisuo --profiles-dir /tmp/tmprwgm8p2p --profile weather --target dev`
[2025-06-20T10:28:31.698+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:31.697+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp22_eisuo --profiles-dir /tmp/tmprwgm8p2p --profile weather --target dev`
[2025-06-20T10:28:31.699+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:31.699+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:28:31.699+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:31.699+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:28:31.699+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:31.699+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:28:39.099+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:28:39.098+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp22_eisuo', '--profiles-dir', '/tmp/tmprwgm8p2p', '--profile', 'weather', '--target', 'dev'] due to the error:
10:28:35  Running with dbt=1.7.9
10:28:36  Registered adapter: postgres=1.7.9
10:28:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:28:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:28:39.100+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:28:39.098+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp22_eisuo', '--profiles-dir', '/tmp/tmprwgm8p2p', '--profile', 'weather', '--target', 'dev'] due to the error:
10:28:35  Running with dbt=1.7.9
10:28:36  Registered adapter: postgres=1.7.9
10:28:36  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:28:37  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:28:39.100+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:28:39.114+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.530 seconds
[2025-06-20T10:29:10.048+0000] {processor.py:161} INFO - Started process (PID=1778) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:29:10.049+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:29:10.052+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.052+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:29:10.111+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.111+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:29:10.466+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.465+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:29:10.466+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.465+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:29:10.467+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.465+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:29:10.468+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.467+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:29:10.468+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.467+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:29:10.468+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.467+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:29:10.469+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.469+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:29:10.469+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.469+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:29:10.470+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.469+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:29:10.472+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.471+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp_kvfxgov/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:29:10.472+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.471+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmp_kvfxgov/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:29:10.472+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.471+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmp_kvfxgov/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:29:10.473+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.473+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0_mukufr --profiles-dir /tmp/tmp_kvfxgov --profile weather --target dev`
[2025-06-20T10:29:10.473+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.473+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0_mukufr --profiles-dir /tmp/tmp_kvfxgov --profile weather --target dev`
[2025-06-20T10:29:10.473+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.473+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0_mukufr --profiles-dir /tmp/tmp_kvfxgov --profile weather --target dev`
[2025-06-20T10:29:10.474+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.474+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:10.474+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:10.474+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:10.475+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:10.474+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:15.950+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:15.949+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0_mukufr --profiles-dir /tmp/tmp_kvfxgov --profile weather --target dev`
[2025-06-20T10:29:15.951+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:15.949+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0_mukufr --profiles-dir /tmp/tmp_kvfxgov --profile weather --target dev`
[2025-06-20T10:29:15.951+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:15.949+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0_mukufr --profiles-dir /tmp/tmp_kvfxgov --profile weather --target dev`
[2025-06-20T10:29:15.952+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:15.952+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:15.952+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:15.952+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:15.953+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:15.952+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:23.580+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:23.578+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0_mukufr', '--profiles-dir', '/tmp/tmp_kvfxgov', '--profile', 'weather', '--target', 'dev'] due to the error:
10:29:20  Running with dbt=1.7.9
10:29:21  Registered adapter: postgres=1.7.9
10:29:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:29:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:29:23.581+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:23.578+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0_mukufr', '--profiles-dir', '/tmp/tmp_kvfxgov', '--profile', 'weather', '--target', 'dev'] due to the error:
10:29:20  Running with dbt=1.7.9
10:29:21  Registered adapter: postgres=1.7.9
10:29:21  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:29:22  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:29:23.581+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:29:23.600+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.559 seconds
[2025-06-20T10:29:54.237+0000] {processor.py:161} INFO - Started process (PID=1837) to work on /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:29:54.238+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/weather_dbt_dag.py for tasks to queue
[2025-06-20T10:29:54.242+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.241+0000] {dagbag.py:538} INFO - Filling up the DagBag from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:29:54.305+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.304+0000] {configuration.py:1046} WARNING - section/key [openlineage/namespace] not found in config
[2025-06-20T10:29:54.918+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.917+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:29:54.918+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.917+0000] {graph.py:235} INFO - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:29:54.919+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.917+0000] {graph.py:235} INFO - (astronomer-cosmos) - Trying to parse the dbt project in `/opt/airflow/dbt/weather` using dbt ls...
[2025-06-20T10:29:54.920+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.920+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:29:54.922+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.920+0000] {graph.py:245} INFO - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:29:54.924+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.920+0000] {graph.py:245} INFO - (astronomer-cosmos) - Content of the dbt project dir /opt/airflow/dbt/weather: `['tests', 'dbt_project.yml', 'models']`
[2025-06-20T10:29:54.927+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.925+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:29:54.929+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.925+0000] {base.py:168} INFO - Using mock values for profile weather
[2025-06-20T10:29:54.930+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.925+0000] {base.py:168} INFO - (astronomer-cosmos) - Using mock values for profile weather
[2025-06-20T10:29:54.935+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.934+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpevrt3iov/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:29:54.937+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.934+0000] {config.py:278} INFO - Creating temporary profiles.yml at /tmp/tmpevrt3iov/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev
[2025-06-20T10:29:54.938+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.934+0000] {config.py:278} INFO - (astronomer-cosmos) - Creating temporary profiles.yml at /tmp/tmpevrt3iov/profiles.yml with the following contents:
weather:
    outputs:
        dev:
            dbname: mock_value
            host: mock_value
            password: mock_value
            port: 5432
            schema: dbt_t
            type: postgres
            user: mock_value
    target: dev

[2025-06-20T10:29:54.940+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.939+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8yybvyst --profiles-dir /tmp/tmpevrt3iov --profile weather --target dev`
[2025-06-20T10:29:54.942+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.939+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8yybvyst --profiles-dir /tmp/tmpevrt3iov --profile weather --target dev`
[2025-06-20T10:29:54.943+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.939+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8yybvyst --profiles-dir /tmp/tmpevrt3iov --profile weather --target dev`
[2025-06-20T10:29:54.944+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.943+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:54.945+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:29:54.943+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:29:54.945+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:29:54.943+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:30:01.899+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:30:01.899+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8yybvyst --profiles-dir /tmp/tmpevrt3iov --profile weather --target dev`
[2025-06-20T10:30:01.900+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:30:01.899+0000] {graph.py:74} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8yybvyst --profiles-dir /tmp/tmpevrt3iov --profile weather --target dev`
[2025-06-20T10:30:01.900+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:30:01.899+0000] {graph.py:74} INFO - (astronomer-cosmos) - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8yybvyst --profiles-dir /tmp/tmpevrt3iov --profile weather --target dev`
[2025-06-20T10:30:01.900+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:30:01.900+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:30:01.901+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:30:01.900+0000] {graph.py:75} INFO - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:30:01.901+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:30:01.900+0000] {graph.py:75} INFO - (astronomer-cosmos) - Environment variable keys: dict_keys(['AIRFLOW__SMTP__SMTP_PORT', 'AIRFLOW__CELERY__RESULT_BACKEND', 'DUMB_INIT_SETSID', 'HOSTNAME', 'PYTHON_VERSION', 'LANGUAGE', 'AIRFLOW_USER_HOME_DIR', 'ADDITIONAL_RUNTIME_APT_DEPS', 'PWD', 'AIRFLOW__CELERY__BROKER_URL', 'AIRFLOW_VERSION', 'AIRFLOW__CORE__LOAD_EXAMPLES', 'INSTALL_MSSQL_CLIENT', 'PYTHON_SETUPTOOLS_VERSION', 'INSTALL_MYSQL_CLIENT_TYPE', 'GUNICORN_CMD_ARGS', 'LD_PRELOAD', 'HOME', 'LANG', 'AIRFLOW_HOME', 'GPG_KEY', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN', 'AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL', 'AIRFLOW__CORE__EXECUTOR', 'COMMIT_SHA', 'AIRFLOW_PIP_VERSION', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION', 'ADDITIONAL_RUNTIME_APT_COMMAND', '_PIP_ADDITIONAL_REQUIREMENTS', 'INSTALL_POSTGRES_CLIENT', 'SHLVL', 'LC_MESSAGES', 'RUNTIME_APT_DEPS', 'PYTHON_PIP_VERSION', 'RUNTIME_APT_COMMAND', 'LD_LIBRARY_PATH', 'LC_CTYPE', 'AIRFLOW__SMTP__SMTP_STARTTLS', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK', 'PYTHON_GET_PIP_SHA256', 'AIRFLOW_INSTALLATION_METHOD', 'LC_ALL', 'PYTHON_GET_PIP_URL', 'INSTALL_MYSQL_CLIENT', 'PATH', 'PYTHON_BASE_IMAGE', 'AIRFLOW_UID', 'AIRFLOW__API__AUTH_BACKEND', 'BUILD_ID', 'AIRFLOW__CORE__FERNET_KEY', 'DEBIAN_FRONTEND', 'AIRFLOW__SMTP__SMTP_SSL', 'AIRFLOW__SMTP__SMTP_HOST', 'AIRFLOW__LOGGING__COLORED_CONSOLE_LOG', 'DBT_LOG_PATH', 'DBT_TARGET_PATH'])
[2025-06-20T10:30:07.694+0000] {logging_mixin.py:188} INFO - [2025-06-20T10:30:07.692+0000] {dagbag.py:348} ERROR - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8yybvyst', '--profiles-dir', '/tmp/tmpevrt3iov', '--profile', 'weather', '--target', 'dev'] due to the error:
10:30:04  Running with dbt=1.7.9
10:30:05  Registered adapter: postgres=1.7.9
10:30:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:30:06  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:30:07.694+0000] {logging_mixin.py:188} WARNING - [2025-06-20T10:30:07.692+0000] {dagbag.py:348} ERROR - (astronomer-cosmos) - Failed to import: /opt/airflow/dags/weather_dbt_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/dagbag.py", line 344, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 843, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_dbt_dag.py", line 14, in <module>
    weather_dbt_dag = DbtDag(
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/airflow/dag.py", line 25, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/converter.py", line 244, in __init__
    dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 176, in load
    self.load_via_dbt_ls()
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 279, in load_via_dbt_ls
    nodes = self.run_dbt_ls(dbt_cmd, self.execution_config.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 209, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.8/site-packages/cosmos/dbt/graph.py", line 94, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8yybvyst', '--profiles-dir', '/tmp/tmpevrt3iov', '--profile', 'weather', '--target', 'dev'] due to the error:
10:30:04  Running with dbt=1.7.9
10:30:05  Registered adapter: postgres=1.7.9
10:30:05  Unable to do partial parsing because saved manifest not found. Starting full parse.
10:30:06  Encountered an error:
Compilation Error
  Model 'model.weather.stg_weathers' (models/example/staging/stg_weathers.sql) depends on a source named 'open_weathers.weathers' which was not found
[2025-06-20T10:30:07.695+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_dbt_dag.py
[2025-06-20T10:30:07.710+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/weather_dbt_dag.py took 13.476 seconds
